<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head>  <title>Surviving the Web: A Journey into Web Session Security</title>  <!-- Copyright (c) 2010-2015 The MathJax Consortium --><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>  <meta name="viewport" content="width=device-width; initial-scale=1.0;"></meta>  <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>  <link media="screen, print" rel="stylesheet"    href="https://dl.acm.org/pubs/lib/css/bootstrap.min.css"/><link media="screen, print" rel="stylesheet"    href="https://dl.acm.org/pubs/lib/css/bootstrap-theme.min.css"/><link media="screen, print" rel="stylesheet"    href="https://dl.acm.org/pubs/lib/css/main.css"/><script src="https://dl.acm.org/pubs/lib/js/jquery.min.js" type="text/javascript"></script>  <script src="https://dl.acm.org/pubs/lib/js/bootstrap.min.js" type="text/javascript"></script>  <script src="https://dl.acm.org/pubs/lib/js/bibCit.js" type="text/javascript"></script>  <script src="https://dl.acm.org/pubs/lib/js/divTab.js" type="text/javascript"></script>  <script type="text/javascript"    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script>  <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>  </head>  <body id="main">  <section class="front-matter">   <section>    <header class="title-info">     <div class="journal-title">     <h1>      <span class="title">Surviving the Web: A Journey into Web Session Security</span>      <br/>      <span class="subTitle">       <SubTitle>(Extended Abstract)</SubTitle>      </span>     </h1>     </div>    </header>    <div class="authorGroup">     <div class="author">     <span class="givenName">Stefano</span>      <span class="surName">Calzavara</span>     Universit&#x00E0; Ca&#x2019; Foscari Venezia, <a href="mailto:stefano.calzavara@unive.it">stefano.calzavara@unive.it</a>     </div>     <div class="author">     <span class="givenName">Riccardo</span>      <span class="surName">Focardi</span>     Universit&#x00E0; Ca&#x2019; Foscari Venezia, <a href="mailto:focardi@unive.it">focardi@unive.it</a>     </div>     <div class="author">     <span class="givenName">Marco</span>      <span class="surName">Squarcina</span>     Universit&#x00E0; Ca&#x2019; Foscari Venezia, <a href="mailto:squarcina@unive.it">squarcina@unive.it</a>     </div>     <div class="author">     <span class="givenName">Mauro</span>      <span class="surName">Tempesta</span>     Universit&#x00E0; Ca&#x2019; Foscari Venezia, <a href="mailto:tempesta@unive.it">tempesta@unive.it</a>     </div>                     </div>    <br/>    <div class="pubInfo">     <p>DOI: <a href="https://doi.org/10.1145/3184558.3186232" target="_blank">https://doi.org/10.1145/3184558.3186232</a>     <br/>WWW '18: <a href="https://doi.org/10.1145/3184558" target="_blank">Proceedings of The Web Conference 2018</a>, Lyon, France, April 2018</p>    </div>    <div class="abstract">     <p>     <small>We survey the most common attacks against web sessions, i.e., attacks which target honest web browser users establishing an authenticated session with a trusted web application. We then review existing security solutions which prevent or mitigate the different attacks, by evaluating them along four different axes: protection, usability, compatibility and ease of deployment. Based on this survey, we identify five guidelines that, to different extents, have been taken into account by the designers of the different proposals we reviewed. We believe that these guidelines can be helpful for the development of innovative solutions approaching web security in a more systematic and comprehensive way.</small>     </p>    </div>    <div class="classifications">     <div class="author">     <span style="font-weight:bold;">      <small>Keywords:</small>     </span>     <span class="keyword">      <small>Web sessions; HTTP cookies; web attacks; web defenses</small>     </span>     </div>     <br/>     <div class="AcmReferenceFormat">     <p>      <small>       <span style="font-weight:bold;">ACM Reference Format:</span>       <br/>       Stefano Calzavara, Riccardo Focardi, Marco Squarcina, and Mauro Tempesta. 2018. Surviving the Web: A Journey into Web Session Security. In <em>WWW '18 Companion: The 2018 Web Conference Companion,</em>       <em>23-27 April, 2018 (WWW &#x2019;18 Companion),</em>       <em> Lyon, France. ACM, New York, NY, USA</em> 5 Pages. <a href="https://doi.org/10.1145/3184558.3186232" class="link-inline force-break"        target="_blank">https://doi.org/10.1145/3184558.3186232</a></small>     </p>     </div>    </div>   </section>  </section>  <section class="body">   <section id="sec-5">    <header>     <div class="title-info">     <h2>      <span class="section-number">1</span> Introduction</h2>     </div>    </header>    <p>The Web is the primary access point to on-line data and applications. It is extremely complex and variegate, as it integrates a multitude of dynamic contents by different parties to deliver the greatest possible user experience. This heterogeneity makes it very hard to effectively enforce security, since putting in place novel security mechanisms typically prevents existing websites from working correctly or negatively affects the user experience, which is generally regarded as unacceptable, given the massive user base of the Web. However, this continuous quest for usability and backward compatibility had a subtle effect on web security research: designers of new defensive mechanisms have been extremely cautious and the large majority of their proposals consists of very local patches against very specific attacks. This piecemeal evolution hindered a deep understanding of many subtle vulnerabilities and problems, as testified by the proliferation of different threat models against which different proposals have been evaluated, occasionally with quite diverse underlying assumptions. It is easy to get lost among the multitude of proposed solutions and almost impossible to understand the relative benefits and drawbacks of each single proposal without a full picture of the existing literature.</p>    <p>In this work, we take the delicate task of performing a systematic overview of a large class of common attacks targeting the current Web and the corresponding security solutions proposed so far. We focus on attacks against <em>web sessions</em>, i.e., attacks which target honest web browser users establishing an authenticated session with a trusted web application. This kind of attacks exploits the intrinsic complexity of the Web by tampering, e.g., with dynamic contents, client-side storage or cross-domain links, so as to corrupt the browser activity and/or network communication. Our choice is motivated by the fact that attacks against web sessions cover a very relevant subset of serious web security incidents&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0014">14</a>] and many different defenses, operating at different levels, have been proposed to prevent these attacks.</p>    <p>We consider typical attacks against web sessions and we systematise them based on: (<em>i</em>) their attacker model and (<em>ii</em>) the security properties they break. This first classification is useful to understand precisely which intended security properties of a web session can be violated by a certain attack and how. We then survey existing security solutions and mechanisms that prevent or mitigate the different attacks and we evaluate each proposal with respect to the security guarantees it provides. When security is guaranteed only under certain assumptions, we make these assumptions explicit. For each security solution, we also evaluate its impact on both <em>compatibility</em> and <em>usability</em>, as well as its <em>ease of deployment</em>. These are important criteria to judge the practicality of a certain solution and they are useful to understand to which extent each solution, in its current state, may be amenable for a large-scale adoption on the Web. Moreover, since there are several proposals in the literature which aim at providing robust safeguards against multiple attacks, we also provide an overview of them. For each of these proposals, we discuss which attacks it prevents with respect to the attacker model considered in its original design and we assess its adequacy according to the criteria described above.</p>    <p>Finally, we synthesize from our survey a list of five guidelines that, to different extents, have been taken into account by the designers of the different solutions. We observe that none of the existing proposals follows all the guidelines and we argue that this is due to the high complexity of the Web and the intrinsic difficulty in securing it. We believe that these guidelines can be helpful for the development of innovative solutions approaching web security in a more systematic and comprehensive way.</p>    <p>     <em>Reference to Journal Publication</em>. This extended abstract provides a short overview of a published journal paper with the same title. We refer to the original publication&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0008">8</a>] for full details.</p>   </section>   <section id="sec-6">    <header>     <div class="title-info">     <h2>      <span class="section-number">2</span> Attacking Web Sessions</h2>     </div>    </header>    <p>A <em>web session</em> is a semi-permanent information exchange between a browser and a web server that involves multiple requests and responses. Since HTTP is a stateless protocol, i.e., each request is treated independently from all the others, the vast majority of web applications use <em>cookies</em> to implement stateful sessions. When the user successfully authenticates to a website, a fresh cookie is generated by the server and sent back to the browser. Further requests originating from the browser automatically include the cookie as a proof of being part of the session established upon password-based authentication.</p>    <p>The cookie plays the role of the password in all the subsequent requests to the web server, thus it is enough to leak its value to hijack the session and fully impersonate the user, without compromising the network connection or the server. We call <em>authentication cookie</em> any cookie which identifies a web session.</p>    <section id="sec-7">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.1</span> Security Properties</h3>     </div>     </header>     <p>We consider two standard security properties formulated in the setting of web sessions. They represent typical targets of web session attacks:</p>     <ul class="list-no-style">     <li id="list1" label="&#x2022;"><em>Confidentiality</em>: data transmitted inside a session should not be disclosed to unauthorized users;<br/></li>     <li id="list2" label="&#x2022;"><em>Integrity</em>: data transmitted inside a session should not be modified or forged by unauthorized users.<br/></li>     </ul>     <p>Interestingly, the above properties are not independent and a violation of one might lead to the violation of the other. For instance, compromising session confidentiality might reveal authentication cookies, which would allow the attacker to perform arbitrary actions on behalf of the user, thus breaking session integrity.</p>    </section>    <section id="sec-8">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.2</span> Threat Model</h3>     </div>     </header>     <p>We focus on two main families of attackers: <em>web attackers</em> and <em>network attackers</em>. A web attacker controls at least one web server that responds to any HTTP(S) requests sent to it with arbitrary malicious contents chosen by the attacker. We assume that a web attacker can obtain trusted HTTPS certificates for all the web servers under his control and is able to exploit content injection vulnerabilities on trusted websites. A slightly more powerful variation of the web attacker, known as the <em>related-domain attacker</em>, can also host malicious web pages on a domain sharing a &#x201C;sufficiently long&#x201D; suffix with the domain of the target website&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0005">5</a>]. This additional capability allows the attacker to set valid (domain) cookies for the target website that are indistinguishable from the ones set by the legitimate site&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0003">3</a>]. Network attackers extend the capabilities of traditional web attackers with the ability of inspecting, forging and corrupting all the HTTP traffic sent on the network, as well as the HTTPS traffic using untrusted certificates.</p>    </section>    <section id="sec-9">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.3</span> Attacks Overview</h3>     </div>     </header>     <p>We provide now an overview of the most important attacks against web sessions. For each class of attacks, we report the security properties of web sessions which it violates.</p>     <section id="sec-10">     <p><em>2.3.1 Content Injection (XSS).</em> This wide class of attacks allows a web attacker to inject harmful contents into trusted web applications. Content injections can be mounted in many different ways, but they are always enabled by an improper or missing sanitization of some attacker-controlled input in the web application. These attacks are traditionally assimilated to Cross-Site Scripting (XSS), i.e., injections of malicious JavaScript code; however, the lack of a proper sanitization may also affect HTML contents (markup injection) or even CSS rules&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0013">13</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0020">20</a>]. Content injection attacks are usually classified as either <em>reflected</em> or <em>stored</em>, depending on the persistence of the threat. In the reflected variant, part of the input supplied in the request is &#x201C;reflected&#x201D; into the response without proper sanitization. Stored attacks, instead, are those where the injected content is permanently saved on the target server, e.g., in a message appearing on a discussion board. The malicious content is then automatically interpreted by any browser which visits the attacked page.</p>     <p>Since content injections allow an attacker to sidestep the same-origin policy (SOP), which is the baseline security policy of standard web browsers, they can have catastrophic consequences on both the confidentiality and the integrity of a web session. Specifically, they can be used to steal sensitive data from trusted websites, such as authentication cookies and user credentials, and to actively corrupt the page contents, so as to undermine the integrity of a web session.</p>     </section>     <section id="sec-11">     <p><em>2.3.2 Cross-Site Request Forgery (CSRF).</em> A CSRF is an instance of the &#x201C;confused deputy&#x201D; problem&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0012">12</a>] in the context of web browsing. In a CSRF, the attacker forces the user browser into sending HTTP(S) requests to a website where the user has already established an authenticated session, e.g. by including some <tt><img></tt> tags to the vulnerable website in pages hosted by the attacker. When rendering these HTML elements, the browser will send HTTP(S) requests to the target website that automatically include the authentication cookies of the user. From the target website perspective, these forged requests are indistinguishable from legitimate ones and thus they can be abused to trigger a dangerous side-effect, e.g., to force a bank transfer to the attacker account.</p>     <p>A CSRF attack allows the attacker to inject an authenticated message into a session with a trusted website, hence it constitutes a threat to session integrity. It is less known that CSRFs may also be employed to break confidentiality by sending cross-site requests that return sensitive user data bound to the user session, e.g., as in the attack against the cloud service SpiderOak&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0002">2</a>].</p>     </section>     <section id="sec-12">     <p><em>2.3.3 More Attacks.</em> Other less known web attacks include <em>login CSRF</em>, <em>cookie forcing</em> and <em>session fixation</em>. We refer to the full survey&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0008">8</a>] for an explanation of them, as well as of traditional <em>network attacks</em> enabled by the (partial) adoption of HTTP.</p>     </section>    </section>   </section>   <section id="sec-13">    <header>     <div class="title-info">     <h2>      <span class="section-number">3</span> Defending Web Sessions</h2>     </div>    </header>    <p>In this section we present the criteria adopted to evaluate the solutions proposed in the literature and by standards to protect from attacks against web sessions. We also discuss a couple of well-known defenses against content injection, namely <tt>HttpOnly</tt> cookies and CSP. In&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0008">8</a>] we discuss more than 40 solutions that either tackle specific web attacks or try to provide a more comprehensive degree of protection from different threats.</p>    <section id="sec-14">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.1</span> Evaluation Criteria</h3>     </div>     </header>     <p>We evaluate existing defenses along four different axes:</p>     <ol class="list-no-style">     <li id="list3" label="(1)"><em>protection</em>: we assess the effectiveness of the proposed defense against the conventional threat model of the attack. If the proposal does not prevent the attack in the most general case, we discuss under which assumptions it may still be effective;<br/></li>     <li id="list4" label="(2)"><em>usability</em>: we evaluate whether the proposed mechanism affects the end-user experience, for instance by impacting on the perceived performances of the browser or by involving the user into security decisions;<br/></li>     <li id="list5" label="(3)"><em>compatibility</em>: we discuss how well the defense integrates into the web ecosystem with respect to the current standards, the expected functionalities of websites, and the performances provided by modern network infrastructures. For example, solutions that prevent some websites from working correctly are not compatible with the existing Web. On the other hand, a minor extension to a standard protocol which does not break backward compatibility is acceptable;<br/></li>     <li id="list6" label="(4)"><em>ease of deployment</em>: we consider how practical would be a large-scale deployment of the defensive solution by evaluating the overall effort required by web developers and system administrators for its adoption.<br/></li>     </ol>    </section>    <section id="sec-15">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.2</span> Two Defenses for Content Injection</h3>     </div>     </header>     <section id="sec-16">     <p><em>3.2.1 HttpOnly Cookies.</em>      <tt>HttpOnly</tt> cookies have been introduced in 2002 with the release of Internet Explorer 6 SP1 to prevent the theft of authentication cookies via content injection attacks. Available on all major browsers, this simple yet effective mechanism limits the scope of cookies to HTTP(S) requests, making them unavailable to malicious JavaScript injected in a trusted page.</p>     <p>The protection offered by the <tt>HttpOnly</tt> attribute is only limited to the theft of authentication cookies. The presence of the attribute is transparent to users, hence it has no impact on usability. Also, the attribute perfectly fits the web ecosystem in terms of compatibility with legacy web browsers, since unknown cookie attributes are ignored. Finally, the solution is easy to deploy, assuming there is no need of accessing authentication cookies via JavaScript for generic reasons&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0021">21</a>].</p>     </section>     <section id="sec-17">     <p><em>3.2.2 Content Security Policy.</em> The Content Security Policy (CSP) [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0016">16</a>] is a web security policy standardized by W3C that allows to specify the origins from which the browser is permitted to fetch the resources embedded in a web page. The policy is communicated to the browser via an HTTP header and it is fairly granular, allowing one to distinguish between different types of resources, such as JavaScript, CSS and XHR targets. By default, CSP does not allow inline scripts and CSS directives (which can be used for data exfiltration) and the usage of particularly harmful JavaScript functions (e.g., <tt>eval</tt>). However, these constraints can be disabled by using the <tt>unsafe-inline</tt> and the <tt>unsafe-eval</tt> rules. With the introduction of CSP Level 2&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0017">17</a>], it is possible to selectively white-list inline resources without allowing indiscriminate content execution.</p>     <p>When properly configured, CSP provides an effective defense against XSS attacks. Still, general content injection attacks are not prevented. CSP policies are written by web developers and transparent to users, so their design supports usability. Compatibility and deployment cost are better evaluated together for CSP. On the one hand, it is easy to write a very lax policy which allows the execution of inline scripts and puts only mild restrictions on cross-origin communication: this ensures compatibility. On the other hand, an effective policy for legacy applications can be difficult to deploy, since inline scripts and styles should be removed or manually white-listed, and trusted origins for content inclusion should be carefully identified&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0018">18</a>]. As of now, the deployment of CSP is not particularly significant or effective&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0009">9</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0019">19</a>]. That said, the standardization of CSP by the W3C suggests that the defense mechanism is not too hard to deploy on many websites, at least to get some limited protection.</p>     </section>    </section>   </section>   <section id="sec-18">    <header>     <div class="title-info">     <h2>      <span class="section-number">4</span> Perspective</h2>     </div>    </header>    <p>Having examined different proposals, we now identify five guidelines for the designers of novel web security mechanisms. This is a synthesis of sound principles and insights which have, to different extents, been taken into account by all the designers of the proposals we surveyed.</p>    <section id="sec-19">     <header>     <div class="title-info">      <h3>       <span class="section-number">4.1</span> Guidelines</h3>     </div>     </header>     <section id="sec-20">     <p><em>4.1.1 Transparency.</em> We call <em>transparency</em> the combination of high usability and full compatibility: we think this is the most important ingredient to ensure a large scale deployment of any defensive solution for the Web, given its massive user base and its heterogeneity. It is well-known that security often comes at the cost of usability and that usability defects ultimately weaken security, since users resort to deactivating or otherwise sidestepping the available protection mechanisms&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0015">15</a>]. The Web is extremely variegate and surprisingly fragile even to small changes: web developers who do not desire to adopt new defensive technologies should be able to do so, without any observable change to the semantics of their web applications when these are accessed by security-enhanced web browsers; dually, users who are not willing to update their web browsers should be able to seamlessly navigate websites which implement cutting-edge security mechanisms not supported by their browsers.</p>     <p>All the security decisions must be ultimately taken by web developers. On the one hand, users are not willing or do not have the expertise to be involved in security decisions. On the other hand, it is extremely difficult for browser vendors to come up with &#x201C;one size fits all&#x201D; solutions which do not break any website. Motivated web developers, instead, can be fully aware of their web application semantics, thoroughly test new proposals and configure them to support compatibility.</p>     </section>     <section id="sec-21">     <p><em>4.1.2 Security by Design.</em> Supporting the current Web and legacy web applications is essential, but developers of new websites should be provided with tools which allow them to realize applications which are secure <em>by design</em>. Our feeling is that striving for backward compatibility often hinders the creation of tools which could actually improve the development process of new web applications. Indeed, backward compatibility is often identified with problem-specific patches to known issues, which developers of existing websites can easily plug into their implementation to retrofit it. The result is that developing secure web applications using the current technologies is a painstaking task, which involves actions at many different levels. Developers should be provided with tools and methodologies which allow them to take security into account from the first phases of the development process. This necessarily means deviating from the low-level solutions advocated by many current technologies, to rather focus on more high-level security aspects of the web application, like the definition of principals and their trust relations, the identification of sensitive information, etc.</p>     </section>     <section id="sec-22">     <p><em>4.1.3 Ease of Adoption.</em> Server-side solutions should require a limited effort to be understood and adopted by web developers. For instance, the usage of frameworks which automatically implement recommended security practices, often neglected by web developers, can significantly simplify the development of new secure applications. For client-side solutions, it is important that they work out of the box when they are installed in the user browser: proposals which are not fully automatic are going to be ignored or misused. Any defensive solution which involves both the client and the server is subject to both the previous observations. Since it is unrealistic that a single protection mechanism is able to accommodate all the security needs, it is crucial to design the defensive solution so that it gracefully interacts with existing proposals which address orthogonal issues and which may already be adopted by web developers.</p>     </section>     <section id="sec-23">     <p><em>4.1.4 Declarative Nature.</em> To support a large-scale deployment, new defensive solutions should be <em>declarative</em> in nature: web developers should be given access to an appropriate policy specification language, but the enforcement of the policy should not be their concern. Security checks should not be intermingled with the web application logic: ideally, no code change should be implemented in the web application to make it more secure and a thorough understanding of the web application code should not be necessary to come up with reasonable security policies. This is dictated by very practical needs: existing web applications are huge and complex, are often written in different programming languages and web developers may not have full control over them.</p>     </section>     <section id="sec-24">     <p><em>4.1.5 Formal Specification and Verification.</em> Formal models and tools have been recently applied to the specification and the verification of new proposals for web session security&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0001">1</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0004">4</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0007">7</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0010">10</a>]. While a formal specification may be of no use for web developers, it assists security researchers in understanding the details of the proposed solution. Starting from a formal specification, web security designers can be driven by the enforcement of a clear <em>semantic</em> security property, e.g., non-interference&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0011">11</a>] or session integrity&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0007">7</a>], rather than by the desire of providing ad-hoc solutions to the plethora of low-level attacks which currently target the Web.</p>     <p>This is not merely a theoretical exercise, but it has clear practical benefits. First, it allows a comprehensive identification of <em>all</em> the attack vectors which may be used to violate the intended security property, thus making it harder that subtle attacks are left undetected during the design process. Second, it forces security experts to focus on a rigorous threat model and to precisely state all the assumptions underlying their proposals: this helps making a critical comparison of different solutions and simplifies their possible integration. Third, more speculatively, targeting a property rather than a mechanism allows to get a much better understanding of the security problem, thus fostering the deployment of security mechanisms which are both more complete and easier to use for web developers.</p>     </section>    </section>    <section id="sec-25">     <header>     <div class="title-info">      <h3>       <span class="section-number">4.2</span> Discussion</h3>     </div>     </header>     <p>Retrospectively looking at the solutions we reviewed, we identify a number of carefully crafted proposals which comply with several of the guidelines we presented. Perhaps surprisingly, however, <em>none</em> of the proposals complies with all the guidelines. We argue that this is not inherent to the nature of the guidelines, but rather the simple consequence of web security being hard: indeed, many different problems at very different levels must be taken into account when targeting the largest distributed system in the world.</p>     <p>In the full version of the survey&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0008">8</a>], we discuss what are the most peculiar challenges of the web platform and how they have been driving the evolution of web security research. We also use our guidelines to advocate the adoption of hybrid client/server designs as the most effective architecture for novel web security solutions, recommending the use of formal methods from the first phases of the design process. A very recent survey discusses why and how formal methods can be fruitfully applied to web security and highlights open research directions&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0006">6</a>]. The quest for robust solutions for web session security is far from finished: we refer to&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0008">8</a>] for a discussion on open problems and novel research directions which are worth investigating.</p>    </section>   </section>   <section id="sec-26">    <header>     <div class="title-info">     <h2>      <span class="section-number">5</span> Conclusion</h2>     </div>    </header>    <p>We took a retrospective look at different attacks against web sessions and we surveyed the most popular solutions against them. For each solution, we discussed its security guarantees against different attacker models, its impact on usability and compatibility, and its ease of deployment. We then synthesized five guidelines for the development of new web security solutions, based on the lesson learned from previous experiences. We believe that these guidelines can help web security experts in proposing novel solutions which are both more effective and amenable for a large-scale adoption.</p>   </section>  </section>  <section class="back-matter">   <section id="ref-001">    <header>     <div class="title-info">     <h2 class="page-brake-head">REFERENCES</h2>     </div>    </header>    <ul class="bibUl">     <li id="BibPLXBIB0001" label="[1]">Devdatta Akhawe, Adam Barth, Peifung&#x00A0;E. Lam, John&#x00A0;C. Mitchell, and Dawn Song. 2010. Towards a Formal Foundation of Web Security. In <em>      <em>Proceedings of the 23rd IEEE Computer Security Foundations Symposium, CSF 2010</em>     </em>. 290&#x2013;304.</li>     <li id="BibPLXBIB0002" label="[2]">Chetan Bansal, Karthikeyan Bhargavan, Antoine Delignat-Lavaud, and Sergio Maffeis. 2013. Keys to the Cloud: Formal Analysis and Concrete Attacks on Encrypted Web Storage. In <em>      <em>Proceedings of the 2nd International Conference on Principles of Security and Trust, POST 2013</em>     </em>. 126&#x2013;146.</li>     <li id="BibPLXBIB0003" label="[3]">Adam Barth. 2011. HTTP State Management Mechanism. http://tools.ietf.org/html/rfc6265. (2011).</li>     <li id="BibPLXBIB0004" label="[4]">Aaron Bohannon and Benjamin&#x00A0;C. Pierce. 2010. Featherweight Firefox: Formalizing the Core of a Web Browser. In <em>      <em>USENIX Conference on Web Application Development, WebApps 2010</em>     </em>.</li>     <li id="BibPLXBIB0005" label="[5]">Andrew Bortz, Adam Barth, and Alexei Czeskis. 2011. Origin Cookies: Session Integrity for Web Applications. In <em>      <em>Web 2.0 Security &#x0026; Privacy Workshop (W2SP 2011)</em>     </em>.</li>     <li id="BibPLXBIB0006" label="[6]">Michele Bugliesi, Stefano Calzavara, and Riccardo Focardi. 2017. Formal methods for web security. <em>      <em>Journal of Logical and Algebraic Methods in Programming</em>     </em>87 (2017), 110&#x2013;126.</li>     <li id="BibPLXBIB0007" label="[7]">Michele Bugliesi, Stefano Calzavara, Riccardo Focardi, Wilayat Khan, and Mauro Tempesta. 2014. Provably Sound Browser-Based Enforcement of Web Session Integrity. In <em>      <em>Proceedings of the IEEE 27th Computer Security Foundations Symposium, CSF 2014</em>     </em>. 366&#x2013;380.</li>     <li id="BibPLXBIB0008" label="[8]">Stefano Calzavara, Riccardo Focardi, Marco Squarcina, and Mauro Tempesta. 2017. Surviving the Web: A Journey into Web Session Security. <em>      <em>ACM Comput. Surv.</em>     </em>50, 1 (2017), 13:1&#x2013;13:34.</li>     <li id="BibPLXBIB0009" label="[9]">Stefano Calzavara, Alvise Rabitti, and Michele Bugliesi. 2016. Content Security Problems? Evaluating the Effectiveness of Content Security Policy in the Wild. In <em>      <em>Proceedings of the 23rd ACM Conference on Computer and Communications Security, CCS 2016</em>     </em>. 1365&#x2013;1375.</li>     <li id="BibPLXBIB0010" label="[10]">Daniel Fett, Ralf K&#x00FC;sters, and Guido Schmitz. 2014. An Expressive Model for the Web Infrastructure: Definition and Application to the Browser ID SSO System. In <em>      <em>Proceedings of the 35th IEEE Symposium on Security and Privacy, S&#x0026;P 2014</em>     </em>. 673&#x2013;688.</li>     <li id="BibPLXBIB0011" label="[11]">Willem&#x00A0;De Groef, Dominique Devriese, Nick Nikiforakis, and Frank Piessens. 2012. FlowFox: a Web Browser with Flexible and Precise Information Flow Control. In <em>      <em>Proceedings of the 19th ACM Conference on Computer and Communications Security, CCS 2012</em>     </em>. 748&#x2013;759.</li>     <li id="BibPLXBIB0012" label="[12]">Norman Hardy. 1988. The Confused Deputy (or why capabilities might have been invented). <em>      <em>Operating Systems Review</em>     </em>22, 4 (1988), 36&#x2013;38.</li>     <li id="BibPLXBIB0013" label="[13]">Mario Heiderich, Marcus Niemietz, Felix Schuster, Thorsten Holz, and J&#x00F6;rg Schwenk. 2012. Scriptless Attacks: Stealing the Pie Without Touching the Sill. In <em>      <em>Proceedings of the 19th ACM Conference on Computer and Communications Security, CCS 2012</em>     </em>. 760&#x2013;771.</li>     <li id="BibPLXBIB0014" label="[14]">OWASP. 2013. Top 10 Security Threats. https://www.owasp.org/index.php/Top_10_2013-Top_10. (2013).</li>     <li id="BibPLXBIB0015" label="[15]">Mary&#x00A0;Frances Theofanos and Shari&#x00A0;Lawrence Pfleeger. 2011. Guest Editors&#x2019; Introduction: Shouldn&#x0027;t All Security Be Usable?<em>      <em>IEEE Security &#x0026; Privacy</em>     </em>9, 2 (2011), 12&#x2013;17.</li>     <li id="BibPLXBIB0016" label="[16]">W3C. 2012. Content Security Policy. http://www.w3.org/TR/CSP/. (2012).</li>     <li id="BibPLXBIB0017" label="[17]">W3C. 2015. Content Security Policy Level 2. https://www.w3.org/TR/CSP2/. (2015).</li>     <li id="BibPLXBIB0018" label="[18]">Joel Weinberger, Adam Barth, and Dawn Song. 2011. Towards Client-side HTML Security Policies. In <em>      <em>6th USENIX Workshop on Hot Topics in Security, HotSec 2011</em>     </em>.</li>     <li id="BibPLXBIB0019" label="[19]">Michael Weissbacher, Tobias Lauinger, and William&#x00A0;K. Robertson. 2014. Why Is CSP Failing? Trends and Challenges in CSP Adoption. In <em>      <em>Proceedings of the 17th International Symposium on Research in Attacks, Intrusions and Defenses, RAID 2014</em>     </em>. 212&#x2013;233.</li>     <li id="BibPLXBIB0020" label="[20]">Michal Zalewski. 2011. Postcards From the Post-XSS World. (2011). <a class="link-inline force-break" href="http://lcamtuf.coredump.cx/postxss/">http://lcamtuf.coredump.cx/postxss/</a>.</li>     <li id="BibPLXBIB0021" label="[21]">Yuchen Zhou and David Evans. 2010. Why Aren&#x0027;t HTTP-only Cookies More Widely Deployed?. In <em>      <em>Web 2.0 Security and Privacy Workshop, W2SP 2010</em>     </em>.</li>    </ul>   </section>  </section>  <section id="foot-001" class="footnote">   <header>    <div class="title-info">     <h2>FOOTNOTE</h2>    </div>   </header>   <div class="bibStrip">    <p>This paper is published under the Creative Commons Attribution 4.0 International (CC-BY&#x00A0;4.0) license. Authors reserve their rights to disseminate the work on their personal and corporate Web sites with the appropriate attribution.</p>    <p>     <em>WWW '18, April 23-27, 2018, Lyon, France</em>    </p>    <p>&#x00A9; 2018; IW3C2 (International World Wide Web Conference Committee), published under Creative Commons CC-BY&#x00A0;4.0 License. ACM ISBN 978-1-4503-5640-4/18/04.<br/>DOI: <a class="link-inline force-break" target="_blank"     href="https://doi.org/10.1145/3184558.3186232">https://doi.org/10.1145/3184558.3186232</a>    </p>   </div>  </section>  <div class="pubHistory">   <p/>  </div>  </body> </html> 
