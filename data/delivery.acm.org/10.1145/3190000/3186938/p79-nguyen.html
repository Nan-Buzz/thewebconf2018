<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head>  <title>Trusternity: Auditing Transparent Log Server with Blockchain</title>  <!-- Copyright (c) 2010-2015 The MathJax Consortium --><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>  <meta name="viewport" content="width=device-width; initial-scale=1.0;"></meta>  <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>  <link media="screen, print" rel="stylesheet"    href="../../../../dl.acm.org/pubs/lib/css/bootstrap.min.css"/><link media="screen, print" rel="stylesheet"    href="../../../../dl.acm.org/pubs/lib/css/bootstrap-theme.min.css"/><link media="screen, print" rel="stylesheet"    href="../../../../dl.acm.org/pubs/lib/css/main.css"/><script src="../../../../dl.acm.org/pubs/lib/js/jquery.min.js" type="text/javascript"></script>  <script src="../../../../dl.acm.org/pubs/lib/js/bootstrap.min.js" type="text/javascript"></script>  <script src="../../../../dl.acm.org/pubs/lib/js/bibCit.js" type="text/javascript"></script>  <script src="../../../../dl.acm.org/pubs/lib/js/divTab.js" type="text/javascript"></script>  <script type="text/javascript"    src="../../../../dl.acm.org/pubs/lib/js/MathJax.js?config=TeX-AMS_CHTML"></script>  <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>  </head>  <body id="main">  <section class="front-matter">   <section>    <header class="title-info">     <div class="journal-title">     <h1>      <span class="title">Trusternity: Auditing Transparent Log Server with Blockchain</span>      <br/>      <span class="subTitle"/>     </h1>     </div>    </header>    <div class="authorGroup">     <div class="author">     <span class="givenName">Hoang-Long</span>      <span class="surName">Nguyen</span>     Universit&#x00E9; de Lorraine, CNRS, Inria, LORIA, F-54000 Nancy, France     </div>     <div class="author">     <span class="givenName">Claudia-Lavinia</span>      <span class="surName">Ignat</span>     Universit&#x00E9; de Lorraine, CNRS, Inria, LORIA, F-54000 Nancy, France     </div>     <div class="author">     <span class="givenName">Olivier</span>      <span class="surName">Perrin</span>     Universit&#x00E9; de Lorraine, CNRS, Inria, LORIA, F-54000 Nancy, France, <a href="mailto:hoang-long.nguyen@loria.fr">hoang-long.nguyen@loria.fr</a>     </div>        </div>    <br/>    <div class="pubInfo">     <p>DOI: <a href="https://doi.org/10.1145/3184558.3186938" target="_blank">https://doi.org/10.1145/3184558.3186938</a>     <br/>WWW '18: <a href="https://doi.org/10.1145/3184558" target="_blank">Proceedings of The Web Conference 2018</a>, Lyon, France, April 2018</p>    </div>    <div class="abstract">     <p>     <small>Public key server is a simple yet effective way of key management in secure end-to-end communication. To ensure the trustworthiness of a public key server, transparent log systems such as CONIKS employ a tamper-evident data structure on the server and a gossiping protocol among clients in order to detect compromised servers. However, due to lack of incentive and vulnerability to malicious clients, a gossiping protocol is hard to implement in practice. Meanwhile, alternative solutions such as EthIKS are not scalable. This paper presents <em>Trusternity</em>, an auditing scheme relying on Ethereum blockchain that is easy to implement, scalable and inexpensive to operate.</small>     </p>    </div>    <div class="CCSconcepts">     <p> <small> <span style="font-weight:bold;">CCS Concepts:</span> &#x2022;<strong> Security and privacy </strong>&#x2192; <strong>Authentication;</strong></small> </p>    </div>    <div class="classifications">     <div class="author">     <span style="font-weight:bold;">      <small>Keywords:</small>     </span>     <span class="keyword">      <small>blockchain</small>, </span>     <span class="keyword">      <small> key transparency</small>, </span>     <span class="keyword">      <small> auditing</small>, </span>     <span class="keyword">      <small> Ethereum</small>     </span>     </div>     <br/>     <div class="AcmReferenceFormat">     <p>      <small>       <span style="font-weight:bold;">ACM Reference Format:</span>       <br/>       Hoang-Long Nguyen, Claudia-Lavinia Ignat, and Olivier Perrin. 2018. Trusternity: Auditing Transparent Log Server with Blockchain. In <em>WWW '18 Companion: The 2018 Web Conference Companion,</em>       <em>April 23&#x2013;27, 2018,</em>       <em> Lyon, France. ACM, New York, NY, USA</em> 2 Pages. <a href="https://doi.org/10.1145/3184558.3186938" class="link-inline force-break"        target="_blank">https://doi.org/10.1145/3184558.3186938</a></small>     </p>     </div>    </div>   </section>  </section>  <section class="body">   <section id="sec-2">    <header>     <div class="title-info">     <h2>      <span class="section-number">1</span> Introduction</h2>     </div>    </header>    <p>End-to-end encryption (<em>E2EE</em>) has become more popular over the years due to the increase in public awareness about online privacy and the dangers of digital snooping or identity and data theft. A major challenge in E2EE system is to prevent Man-in-the-Middle (<em>MITM</em>) attack where an adversary impersonates a legitimate communication participant. Currently, popular E2EE systems (e.g. WhatsApp) adopt the use of trusted <em>key servers</em> to distribute and authenticate public keys among clients to prevent MITM. However, such servers can be vulnerable to attacks from adversaries or surveillance requests from authorities.</p>    <p>While it is difficult to preemptively protect a key server, it is possible for the clients to, later on, check if the key server behaved correctly during communication. Such technique is called <em>Key transparency</em>&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0005">5</a>]&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0008">8</a>]. The general idea is that the key server maintains a <em>transparent log</em> using a Merkle Tree that is append-only and can be efficiently <em>audited</em>. To audit the server, clients request a compact proof from the server to show that their uploaded public keys are not modified. Any attempt to modify client keys will be recorded on the server log and a client can check if the server is behaving maliciously. Also, to prevent a compromised server to present different keys and proofs to different clients, the auditing process includes a <em>separated gossiping protocol</em> among clients to cross-validate the proofs.</p>    <p>However, such gossiping mechanism is hard to implement in practice. It is vulnerable to certain classes of failures when adversaries are present in the network&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0004">4</a>]. It is also hard to incentivize clients to participate in gossiping. A similar effort in Certificate Transparency&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0007">7</a>] is being standardized though after several years it is not yet finished. Rather than using a separate gossiping protocol, EthIKS [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0002">2</a>] implements the transparent log server on Ethereum blockchain [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0009">9</a>]. However, as EthIKS operation cost increases proportionally with the number of users and due to the significant increase in the price of ETH, the system does not scale to large key servers with millions of users.</p>    <p>In this paper we present <em>     <strong>Trusternity</strong>     </em>, a practical transparent log auditing scheme using blockchain that addresses shortcomings of state-of-the-art approaches. We use blockchain as an immutable storage for proofs required in the auditing process. We also optimized cost by avoiding computation on-chain. Therefore, our scheme is secure, easy to implement, suitable for large scale key servers, as well as lightweight for clients.</p>   </section>   <section id="sec-3">    <header>     <div class="title-info">     <h2>      <span class="section-number">2</span> Approach</h2>     </div>    </header>    <figure id="fig1">     <img src="../../../../deliveryimages.acm.org/10.1145/3190000/3186938/images/www18companion-178-fig1.jpg" class="img-responsive" alt="Figure 1"      longdesc=""/>     <div class="figure-caption">     <span class="figure-number">Figure 1:</span>     <span class="figure-title">Trusternity architecture</span>     </div>    </figure>    <p>We developed Trusternity as an extension to CONIKS&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0006">6</a>], the first transparent log key management solution for end users. In CONIKS, a user runs a client software to upload their public keys to a CONIKS server. Our Trusternity extension allows the CONIKS server to disseminate a public verifiable proof to the blockchain. When a client downloads public keys from the server, it can cross-check this proof value from the blockchain with the downloaded data to ensure the integrity of the key server. We depict Trusternity architecture in Figure&#x00A0;<a class="fig" href="#fig1">1</a>. Our system contains four modules: <em>Server</em>, <em>Smart Contract</em>, <em>Storage</em> and <em>Client</em>.</p>    <p>     <strong>(1) Trusternity server:</strong> A Trusternity server <em>TS</em> is a transparent key server that enables auditing via Ethereum. <em>TS</em> consists of three components: a <em>CONIKS Server S</em>, a <em>Trusternity extension</em> for server <em>Sx</em> and an Ethereum wallet <em>W</em>. As originally designed in CONIKS, when a user registers his public key with <em>TS</em>, <em>S</em> uses a <em>Merkle radix tree</em> to map the user-key binding at a leaf. After a fixed period of time (an <em>epoch</em>), <em>S</em> signs the <em>root</em> hash of the tree to make a <em>Signed Tree Root</em> (<em>STR</em>). A <em>STR<sub>t</sub>     </em> at epoch <em>t</em> is also hashed together with <em>STR</em>     <sub>     <em>t</em> &#x2212; 1</sub> to form an ever growing hash chain to commit the entire history of the key server.</p>    <p>We then developed <em>Sx</em> as a plugin for <em>S</em>. The extension allows <em>S</em> to communicate with <em>W</em>, the official Go implementation of the Ethereum protocol&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0001">1</a>], via an RPC API. At every <em>epoch t</em>, <em>TS</em> sends on the blockchain network an Ethereum <em>transaction</em> embedded with <em>STR<sub>t</sub>     </em> to a smart contract.</p>    <p>     <strong>(2) Trusternity Smart Contract:</strong> We develop a Trusternity smart contract <em>TSC</em> on Ethereum. The smart contract exposes two main functions: <em>Register</em> that accepts <em>TS</em> registration and <em>Publish</em> that stores <em>STR</em> on each epoch. <em>TSC</em> enforces policy on how a <em>TS</em> can publish data such as epoch number uniqueness or sequence order.</p>    <p>     <strong>(3) Storage:</strong>     <em>TSC</em> does not store <em>STR</em> in the default smart contract storage. Instead, we use Ethereum <em>transaction log</em> for this purpose. A transaction log <em>L</em> is a collection of <em>log entry l</em> representing the result of the code execution in Ethereum virtual machine. <em>L</em> can be recomputed at anytime by re-executing the code stored in the blockchain. According to Ethereum yellow paper&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0009">9</a>], the cost of storing a byte in the transaction log is 8 <em>gas</em> (an internal unit) compared to 625 <em>gas</em> for storing it inside the smart contract.</p>    <p>     <strong>(4) Trusternity client:</strong> A Trusternity client <em>TC</em> is a key management software that a user runs on his computer. <em>TC</em> has three components: a <em>CONIKS client C</em>, a <em>light Ethereum wallet Wl</em> and a <em>Trusternity extension</em> for client <em>Cx</em>. <em>C</em> performs public key registration and looks up other public keys by sending HTTP requests to <em>S</em> as designed in CONIKS.</p>    <p>We add an extension module <em>Cx</em> to <em>C</em> that handles public key auditing using Ethereum. The extension synchronizes epoch time with the server, regularly performs look up and audits registered public keys. Unlike <em>TS</em>, <em>TC</em> uses a light Ethereum wallet that can significantly reduce local storage and network bandwidth concerning the blockchain. While a light wallet cannot offer full security model as a full one, it is able to &#x201C;watch&#x201D; for <em>Publish</em> events with efficient verifiable proofs&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0003">3</a>].</p>   </section>   <section id="sec-4">    <header>     <div class="title-info">     <h2>      <span class="section-number">3</span> Evaluation</h2>     </div>    </header>    <p>We evaluated Trusternity and compared the results with EthIKS.</p>    <p>     <strong>Security:</strong> Trusternity is an extension of CONIKS. Thus, we retain the proven security of the CONIKS client/server data structures and protocols. After each <em>Publish</em> call, <em>TSC</em> holds <em>STR<sub>e</sub>     </em> of epoch <em>e</em> on Ethereum transaction logs. If <em>TS</em> maliciously updates <em>PK<sub>Alice</sub>     </em> without informing <em>Alice</em>, <em>Alice</em> can query the log to discover the change in <em>STR</em>. Even when <em>TC</em> uses a light wallet, the adversary can neither trick <em>TC</em> into accepting a fake transaction nor modify any published <em>STR</em> due to the immutability property of the blockchain.</p>    <p>     <strong>Network overhead:</strong> We theoretically computed the client network overhead by reusing assumptions from EthIKS and Ethereum yellow paper. In particular, we assume a total number of users <em>U</em> = 2<sup>32</sup> and consider that <em>u</em> = 2<sup>21</sup> users update their keys every epoch. We also assume that <em>k</em> = 24 epochs per day. In our case, for each epoch, <em>TC</em> downloads &#x2248; 201.6<em>KB</em>, resulting in less than 5MB per day to operate while an EthIKS client has to download the full blockchain in order to avoid relying on a trusted party.</p>    <p>     <strong>Server cost:</strong> In order to send a transaction to the Ethereum network, <em>TS</em> must pay a transaction cost in ETH. Trusternity operation cost consists of the transaction costs of the two smart contrat functions <em>Register</em> and <em>Publish</em>. Using the ETH price from January 1<sup>     <em>st</em>     </sup> 2018 (&#x2248; 500), <em>Register</em> costs 0.63 which <em>TS</em> only has to pay once during registration to <em>TSC</em> and 0.44 for each subsequent <em>Publish</em> call per epoch or &#x2248; 10 per day regardless of the size of the key server. This is because we only publish a 256-bit hash of <em>STR</em> at every epoch on Ethereum. Meanwhile, as EthIKS stores the whole Merkle tree data structure on the smart contract, EthIKS costs will increase proportional to the size of the tree.</p>   </section>   <section id="sec-5">    <header>     <div class="title-info">     <h2>      <span class="section-number">4</span> conclusion</h2>     </div>    </header>    <p>We have presented Trusternity, an auditing mechanism for Transparent log key server using Ethereum which is significantly more efficient and budget than state-of-the art approaches. Our solution scales with an unbound number of log clients. It is efficient and does not require any trusted third-party. Trusternity is also easy to extend for other purposes. Other transparent log based approaches such as Certificate Transparency&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0007">7</a>] can benefit from our proposal. For example, we can replace the CONIKS clients and servers with similar components, i.e. Key Transparency&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0005">5</a>] servers and clients.</p>   </section>  </section>  <section class="back-matter">   <section id="ref-001">    <header>     <div class="title-info">     <h2 class="page-brake-head">REFERENCES</h2>     </div>    </header>    <ul class="bibUl">     <li id="BibPLXBIB0001" label="[1]">2017. Go Ethereum: Official Go implementation of the Ethereum protocol. https://geth.ethereum.org/. (2017).</li>     <li id="BibPLXBIB0002" label="[2]">Joseph Bonneau. 2016. EthIKS: Using Ethereum to audit a CONIKS key transparency log. In <em>      <em>International Conference on Financial Cryptography and Data Security</em>     </em>. Springer, 95&#x2013;105.</li>     <li id="BibPLXBIB0003" label="[3]">Vitalik Buterin. 2016. Ethereum Light client protocol. https://github.com/ethereum/wiki/wiki/Light-client-protocol. (2016).</li>     <li id="BibPLXBIB0004" label="[4]">John&#x00A0;R Douceur. 2002. The sybil attack. In <em>      <em>International Workshop on Peer-to-Peer Systems</em>     </em>. Springer, 251&#x2013;260.</li>     <li id="BibPLXBIB0005" label="[5]">Google. 2017. Key Transparency. https://github.com/google/keytransparency. (2017).</li>     <li id="BibPLXBIB0006" label="[6]">http://coniks.org. 2018. A CONIKS implementation in Golang. https://github.com/coniks-sys/coniks-go. (2018). Accessed on 08.01.2018.</li>     <li id="BibPLXBIB0007" label="[7]">Ben Laurie, Adam Langley, and Emilia Kasper. 2013. <em>      <em>Certificate transparency</em>     </em>. Technical Report.</li>     <li id="BibPLXBIB0008" label="[8]">Marcela&#x00A0;S Melara, Aaron Blankstein, Joseph Bonneau, Edward&#x00A0;W Felten, and Michael&#x00A0;J Freedman. 2015. CONIKS: Bringing key transparency to end users. In <em>      <em>24th USENIX Security Symposium (USENIX Security 15)</em>     </em>. 383&#x2013;398.</li>     <li id="BibPLXBIB0009" label="[9]">Gavin Wood. 2014. Ethereum: A secure decentralised generalised transaction ledger. <em>      <em>Ethereum Project Yellow Paper</em>     </em>151 (2014), 1&#x2013;32.</li>    </ul>   </section>  </section>  <section id="foot-001" class="footnote">   <header>    <div class="title-info">     <h2>FOOTNOTE</h2>    </div>   </header>   <div class="bibStrip">    <p>This paper is published under the Creative Commons Attribution 4.0 International (CC-BY&#x00A0;4.0) license. Authors reserve their rights to disseminate the work on their personal and corporate Web sites with the appropriate attribution.</p>    <p>     <em>WWW '18, April 23-27, 2018, Lyon, France</em>    </p>    <p>&#x00A9; 2018; IW3C2 (International World Wide Web Conference Committee), published under Creative Commons CC-BY&#x00A0;4.0 License. ACM ISBN 978-1-4503-5640-4/18/04.<br/>DOI: <a class="link-inline force-break" target="_blank"     href="https://doi.org/10.1145/3184558.3186938">https://doi.org/10.1145/3184558.3186938</a>    </p>   </div>  </section>  <div class="pubHistory">   <p/>  </div>  </body> </html> 
