<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head>  <title>AdBudgetKiller: Online Advertising Budget Draining Attack</title>  <!-- Copyright (c) 2010-2015 The MathJax Consortium --><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>  <meta name="viewport" content="width=device-width; initial-scale=1.0;"></meta>  <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>  <link media="screen, print" rel="stylesheet"    href="../../../data/dl.acm.org/pubs/lib/css/bootstrap.min.css"/><link media="screen, print" rel="stylesheet"    href="../../../data/dl.acm.org/pubs/lib/css/bootstrap-theme.min.css"/><link media="screen, print" rel="stylesheet"    href="../../../data/dl.acm.org/pubs/lib/css/main.css"/><script src="../../../data/dl.acm.org/pubs/lib/js/jquery.min.js" type="text/javascript"></script>  <script src="../../../data/dl.acm.org/pubs/lib/js/bootstrap.min.js" type="text/javascript"></script>  <script src="../../../data/dl.acm.org/pubs/lib/js/bibCit.js" type="text/javascript"></script>  <script src="../../../data/dl.acm.org/pubs/lib/js/divTab.js" type="text/javascript"></script>  <script type="text/javascript"    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script>  <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>  </head>  <body id="main">
<div>
<p style='font-size: 75%; color #444'>
This is a web copy of <a href='https://doi.org/10.1145/3178876.3186096'>https://doi.org/10.1145/3178876.3186096</a> 
originally published by ACM Press, 
redistributed under the terms of 
<a href='https://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 (CC BY 4.0)</a>.
The <a href='https://github.com/usable-oa/thewebconf2018/tree/master/scripts'>modifications</a> 
from the original are solely to improve HTML aiming to make it Findable, Accessible, Interoperable and Reusable. 
augmenting HTML metadata and avoiding ACM trademark.
To reference this HTML version, use:
</p><p>
<strong>Permalink:</strong>
<a href='https://w3id.org/oa/10.1145/3178876.3186096'>https://w3id.org/oa/10.1145/3178876.3186096</a>
</p></div>
<hr>

  <section class="front-matter">   <section>    <header class="title-info">     <div class="journal-title">     <h1>      <span class="title">AdBudgetKiller: Online Advertising Budget Draining Attack</span>      <br/>      <span class="subTitle"/>     </h1>     </div>    </header>    <div class="authorGroup">     <div class="author">     <span class="givenName">I Luk</span>      <span class="surName">Kim</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:kim1634@purdue.edu">kim1634@purdue.edu</a>     </div>     <div class="author">     <span class="givenName">Weihang</span>      <span class="surName">Wang</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:wang1315@cs.purdue.edu">wang1315@cs.purdue.edu</a>     </div>     <div class="author">     <span class="givenName">Yonghwi</span>      <span class="surName">Kwon</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:kwon58@purdue.edu">kwon58@purdue.edu</a>     </div>     <div class="author">     <span class="givenName">Yunhui</span>      <span class="surName">Zheng</span>,     IBM T.J. Watson Research Center, Yorktown Heights, New York 10598, <a href="mailto:zhengyu@us.ibm.com">zhengyu@us.ibm.com</a>     </div>     <div class="author">     <span class="givenName">Yousra</span>      <span class="surName">Aafer</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:yaafer@purdue.edu">yaafer@purdue.edu</a>     </div>     <div class="author">     <span class="givenName">Weijie</span>      <span class="surName">Meng</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:mengw@purdue.edu">mengw@purdue.edu</a>     </div>     <div class="author">     <span class="givenName">Xiangyu</span>      <span class="surName">Zhang</span>,     Department of Computer Science, Purdue University, West Lafayette, Indiana 47907, <a href="mailto:xyzhang@cs.purdue.edu">xyzhang@cs.purdue.edu</a>     </div>                                  </div>    <br/>    <div class="pubInfo">     <p>DOI: <a href="https://doi.org/10.1145/3178876.3186096" target="_blank">https://doi.org/10.1145/3178876.3186096</a>     <br/>WWW '18: <a href="https://doi.org/10.1145/3178876" target="_blank">Proceedings of The Web Conference 2018</a>, Lyon, France, April 2018</p>    </div>    <div class="abstract">     <p>     <small>In this paper, we present a new ad budget draining attack. By repeatedly pulling ads from targeted advertisers using crafted browsing profiles, we are able to reduce the chance of showing their ads to real-human visitors and trash the ad budget. From the advertiser profiles collected by an automated crawler, we infer advertising strategies, train satisfying browsing profiles and launch large-scale attacks. We evaluate our methods on 291 public advertisers selected from Alexa Top 500, where we successfully reveal the targeting strategies used by 87% of the advertisers we considered. We also executed a series of attacks against a controlled advertiser and 3 real-world advertisers within the ethical and legal boundary. The results show that we are able to fetch 40,958 ads and drain up to <font style="normal">&#x0024;</font>155.89 from the targeted advertisers within an hour.</small>     </p>    </div>    <div class="CCSconcepts">     <p> <small> <span style="font-weight:bold;">CCS Concepts:</span> &#x2022;<strong> Security and privacy </strong>&#x2192; <strong>Spoofing attacks;</strong> <strong>Web application security;</strong></small> </p>    </div>    <div class="classifications">     <div class="author">     <span style="font-weight:bold;">      <small>Keywords:</small>     </span>     <span class="keyword">      <small>Online Advertising</small>, </span>     <span class="keyword">      <small> Ad Fraud</small>, </span>     <span class="keyword">      <small> Budget Draining Attack</small>     </span>     </div>     <br/>     <div class="AcmReferenceFormat">     <p>      <small>       <span style="font-weight:bold;">ACM Reference Format:</span>       <br/>       I Luk Kim, Weihang Wang, Yonghwi Kwon, Yunhui Zheng, Yousra Aafer, Weijie Meng, and Xiangyu Zhang. 2018. AdBudgetKiller: Online Advertising Budget Draining Attack. In <em>WWW 2018: The 2018 Web Conference,</em>       <em>April 23&#x2013;27, 2018,</em>       <em> Lyon, France. ACM, New York, NY, USA</em> 11 Pages. <a href="https://doi.org/10.1145/3178876.3186096" class="link-inline force-break"        target="_blank">https://doi.org/10.1145/3178876.3186096</a></small>     </p>     </div>    </div>   </section>  </section>  <section class="body">   <section id="sec-8">    <header>     <div class="title-info">     <h2>      <span class="section-number">1</span> Introduction</h2>     </div>    </header>    <p>Online advertising is the primary source of income for many Internet companies. In the US market, Google and Facebook generated <font style="normal">&#x0024;</font>36.69 and <font style="normal">&#x0024;</font>12.4 billion&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0022">22</a>] from advertising in 2016 respectively. According to a report by the Internet Advertising Bureau (IAB), the revenues generated from Internet advertising in the United States totaled <font style="normal">&#x0024;</font>72.5 billion in the full year 2016&#x00A0;[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0020">20</a>], which represents an increase of 21.8% from the revenues reported in 2015. It is estimated that the U.S. digital advertising will continue its growth and the ad revenue will reach <font style="normal">&#x0024;</font>83 billion in 2017 [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0022">22</a>].</p>    <p>In its basic form, online advertising entails selling spaces on websites to parties interested in showing ads for a monetary fee. However, the mechanisms and backing up the online advertising ecosystem are quite complex. The ad delivery infrastructure involves four major parties: <em>publishers</em>, <em>advertisers</em>, <em>ad network</em>, and <em>ad exchange</em>. Publishers are websites owners who offer space to display ads on their websites. Advertisers pay publishers for ad slots to place specific ad content with embedded links. Ad networks play the role of match-makers to bring together publishers with advertisers who are willing to pay the most for the publisher&#x0027;s offered space. Ad exchanges are networks of ad networks. An ad exchange works similarly as an ad network, except that the buying and selling entities within an ad exchange are ad networks.</p>    <p>To reach the most receptive audience, advertisers often use sophisticated targeting methods to serve ads to the right viewers. The targeting strategies can either be geographical based such as serving an ad to users in a specific country or demographically focused on age, gender, etc. They can also be behavioral variables (such as a user&#x0027;s browsing activities and the purchase history) or contextually focused by serving ads based on the content of a website. In addition, advertisers may employ different targeting strategies. Some advertisers may value customers who placed an item in cart as more promising potential buyers than customers who simply browsed the item page. So they deliver different ads to these two types of customers. Others may consider them as equally favorable and apply the same strategy.</p>    <p>Retargeting is a technique where advertisers use behavioral targeting strategies to promote ads that follow users after they have expressed a prior interest in an advertiser&#x0027;s website, such as looked at or purchased a particular product. Retargeting is very effective as a retargeting ad is personalized to an individual user&#x0027;s interests, rather than targeting groups of people whose interests may vary.</p>    <p>Given the underlying lucrative benefits, the involved ad parties have strong incentives to conduct fraudulent activities. In fact, advertising fraud becomes a massive problem in ad industry and is ruining this billion-dollar business. According to IAB, ad fraud is costing the U.S. media industry around <font style="normal">&#x0024;</font>8.2 billion in 2015 [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0019">19</a>] and half of the loss derives from &#x201C;non-human traffic&#x201D;.</p>    <p>In this paper, we propose an innovative ad budget draining attack by precisely fetching ads from the targeted advertisers. Our technique is able to reverse engineer targeting strategies and train browsing profiles that satisfy the conditions set by the advertisers. In summary, we make the following contributions.</p>    <ul class="list-no-style">     <li id="list1" label="&#x2022;">We propose a novel ad budget draining attack targeting at specific advertisers by repeatedly pulling their ads to trash the budget.<br/></li>     <li id="list2" label="&#x2022;">We develop a black-box testing based technique to automatically infer targeting strategies and create satisfying browsing profiles.<br/></li>     <li id="list3" label="&#x2022;">Out of 291 advertisers selected from Alexa Top 500, we successfully revealed the targeting strategies used by 254 advertisers.<br/></li>     <li id="list4" label="&#x2022;">We launched distributed attacks against a controlled advertiser and 3 real-world advertisers. We are able to fetch 40,958 ads and drained up to <font style="normal">&#x0024;</font>155.89 within an hour.<br/></li>    </ul>    <p>The rest of this paper is structured as follows. We introduce the online advertising ecosystem and fraudulent activities in Sec. &#x00A0;<a class="sec" href="#sec-9">2</a>. In Sec. &#x00A0;<a class="sec" href="#sec-13">3</a>, we describe the ad budget draining attack in details. We explain the evaluation results on both public and controlled advertisers in Sec. &#x00A0;<a class="sec" href="#sec-27">4</a>. We discuss potential countermeasures in Sec. &#x00A0;<a class="sec" href="#sec-34">5</a> and related work in Sec. &#x00A0;<a class="sec" href="#sec-37">6</a>. We conclude the paper in Sec. &#x00A0;<a class="sec" href="#sec-38">7</a>.</p>   </section>   <section id="sec-9">    <header>     <div class="title-info">     <h2>      <span class="section-number">2</span> Online Advertising</h2>     </div>    </header>    <figure id="fig1">     <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig1.jpg" class="img-responsive" alt="Figure 1"      longdesc=""/>     <div class="figure-caption">     <span class="figure-number">Figure 1:</span>     <span class="figure-title">Ad ecosystem.</span>     </div>    </figure>    <p>In this section, we discuss the entities in the ecosystem and explain how retargeting ad works. We also show existing threats of the ad ecosystem.</p>    <section id="sec-10">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.1</span> Ad Ecosystem</h3>     </div>     </header>     <p>The entities in the ad ecosystem include publishers, advertisers, ad networks, and ad exchanges. Publishers are the websites who earn money by selling ad space on their pages. Advertisers are the buyers who pay ad networks to deliver their ads. Ad networks are the entities that connect advertisers with websites and help advertisers find right publishers. Ad exchanges are networks of ad networks, which enable ad traffic transactions among ad networks.</p>     <p>Fig.&#x00A0;<a class="fig" href="#fig1">1</a> explains how an ad is delivered by an ad exchange. When a user visits the publisher website &#x2460;, an ad request is sent to the ad exchange &#x2461;. The ad exchange conducts a real-time auction, where the exchange sends requests to ad networks &#x2462;. Based on the user&#x0027;s characteristic, ad networks respond with their offers &#x2463;. The ad exchange picks an offer and delivers the winner&#x0027;s ad to the user &#x2464;. The whole auction is done in milliseconds.</p>     <p>The ecosystem delivers ads for a fee. There are several pricing models and <em>cost per thousand impressions</em> (CPM) is commonly used. Assume the CPM is <font style="normal">&#x0024;</font>7 in Fig.&#x00A0;<a class="fig" href="#fig1">1</a>. The winning advertiser (Advertiser 2) pays 0.7 cents per ad, which will be split among the ad network, the ad exchange, and the publisher.</p>    </section>    <section id="sec-11">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.2</span> Retargeting Ad</h3>     </div>     </header>     <p>E-commerce websites want attract potential customers by all means, hoping they will make purchases, become registered users, etc. The percentage of visitors attracted is called the <em>conversion rate</em>. In reality, only 2% of visitors take desired actions in their first visit [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0033">33</a>]. Retargeting is created to attract the remaining customers by display personalized ads. It tracks website visitors and delivers customized ads when they visit other websites.</p>     <p>In particular, advertisers need to identify a list of high-value visitors. To do so, advertisers include a retargeting pixel, which is a small snippet provided by a retargeting service provider, in their web pages. When a user arrives, the pixel drops an anonymous cookie and enroll this visitor to the list. The anonymous cookie acts as the <em>browsing profile</em>, which is a set of IDs and memorizes browsing activities. The retargeting service providers identify unconverted visitors and deliver them personalized ads. To reach more visitors, the retargeting service providers maintain partnership with major ad networks, such as Facebook, and Google Display Network. They participates the real-time ads auctions and bids aggressively.</p>     <p>Retargeting is very effective. E-commerce sites can save money and efforts by selectively targeting visitors who have already expressed interests. According to Kimberly-Clark, a global leader in selling paper products, they accounted for <span class="inline-equation"><span class="tex">$50-60\%$</span>     </span> conversion rates from their retargeting efforts [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0011">11</a>]. Similarly, [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0023">23</a>] reported that online retailer ShopStyle gained a 200% increase in retargeting conversions. Retargeting also benefits customers because the ads delivered are relevant to their interests.</p>    </section>    <section id="sec-12">     <header>     <div class="title-info">      <h3>       <span class="section-number">2.3</span> Threats</h3>     </div>     </header>     <p>While ad exchanges enable efficient and powerful campaigns, their pricing models make the system a highly lucrative target for cyber-criminals. For instance, to artificially inflate the actual impression amount and earn more money, a publisher can fabricate visits to publisher pages such that the advertiser&#x0027;s ad budget is wasted because the ads were not seen by real human visitors. Such fraudulent activity is called <em>impression fraud</em>. Although ad networks and exchanges perform real-time monitoring, it is always difficult to prevent from various kinds of fraud activities because of the huge amount of ad traffic.</p>    </section>   </section>   <section id="sec-13">    <header>     <div class="title-info">     <h2>      <span class="section-number">3</span> Ad Budget Draining Attack</h2>     </div>    </header>    <figure id="fig2">     <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig2.jpg" class="img-responsive" alt="Figure 2"      longdesc=""/>     <div class="figure-caption">     <span class="figure-number">Figure 2:</span>     <span class="figure-title">Ad budget draining attack procedure.</span>     </div>    </figure>    <p>In this section, we elaborate the ad budget draining attack. The victims of our budget draining attack are people or companies that advertise their e-commerce websites using retargeting ad services. The immediate consequence of the attack is the wasted advertisement budget. Moreover, the chance of their ads being displayed can be reduced since it would be difficult to win during the ad auction with the drained ad budget. The potential attackers can be competitor advertisers who may try to drain the others&#x2019; ad budget and unfairly win the competition. Another possible scenario is denial of service (DOS) attacks performed by people who seek to make ads from the targeted advertiser unavailable for the purpose of a protest. Fig. <a class="fig" href="#fig2">2</a> shows the overall attack procedure. The attacker collects data about the targeted advertiser, generates <em>attack modules</em> that automatically craft browsing profiles and pull the victim&#x0027;s ads. Note that the attack modules can be independently deployed to launch distributed attack. Throughout these process, the attacker can drain the targeted advertiser&#x0027;s ad budget by repeatedly fetching ads. The details of our attack mechanism are explained in the rest of this section. <figure id="fig3">     <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig3.jpg" class="img-responsive" alt="Figure 3"       longdesc=""/>     <div class="figure-caption">      <span class="figure-number">Figure 3:</span>      <span class="figure-title">Attack Mechanism.</span>     </div>     </figure>    </p>    <section id="sec-14">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.1</span> Overview</h3>     </div>     </header>     <p>As discussed in Sec.&#x00A0;<a class="sec" href="#sec-9">2</a>, ad networks track website visitors and deliver targeted ads if they satisfy the advertising strategies. Therefore, identifying the strategies is the first step to attack a particular advertiser. Since ad networks may define arbitrary strategies, effectively reverse-engineering the retargeting logic and craft corresponding browsing profiles are the keys to reproducibly launch large-scale attacks. As shown in Fig. &#x00A0;<a class="fig" href="#fig3">3</a>, <em>website modeling</em>, <em>advertiser profiling</em>, <em>attack module generation</em> and <em>attack distribution</em> are the major steps involved in the ad budget draining attack.</p>     <p>     <strong>&#x2460; Website Modeling.</strong>A website model represents structural designs and relationships between web pages. In order to be classified as advertisers&#x2019; favored customers and eventually see their ads, one effective way is to visit the advertisers&#x2019; websites and trigger the tracking logic. However, identifying desired navigation sequences that effectively trigger the tracking logic (e.g., products need to be put in the shopping cart) is not trivial due to the huge search space. Therefore, our first step is to create a model for the targeted website to guide the search. In particular, we navigate the targeted website, apply clustering algorithms to the pages, then create a Finite State Machine (FSM) model. Details can be found in Sec. <a class="sec" href="#sec-15">3.2</a>.</p>     <p>     <strong>&#x2461; Advertiser Profiling.</strong>In this step, we focus on inferring targeting strategies. We develop <em>ADHoneyClient</em> to automatically discover the strategies based on black-box testing techniques. We also identify the optimal ads fetch count to work around the rate limits set by the ad networks. We explain our algorithms in Sec. <a class="sec" href="#sec-19">3.3</a>.</p>     <p>     <strong>&#x2462; Attack Module Generation.</strong>The attack modules generated contain the training data and the utilities to create satisfying browsing profiles, where training data is a set of HTML page with ads tracking tags. The module also features an <em>fetch page</em> and an <em>attack engine</em>. The <em>fetch page</em> is a single HTML page with several ads slots that pull the targeted ads. The <em>attack engine</em> drives the whole training and ad fetching procedure. As ad networks may equip IP based defense mechanisms, our attack engine can leverage the public proxy lists and randomly change IP addresses to evade IP-based detections. Details can be found in Sec. <a class="sec" href="#sec-22">3.4</a>.</p>     <p>     <strong>&#x2463; Attack Distribution.</strong>The final step is to deploy the attack modules on multiple machines to launch a distributed attack. In particular, each attack module trains a browsing profile satisfying the strategy from the training pages and repeatedly fetches ads using the ad fetch page. We explain the details in Sec.&#x00A0;<a class="sec" href="#sec-26">3.5</a>.</p>    </section>    <section id="sec-15">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.2</span> Website Modeling</h3>     </div>     </header>     <figure id="fig4">     <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig4.jpg" class="img-responsive" alt="Figure 4"       longdesc=""/>     <div class="figure-caption">      <span class="figure-number">Figure 4:</span>      <span class="figure-title">Model creation process.</span>     </div>     </figure>     <p>A website model describes its structure and transitions among pages. It can be used to guide the targeting strategy discovery. Fig.&#x00A0;<a class="fig" href="#fig4">4</a> shows the steps for model creation.</p>     <section id="sec-16">     <p><em>3.2.1 Browsing Trace Collector.</em> The browsing trace collected at &#x2460; in Fig.&#x00A0;<a class="fig" href="#fig4">4</a> is used to cluster pages. The collector automatically records browsing activities while an attacker explores the targeted website. Table&#x00A0;<a class="tbl" href="#tab1">1</a> shows example traces. We record two types of data: pages visited and events triggered. The page data contains the HTML source code and the corresponding URL. If no redirection happens, the page ID is recorded (e.g., <em>P</em>      <sub>4</sub> in Table&#x00A0;<a class="tbl" href="#tab1">1</a>). The event data describes the browsing action, the DOM object involved, and action attributes.</p>     <p>Note that we do not require a complete website model. Instead, we only need a few inputs. In practice, we observed that usually a small number of actions are sufficient to trigger the tracking logic. For example, if a visitor sees ads after she visited the advertiser&#x0027;s product page, only one action (i.e., visiting the advertiser&#x0027;s product page) is needed. However, if an advertiser targets visitors who added items to the shopping cart and left without buying, the actions of 1) visiting a product page, 2) clicking the add-to-cart button and 3) visiting the cart page are needed.</p>     <div class="table-responsive" id="tab1">      <div class="table-caption">       <span class="table-number">Table 1:</span>       <span class="table-title">Example of collected browsing trace.</span>      </div>      <table class="table">       <thead>        <tr>        <th style="text-align:center;">         <strong>[c]@c@Trace</strong>        </th>        <th colspan="2" style="text-align:left; border-right: double"">         <strong>Page</strong>         <hr/>        </th>        <th colspan="4" style="text-align:left;">         <strong>Event</strong>         <hr/>        </th>        </tr>        <tr>        <th style="text-align:center; border-right: double">No</th>        <th style="text-align:left; border-right: solid 1px"/>        <th style="text-align:left; border-right: double""/>        <th style="text-align:left; border-right: solid 1px"/>        <th style="text-align:left; border-right: solid 1px"/>        <th style="text-align:left; border-right: solid 1px"/>        <th/>        </tr>       </thead>       <tbody>        <tr>        <td style="text-align:center; border-right: double"/>        <td style="text-align:left; border-right: solid 1px">         <strong>ID</strong>        </td>        <td style="text-align:left; border-right: double">         <strong>URL</strong>        </td>        <td style="text-align:left; border-right: solid 1px"">         <strong>ID</strong>        </td>        <td style="text-align:left; border-right: solid 1px" >         <strong>Action</strong>        </td>        <td style="text-align:left; border-right: solid 1px" >         <strong>XPath</strong>        </td>        <td>         <strong>Data</strong>        </td>        </tr>       </tbody>      </table>     </div>     </section>     <section id="sec-17">     <p><em>3.2.2 Page Clustering.</em> With the trace collected, we group similar pages into clusters based on its functionality. For example, <em>P</em>      <sub>3</sub> and <em>P</em>      <sub>7</sub> in Table<a class="tbl" href="#tab1">1</a> are grouped together as the <em>product page</em>. We apply different clustering methods based on page types:</p>     <ul class="list-no-style">      <li id="list5" label="&#x2022;">The <strong>Redirected Pages</strong> are ones clustered by context (&#x2461; in Fig.&#x00A0;<a class="fig" href="#fig4">4</a>), where we compare page structures. In particular, we calculate the DOM Tree Edit Distance (TED) [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"        href="#BibPLXBIB0027">27</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"        href="#BibPLXBIB0036">36</a>] and measure the similarity using hierarchical clustering algorithms [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"        href="#BibPLXBIB0034">34</a>].<br/></li>      <li id="list6" label="&#x2022;">The <strong>DOM Modified Pages</strong> are ones grouped using a link-based clustering method (&#x2462; in Fig.&#x00A0;<a class="fig" href="#fig4">4</a>). Specifically, DOM modified pages containing page IDs (links) in a same cluster are grouped together. For example, in Table <a class="tbl" href="#tab1">1</a>, the page <em>P</em><sub>4</sub> is linked to the page <em>P</em><sub>3</sub>, and <em>P</em><sub>8</sub> is linked to the page <em>P</em><sub>7</sub>. Since <em>P</em><sub>3</sub> and <em>P</em><sub>7</sub> are in the same cluster (<em>product pages</em>), <em>P</em><sub>4</sub> and <em>P</em><sub>8</sub> are grouped together.<br/></li>     </ul>     </section>     <section id="sec-18">     <p><em>3.2.3 Model Builder.</em> The model builder connects the clusters based on the order observed in traces and assigns event data to the edges. As a result, a Finite State Machine (FSM) is created, where nodes represents <em>states</em> and edges with event annotations denote <em>transitions</em>. Fig.&#x00A0;<a class="fig" href="#fig5">5</a> shows a model created from the example traces. By having a model, we can create proper browsing profiles as many as possible, and more importantly, we can avoid creating redundant profiles. <figure id="fig5">       <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig5.jpg" class="img-responsive" alt="Figure 5"        longdesc=""/>       <div class="figure-caption">        <span class="figure-number">Figure 5:</span>        <span class="figure-title">An example of website model.</span>       </div>      </figure>     </p>     </section>    </section>    <section id="sec-19">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.3</span> Advertiser Profiling</h3>     </div>     </header>     <p>As discussed in Sec.&#x00A0;<a class="sec" href="#sec-9">2</a>, ad networks track website visitors and deliver targeted ads if they satisfy the advertising strategies. As strategies are invisible to us, we have to infer the strategies by profiling the targeted advertisers.</p>     <section id="sec-20">     <p><em>3.3.1 ADHoneyClient: An Automated Ad Crawler.</em> We need a large amount of ads related data to infer the retargeting logic. To automate the data collection process, we develop an ad crawler <em>ADHoneyClient</em> to fetch ads with customized browsing profiles and emulate browsing activities. As ads are probably the most complicated and dynamic snippets observed on general websites, <em>ADHoneyClient</em> has to handle complicated DOM objects and dynamic JavaScript. <em>ADHoneyClient</em> has the following two components:</p>     <p>      <strong>1) Browsing Profile Trainer.</strong>Browsing profiles are tracking IDs stored in <em>cookies</em> that memorize the browsing history. <em>Browsing profile trainer</em> crafts browsing profiles by triggering ads tracking logic. Starting from a fresh profile, the <em>profile trainer</em> produces customized browsing profiles by simulating browsing activities. It navigates the website guided by the model with example inputs. In the meantime, tracking scripts can update the browsing profile and send browsing histories to the retargeting service providers.</p>     <p>      <strong>2) Ad Extractor.</strong>The <em>Ad extractor</em> fetches ads using the crafted browsing profile generated by the trainer. In particular, it infers the targeting strategy, ad specs and the optimal fetch count. Details will be explained in Sec. <a class="sec" href="#sec-21">3.3.2</a>.</p>     <p>When ads arrive, <em>Ad parser</em> determines their sources, specifications (such as types and sizes) and the ad network involved. It also extracts ads related HTML tags. In particular, since ads are usually rendered in the nested <tt>&#60;iframe></tt> for security purposes, it drills down and looks for specific ids (e.g. &#x201C;<tt>google_ads_iframe_*</tt>&#x201D; for DoubleClick). Once found, it collects element attributes as well as HTML tags inside. To identify ad networks, we manually developed 53 signatures. For example, the famous retargeting ad networks <em>Criteo</em> [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0004">4</a>] can be identified if the <tt>src</tt> of <tt>&#60;iframe></tt> is <tt>*.criteo.com/delivery/r/afr.php?</tt>. Besides, <em>Ad parser</em> harvests all URLs included in the HTML pages pointed by ads related <tt>&#60;iframe></tt>. It also determines the size and type of the ads from the attributes of observed <tt>&#60;embed></tt>,<tt>&#60;object></tt>, <tt>&#60;video></tt> and <tt>&#60;img></tt>. We found some tags found in ads related iframes are not useful. We only collect the tags listed in Table &#x00A0;<a class="tbl" href="#tab2">2</a> for better efficiency.</p>     <div class="table-responsive" id="tab2">      <div class="table-caption">       <span class="table-number">Table 2:</span>       <span class="table-title">HTML Tags Used for <em>Ad Parser</em>.       </span>      </div>      <table class="table">       <thead>        <tr>        <th style="text-align:left; border-right: solid">         <strong>HTML tag</strong>        </th>        <th style="text-align:left; border-right: solid">         <strong>Attribute</strong>        </th>        <th>         <strong>Ad information</strong>        </th>        </tr>       </thead>       <tbody>        <tr>        <td style="text-align:left; border-right: solid">         <tt>&#60;a></tt>        </td>        <td style="text-align:left; border-right: solid">id, href</td>        <td>ad_url, ad_network</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">         <tt>&#60;script></tt>        </td>        <td style="text-align:left; border-right: solid">id, src, innerHTML</td>        <td>ad_url, ad_network</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">         <tt>&#60;noscript></tt>        </td>        <td style="text-align:left; border-right: solid">innerHTML</td>        <td>ad_url</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">         <tt>&#60;iframe></tt>        </td>        <td style="text-align:left; border-right: solid">id, src, name</td>        <td>ad_network</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">         <tt>&#60;img>,&#60;embed>,&#60;object>,&#60;video></tt>        </td>        <td style="text-align:left; border-right: solid">width, height</td>        <td>type, size</td>        </tr>       </tbody>      </table>     </div>     </section>     <section id="sec-21">     <p><em>3.3.2 Advertiser Profiling.</em> In this subsection, we explain the <em>targeting strategy</em>, <em>Ad specification</em>, and <em>optimal Ad fetch count</em> produced by <em>ADHoneyClient</em>, which will be used as the training data in the next step.</p>     <p>      <strong>Targeting Strategy.</strong> A targeting strategy is a sequence of browsing activities which can be used to identify high-value customers. For example, advertisers can target at visitors who browsed the product pages or left something in carts without buying. A target strategy simulates the browsing activities demonstrated by such favored visitors. Take the website model in Fig.&#x00A0;<a class="fig" href="#fig5">5</a> as an example. A corresponding browsing activity example can be [<em>visiting a product page</em>, <em>choosing an option</em>, <em>adding it to a cart</em>], which can be described by a path covering states and transitions <em>S</em><sub>3</sub>, <em>T</em><sub>4</sub>, <em>S</em><sub>5</sub>, <em>T</em><sub>6</sub> and <em>S</em><sub>4</sub>. As our website model is deterministic, the representation can be simplified to <em>S</em><sub>3</sub>, <em>T</em><sub>4</sub> and <em>T</em><sub>6</sub>. To concertize it, we pick a page/event from each state/transaction and get a targeting strategy [<em>P</em><sub>7</sub>, <em>E</em><sub>7</sub>, <em>E</em><sub>8</sub>].</p>     <p>Algorithm&#x00A0;1 explains how we generate a target strategy from the website model graph produced in Sec.&#x00A0;<a class="sec" href="#sec-15">3.2</a>. The output target strategy is a list of browsing activities, where each activity can be either a page or a event obtained from the model.</p>     <p>Function <SmallCap>FindTargettingStrategy</SmallCap> is the main procedure. It keeps generating different strategy candidates (line 3) until a desired strategy is found (line 6) or the max number of tries is reached (line 2). In particular, <SmallCap>FindTargettingStrategy</SmallCap> generates uncovered strategy candidates. Given a strategy, <em>AdHoneyClient</em> follows the activity sequence in a strategy, trains the browsing profile and fetches ads (line 4). If the ads are from the targeted advertiser (line 5), a targeting strategy is found.</p>     <p>Function <SmallCap>GenerateCand</SmallCap> generates a targeting strategy candidate. It starts by randomly picking an initial a page in a state (line 10) and randomly selects pages or events as consecutive activities.</p>     <p>A naive way to select the next activity is to follow the transitions in the FSM website model. However, we observed it cannot effectively create diverse candidates. Instead, we randomly select a page from a state when we want to have a &#x201C;state&#x201D; as the next activity. In this way, we can produce more diverse models especially when the model coverage is low. For instance, a strategy generated can be [<em>P</em><sub>7</sub>, <em>P</em><sub>1</sub>, <em>E</em><sub>1</sub>], where we directly go to <em>P</em><sub>1</sub> after visiting <em>P</em><sub>7</sub> even though there is no edge between them on the model. Intuitively, this simulates the random jumps among pages during the navigation.</p>     <p>In particular, when we choose to have a &#x201C;transition&#x201D; as the next activity (line 13), we append the consecutive event to the activity list (lines 15 and 17). If the type is &#x201C;state&#x201D;, we select a random page from a random state (lines 24 and 25). Please note that the DOM modified states are excluded as they require DOM modification events and thus not directly accessible (line 24).</p>     <p>      <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-img1.jpg" class="img-responsive" alt="" longdesc=""/>     </p>     <p>      <strong>Ad Specification.</strong>Ad networks define ads parameters such as dimensions and formats (e.g. image, flash, video, etc.) that advertisers have to follow. As we will need to seed ad slots to obtain the desired ads, these specs are important too. For example, if the size of an desired ad is 300 &#x00D7; 250 but we only supports 160 &#x00D7; 600, it will not be delivered due to the inconsistency. Therefore, we also collect ads specs. Although some ad providers support responsive banners, where the size can be automatically determined at the time of fetching, ads specs are still useful as they may prevent potential inconsistencies and improve the success rate.</p>     <p>      <strong>Optimal Fetch Count.</strong> In practice, a browsing profile may expire after repeatedly fetching a certain number of ads, as ad networks usually set a rate limit on the ads delivered to a single user. Therefore, we also need to infer the <em>optimal fetch count</em>, which is the number of the ads that can be fetched using a single profile. In particular, we monitor the fetch rate using a browsing profile until the rate drops significantly, we use the number of ads fetched before drop as the <em>optimal fetch count</em>.</p>     <p>For example, we fetch 30 ads per batch using a single browsing profile from two advertisers. Fig. &#x00A0;<a class="fig" href="#fig6">6</a> shows the number of ads fetched in each batch. For advertiser 1, the fetch rate drops to 70% at batch 6 and then to 0. Similar patterns are observed for advertiser 2. After the 3rd batch, the rate is decreased to 6%. Therefore, the <em>optimal fetch counts</em> for them are 180 and 90 respectively.</p>     <p>In our experience, we use 50% as the threshold to balance the efforts of creating new profiles and ads fetching. In other words, once the targeted ads fetch rate drops below 50%, we stop fetching and set the number of ads fetched so far as the <em>optimal fetch count</em>. <figure id="fig6">       <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig8.jpg" class="img-responsive" alt="Figure 6"        longdesc=""/>       <div class="figure-caption">        <span class="figure-number">Figure 6:</span>        <span class="figure-title">Targeted ads fetched with a single browsing profile.</span>       </div>      </figure>     </p>     </section>    </section>    <section id="sec-22">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.4</span> Attack Module Generation</h3>     </div>     </header>     <p>An <em>attack module</em> contains three components: <em>tracking tag-only page</em>, the <em>ad fetch page</em>, and the <em>attack engine</em>. The first two are HTML pages for browsing profile training and ads fetching. The attack engine drives the process based on the attack parameters.</p>     <section id="sec-23">     <header>      <div class="title-info">       <h4>        <span class="section-number">3.4.1</span> Tag-only Training Page Builder</h4>      </div>     </header>     <figure id="fig7">      <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig9.jpg" class="img-responsive" alt="Figure 7"       longdesc=""/>      <div class="figure-caption">       <span class="figure-number">Figure 7:</span>       <span class="figure-title">Tag-only training page building process.</span>      </div>     </figure>     <p>To train browsing profiles, we emulate activities specified in targeting strategies. This is one of the most time consuming parts as we have to repeatedly create new profiles. To correctly set the tracking IDs and browsing histories, we have to trigger the tracking scripts (Sec.&#x00A0;<a class="sec" href="#sec-20">3.3.1</a>). Unfortunately, tracking scripts are usually executed after the page is fully loaded, which significantly drags down the attack performance. To improve its efficiency, we use the <em>tag-only training pages</em> extracted from the original pages that only contain the tracking scripts.</p>     <p>Fig.&#x00A0;<a class="fig" href="#fig7">7</a> shows how tag-only training pages are built. We get the HTML source code from the fully rendered page and extract JS snippets whose tags match pre-collected tracking tag signatures. We then build a tag-only training page using the extracted scripts and the mandatory DOM elements such as <tt>&#60;html>,<head>,</tt> and <tt>&#60;body></tt>. The snippets at the bottom in Fig.&#x00A0;<a class="fig" href="#fig7">7</a> is the example output.</p>     </section>     <section id="sec-24">     <header>      <div class="title-info">       <h4>        <span class="section-number">3.4.2</span> Ad Fetch Page Builder</h4>      </div>     </header>     <figure id="fig8">      <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig10.jpg" class="img-responsive" alt="Figure 8"       longdesc=""/>      <div class="figure-caption">       <span class="figure-number">Figure 8:</span>       <span class="figure-title">Total time spent for fetching 180 ads.</span>      </div>     </figure>     <p>An <em>ad fetch page</em> is an HTML file containing a set of ad slots. It is similar to the crafted page created for <em>ADHoneyClient</em> (Sec. &#x00A0;<a class="sec" href="#sec-20">3.3.1</a>). We configure each ad slots based on the collected ad specs. Besides, we need to optimize the number of ad slots per a batch for better efficacy. However, it is difficult to predict the appropriate number because the ad loading procedure varies. Therefore, we perform an experiment in this step to infer the optimal number of ad slots per batch.</p>     <p>To be specific, we compare the total time spent to fetch a particular number of ads. As explained in Sec.&#x00A0;<a class="sec" href="#sec-21">3.3.2</a>, we can only fetch a limited number of ads with a single browsing profile. Therefore, we use it as the upper bound in each experiment. For example, suppose the optimal fetch count is 180. We first fetch 10 ads each time and repeat for 18 times. Then, we try different batch size and compare the time needed to get all ads specified by the optimal fetch count (180 in this example). The results are shown in Fig.&#x00A0;<a class="fig" href="#fig8">8</a>. We achieve the best performance when we fetch 20 ads per batch. Therefore, we include 20 ad slots in the <em>ad fetch page</em> in this example.</p>     </section>     <section id="sec-25">     <p><em>3.4.3 Attack Parameters.</em> Attack parameters are a set of data used by the <em>attack engine</em> to customize the attack process. We may specify the <em>attack time</em> including the start time and duration. We can set the <em>attack strategy</em>, which can be <em>exhaustive</em> or <em>smart</em>. The exhaustive attack aims to drain the advertising budget as fast as possible. But it has high risk of getting detected. The <em>smart attack</em> is less aggressive and randomly sleeps to simulate human behaviors.</p>     </section>    </section>    <section id="sec-26">     <header>     <div class="title-info">      <h3>       <span class="section-number">3.5</span> Attack Distribution</h3>     </div>     </header>     <p>When the attack module is ready, it is deployed to virtual machines hosted on public cloud services, such as Amazon EC2[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0002">2</a>], Google Cloud Platform[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0005">5</a>], and Microsoft Azure[<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0003">3</a>]. Using public cloud services has the following advantages. First, it is cost effective. We can launch the attack for a few cents per hour (Sec.<a class="sec" href="#sec-27">4</a>). Second, we can evade the IP address based detections without additional cost.</p>     <p>The <em>attack engine</em> in the distributed attack modules repeats two operations: <em>browsing profile training</em> and <em>ads fetching</em>. It loads the <em>tracking-tag only pages</em> in sequence to train browsing profiles, and fetches ads using the ad fetch page. It repeats the whole procedure until the optimal fetch count is reached and disposes the browsing profile by flushing the cookies and local storages.</p>    </section>   </section>   <section id="sec-27">    <header>     <div class="title-info">     <h2>      <span class="section-number">4</span> Evaluation</h2>     </div>    </header>    <p>In this section, we describe the implementation and experiment results to validate the efficacy of our attack. We implement the <em>ADHoneClient</em> in Python based on the Selenium libraries [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0007">7</a>]. The attack module is built as a chrome extension for easy deployment. The experiments are done on Microsoft Azure VMs. We choose the D1 v2 instances which provide the 2.4 GHz Intel Xeon E5-2673 v3 (Haswell) processor, 3.5GB RAM and Windows Server 2016. The pricing plan for a single instance is <font style="normal">&#x0024;</font>0.13 per hour.</p>    <p>We launch attacks against two types of advertisers. We first target at controlled advertisers, where we create the advertiser and set up the advertising strategies. The second experiment is to attack public advertisers in the wild (<strong>after obtaining their approvals</strong>), where advertisers run real-world e-commerce websites. More experiment details can be found in [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0008">8</a>].</p>    <section id="sec-28">     <header>     <div class="title-info">      <h3>       <span class="section-number">4.1</span> Controlled Advertiser</h3>     </div>     </header>     <div class="table-responsive" id="tab3">     <div class="table-caption">      <span class="table-number">Table 3:</span>      <span class="table-title">One hour attack against controlled advertiser.</span>     </div>     <table class="table">      <thead>       <tr>        <th style="text-align:right; border-right: solid"># of</th>        <th style="text-align:right; border-right: solid"/>        <th style="text-align:right; border-right: solid"/>        <th style="text-align:right; border-right: solid">budget</th>        <th style="text-align:right; border-right: solid"/>        <th style="text-align:right; border-right: solid">cost /</th>        <th colspan="2" style="text-align:center;">        <strong>per VM</strong>        <hr/>        </th>       </tr>       <tr>        <th style="text-align:right; border-right: solid">VM</th>        <th style="text-align:right; border-right: solid">ads</th>        <th style="text-align:right; border-right: solid">CPM</th>        <th style="text-align:right; border-right: solid">drained</th>        <th style="text-align:right; border-right: solid">cost</th>        <th style="text-align:right; border-right: solid">drained</th>        <th style="text-align:right; border-right: solid">ads</th>        <th>drained</th>       </tr>      </thead>      <tbody>       <tr>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">2977</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>3.30</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>9.82</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>0.13</td>        <td style="text-align:right; border-right: solid">0.01</td>        <td style="text-align:right; border-right: solid">2977</td>        <td><font style="normal">&#x0024;</font>9.82</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">2</td>        <td style="text-align:right; border-right: solid">4965</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>2.84</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>14.10</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>0.26</td>        <td style="text-align:right; border-right: solid">0.02</td>        <td style="text-align:right; border-right: solid">2483</td>        <td><font style="normal">&#x0024;</font>7.05</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">3</td>        <td style="text-align:right; border-right: solid">10114</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>4.72</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>47.74</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>0.39</td>        <td style="text-align:right; border-right: solid">0.01</td>        <td style="text-align:right; border-right: solid">3371</td>        <td><font style="normal">&#x0024;</font>15.97</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">4</td>        <td style="text-align:right; border-right: solid">12485</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>4.55</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>56.81</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>0.52</td>        <td style="text-align:right; border-right: solid">0.01</td>        <td style="text-align:right; border-right: solid">3121</td>        <td><font style="normal">&#x0024;</font>14.20</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">5</td>        <td style="text-align:right; border-right: solid">16875</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>3.28</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>55.35</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>1.04</td>        <td style="text-align:right; border-right: solid">0.02</td>        <td style="text-align:right; border-right: solid">3375</td>        <td><font style="normal">&#x0024;</font>11.07</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">6</td>        <td style="text-align:right; border-right: solid">21264</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>3.55</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>75.49</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>1.56</td>        <td style="text-align:right; border-right: solid">0.02</td>        <td style="text-align:right; border-right: solid">3544</td>        <td><font style="normal">&#x0024;</font>12.58</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">7</td>        <td style="text-align:right; border-right: solid">28483</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>2.16</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>61.52</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>2.08</td>        <td style="text-align:right; border-right: solid">0.03</td>        <td style="text-align:right; border-right: solid">4069</td>        <td><font style="normal">&#x0024;</font>8.79</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">8</td>        <td style="text-align:right; border-right: solid">30484</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>3.95</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>120.41</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>4.16</td>        <td style="text-align:right; border-right: solid">0.03</td>        <td style="text-align:right; border-right: solid">3811</td>        <td><font style="normal">&#x0024;</font>15.05</td>       </tr>       <tr>        <td style="text-align:right; border-right: solid">9</td>        <td style="text-align:right; border-right: solid">37880</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>3.77</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>142.81</td>        <td style="text-align:right; border-right: solid"><font style="normal">&#x0024;</font>6.24</td>        <td style="text-align:right; border-right: solid">0.04</td>        <td style="text-align:right; border-right: solid">4209</td>        <td><font style="normal">&#x0024;</font>15.87</td>       </tr> <tr>        <td style="text-align:right; border-right: solid; border-bottom: double">10</td>        <td style="text-align:right; border-right: solid; border-bottom: double">40958</td>        <td style="text-align:right; border-right: solid; border-bottom: double"><font style="normal">&#x0024;</font>2.95</td>        <td style="text-align:right; border-right: solid; border-bottom: double"><font style="normal">&#x0024;</font>120.83</td>        <td style="text-align:right; border-right: solid; border-bottom: double"><font style="normal">&#x0024;</font>8.32</td>        <td style="text-align:right; border-right: solid; border-bottom: double">0.07</td>        <td style="text-align:right; border-right: solid; border-bottom: double">4096</td>        <td style="border-bottom: double;"><font style="normal">&#x0024;</font>12.08</td>       </tr>       <tr>        <td colspan="6" style="text-align:right; border-right: solid">        <strong>Average</strong>        <hr/>        </td>        <td style="text-align:right; border-right: solid">3506</td>        <td><font style="normal">&#x0024;</font>12.24</td>       </tr>      </tbody>     </table>     </div>     <p>In this section, we evaluate our attack on the controlled advertiser created by us. As a valid advertiser served by a real-world ad network, we can get the actual numbers of ads being displayed, ad budget drained and the cost per 1,000 impressions (CPM) to precisely calculate the financial damage. Besides, we can perform large-scale attacks without concerning about ethical issues. So, we can evaluate the full capacity using distributed VMs.</p>     <p>In particular, we created an e-commerce website that sells coffee beans and registered in an ad network. We run an ad campaign with a banner image and set weekly ad budget to <font style="normal">&#x0024;</font>150. We target users who visit our product pages. To confirm if our ad is available to public, we visit the page to create a satisfying browsing profile. Then we visit popular websites and check if it can be fetched. As shown in Fig.&#x00A0;<a class="fig" href="#fig9">9</a>, our ad is actually displayed at the right bottom corner on one of the top news websites, <tt>nbc.com</tt>. <figure id="fig9">      <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig11.jpg" class="img-responsive" alt="Figure 9"       longdesc=""/>      <div class="figure-caption">       <span class="figure-number">Figure 9:</span>       <span class="figure-title">Our ad is displayed on popular sites like <tt>nbc.com</tt>.       </span>      </div>     </figure>     </p>     <p>We create an attack module performing <em>exhaustive attack</em> for an hour. Fig.&#x00A0;<a class="fig" href="#fig10">10</a> shows a batch of the ads fetched using the attack module, where most of the ads are from our advertiser. We also prepare a virtual image with the attack module installed. We create 10 virtual instances using the image in order to evaluate the distributed attack capability. Using the attack machines, we conduct 10 rounds of attacks with different number of attack machines. <figure id="fig10">      <img src="../../../data/deliveryimages.acm.org/10.1145/3190000/3186096/images/www2018-105-fig12.jpg" class="img-responsive" alt="Figure 10"       longdesc=""/>      <div class="figure-caption">       <span class="figure-number">Figure 10:</span>       <span class="figure-title">Ads fetched using the trained attack module.	</span>      </div>     </figure>     </p>     <p>Table &#x00A0;<a class="tbl" href="#tab3">3</a> describes the result of the distributed attack against the controlled advertiser. The first column shows the number of attack machines. The second column shows the total number of our ads we fetched. We report the CPM, the budget drained and the cost. The result shows that we successfully fetched about 40<em>k</em> ads using 10 attack machines. Moreover, the number of fetched ads is increasing linearly with the number of attack machines. On average, we fetched 3,506 ads per machine and drained <font style="normal">&#x0024;</font>142.81 with 9 attack machines. We are able to drain 95% of the weekly budget within an hour. Note that we achieved better performance with 9 machines (instead of 10). The reason is that the CPM is measured dynamically. Although more ads are fetched using 10 VMs, the drained budget is less comparing to 9 VMs (<font style="normal">&#x0024;</font>2.95 vs <font style="normal">&#x0024;</font>3.77). We report the ratio of the cost to the drained budget. The costs are merely 1% to 7% of the drained budget, which indicates that the attack using distributed machines on public cloud is extremely cost effective.</p>    </section>    <section id="sec-29">     <header>     <div class="title-info">      <h3>       <span class="section-number">4.2</span> Public Advertisers</h3>     </div>     </header>     <p>In this section, we evaluate the attack against real-world advertisers by executing attacks within the ethical and legal boundary.</p>     <section id="sec-30">     <p><em>4.2.1 Advertiser Selection.</em> We target at advertisers who own e-commerce websites and use retargeting ad services. Although our implementation can be easily extended to support other ad networks, currently we focus on DoubleClick. Therefore, we filter out the websites listed in the shopping category in Alexa Top 500 [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0001">1</a>] based on the following criteria: 1) websites do not have online shopping functionalities, 2) websites only providing posting and payment functionalities and 3) non-English websites. We also remove websites if they do not have ad tracking tags or only support social networks/mobile ads. We use the remaining 291 websites to infer their targeting strategies.</p>     <p>As it may cause ethical issues if we run a large-scale attack to real advertisers, we reached out and requested permissions for a 10 minutes attack. We were able to get approval from 3 advertisers. We anonymize their identity and represent them as advertiser 1, 2 and 3 in the result. Besides, we only use a single attack machine for the experiments in order to minimize damages.</p>     </section>     <section id="sec-31">     <p><em>4.2.2 Revealing Targeting Strategies.</em> The first step of the budget draining attack is to verify if the target is vulnerable. In our case, if we cannot reveal targeting strategies from a targeted advertiser, the advertiser is not vulnerable. So, we first reverse engineer the targeting strategies for each websites using our tool <em>ADHoneyClient</em>.</p>     <p>As shown in Table &#x00A0;<a class="tbl" href="#tab4">4</a>, we successfully revealed targeting strategies from 254 out of 291 websites (about 87%). The first column lists the targeting strategy categories. After targeting strategies are successfully reversed, we manually verify them the targeting strategies discovered and put them in proper categories. If we cannot interpret the intention behind the strategy, we mark them as <tt>arbitrary activities</tt>. The second column shows the average number of browsing activities in the targeting strategies. The third column shows the number of websites using the targeting strategies.</p>     <p>The results suggest that most advertisers mainly target the users who visit product pages. However, we can also see that 112 out of the 254 advertisers (about 44%) use sophisticated targeting strategies containing more than 3 browsing activities, which suggests that it is ineffective to get ads from such advertisers using the naive attack method like visiting only the product pages or the front pages.</p>     <p>We manually inspected why we failed on the remaining 37 websites <span class="inline-equation"><span class="tex">$(13\%)$</span>      </span>. We found that they either do not use the data collected from the tracking tags or deploy long-term targeting strategies (showing ads after a week) that is robust to a transient attack. Besides, some target users using geographic data, which is orthogonal to browsing profiles.</p>     <div class="table-responsive" id="tab4">      <div class="table-caption">       <span class="table-number">Table 4:</span>       <span class="table-title">Reversed targeting strategies.</span>      </div>      <table class="table">       <thead>        <tr>        <th style="text-align:left; border-right: solid"/>        <th style="text-align:right; border-right: solid">Avg.# of</th>        <th style="text-align:right; border-right: solid"># of</th>        <th colspan="2" style="text-align:left; border-right: solid">         <strong>Avg. training time (sec)</strong>         <hr/>        </th>        <th/>        </tr>        <tr>        <th style="text-align:left; border-right: solid">         <strong>Targeting Strategy</strong>        </th>        <th style="text-align:right; border-right: solid">activities</th>        <th style="text-align:right; border-right: solid">websites</th>        <th style="text-align:right; border-right: solid">         <strong>Full page</strong>        </th>        <th style="text-align:right; border-right: solid">         <strong>Tag-only page</strong>        </th>        <th>         <strong>Rate</strong>        </th>        </tr>       </thead>       <tbody>        <tr>        <td style="text-align:left; border-right: solid">Visiting a front page</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">31</td>        <td style="text-align:right; border-right: solid">4.78</td>        <td style="text-align:right; border-right: solid">0.70</td>        <td>6.87</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">Visiting a product page</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">111</td>        <td style="text-align:right; border-right: solid">4.37</td>        <td style="text-align:right; border-right: solid">0.57</td>        <td>7.65</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">Adding an item to a cart</td>        <td style="text-align:right; border-right: solid">3.48</td>        <td style="text-align:right; border-right: solid">79</td>        <td style="text-align:right; border-right: solid">8.55</td>        <td style="text-align:right; border-right: solid">1.17</td>        <td>7.29</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">Full shopping trip</td>        <td style="text-align:right; border-right: solid">4.94</td>        <td style="text-align:right; border-right: solid">28</td>        <td style="text-align:right; border-right: solid">19.59</td>        <td style="text-align:right; border-right: solid">2.00</td>        <td>9.77</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid">Arbitrary activities</td>        <td style="text-align:right; border-right: solid">5</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">24.70</td>        <td style="text-align:right; border-right: solid">2.23</td>        <td>11.08</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid"/>        <td style="text-align:right; border-right: solid">6</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">22.98</td>        <td style="text-align:right; border-right: solid">2.11</td>        <td>10.89</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid"/>        <td style="text-align:right; border-right: solid">7</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">26.32</td>        <td style="text-align:right; border-right: solid">2.56</td>        <td>10.28</td>        </tr>        <tr>        <td style="text-align:left; border-right: solid"/>        <td style="text-align:right; border-right: solid">8</td>        <td style="text-align:right; border-right: solid">1</td>        <td style="text-align:right; border-right: solid">29.34</td>        <td style="text-align:right; border-right: solid">3.09</td>        <td>9.50</td>        </tr>        <tr>        <td style="text-align:left; border-bottom: double; border-right: solid"/>        <td style="text-align:right; border-bottom: double; border-right: solid">8</td>        <td style="text-align:right; border-bottom: double; border-right: solid">1</td>        <td style="text-align:right; border-bottom: double; border-right: solid">23.70</td>        <td style="text-align:right; border-bottom: double; border-right: solid">2.90</td>        <td style="border-bottom: double "/>        </tr>        <tr>        <td style="text-align:left; border-right: solid">         <strong>Total websites</strong>        </td>        <td style="text-align:right; border-right: solid">254</td>        <td colspan="2" style="text-align:left; border-right: solid">         <strong>Avg. rate</strong>         <hr/>        </td>        <td style="text-align:right; border-right: solid">9.06</td>        <td/>        </tr>       </tbody>      </table>     </div>     <p>To validate the efficacy of the tag-only training approach, we conducted another experiment to show how significantly we improved performance comparing to the full page training. As described in Sec.&#x00A0;<a class="sec" href="#sec-23">3.4.1</a>, we create tag-only pages containing only tracking tags based on the targeting strategies revealed from the advertisers&#x2019; websites. We record browsing profile training times using the tag-only pages and the original fully-loaded pages. According to the results in Table&#x00A0;<a class="tbl" href="#tab4">4</a>, the tag-only training is about 9 times faster on average.</p>     </section>     <section id="sec-32">     <header>      <div class="title-info">       <h4>        <span class="section-number">4.2.3</span> Estimating Attack Damages</h4>      </div>     </header>     <div class="table-responsive" id="tab5">      <div class="table-caption">       <span class="table-number">Table 5:</span>       <span class="table-title">10 minutes attack result against selected public advertisers, and estimated damage.</span>      </div>      <table class="table">       <thead>        <tr>        <th style="text-align:center; border-right: solid"/>        <th style="text-align:left; border-right: solid">Ad</th>        <th style="text-align:center; border-right: solid">Targeting</th>        <th style="text-align:center; border-right: solid">Optimal</th>        <th style="text-align:left; border-right: solid"># of ad</th>        <th style="text-align:center; border-right: solid"/>        <th style="text-align:right; border-right: solid">Ad</th>        <th style="text-align:center; border-right: solid">#</th>        <th style="text-align:right; border-right: solid">Ad</th>        <th style="border-right: solid">Estimated Damage</th>        <th/>        </tr>        <tr>        <th style="text-align:center; border-right: solid"/>        <th style="text-align:left; border-right: solid">Network</th>        <th style="text-align:center; border-right: solid">Strategy</th>        <th style="text-align:center; border-right: solid">Fetch</th>        <th style="text-align:left; border-right: solid">slots per</th>        <th style="text-align:center; border-right: solid"/>        <th style="text-align:right; border-right: solid">type</th>        <th style="text-align:center; border-right: solid">of</th>        <th style="text-align:right; border-right: solid">category</th>        <th style="border-right: solid">CPM</th>        <th>Budget</th>        </tr>        <tr>        <th style="text-align:center; border-bottom: solid; border-right: solid">Advertiser</th>        <th style="text-align:left; border-bottom: solid; border-right: solid"/>        <th style="text-align:center; border-bottom: solid; border-right: solid"/>        <th style="text-align:center; border-bottom: solid; border-right: solid">Count</th>        <th style="text-align:left; border-bottom: solid; border-right: solid">batch</th>        <th style="text-align:center; border-bottom: solid; border-right: solid">AD Size</th>        <th style="text-align:right; border-bottom: solid; border-right: solid"/>        <th style="text-align:center; border-bottom: solid; border-right: solid">ads</th>        <th style="text-align:right; border-bottom: solid; border-right: solid"/>        <th style="text-align:right; border-bottom: solid; border-right: solid"/>        <th style="text-align:right; border-bottom: solid">drained/hour</th>        </tr>       </thead>       <tbody>        <tr>        <td style="text-align:center; border-right: solid">1</td>        <td style="text-align:left; border-right: solid">A</td>        <td style="text-align:center; border-right: solid">Visiting a product page</td>        <td style="text-align:center; border-right: solid">180</td>        <td style="text-align:left; border-right: solid">20</td>        <td style="text-align:center; border-right: solid">300x250, 160x600, 728x90</td>        <td style="text-align:right; border-right: solid">Image</td>        <td style="text-align:center; border-right: solid">3134</td>        <td style="text-align:right; border-right: solid">E-commerce</td>        <td style="border-right: solid"><font style="normal">&#x0024;</font>8.29</td>        <td><font style="normal">&#x0024;</font>155.89</td>        </tr>        <tr>        <td style="text-align:center; border-right: solid">2</td>        <td style="text-align:left; border-right: solid">A</td>        <td style="text-align:center; border-right: solid">Adding an item to a cart</td>        <td style="text-align:center; border-right: solid">180</td>        <td style="text-align:left; border-right: solid">20</td>        <td style="text-align:center; border-right: solid">300x250, 160x600, 728x90</td>        <td style="text-align:right; border-right: solid">Image</td>        <td style="text-align:center; border-right: solid">2742</td>        <td style="text-align:right; border-right: solid">Retail</td>        <td style="border-right: solid"><font style="normal">&#x0024;</font>5.85</td>        <td><font style="normal">&#x0024;</font>96.24</td>        </tr>        <tr>        <td style="text-align:center; border-right: solid">3</td>        <td style="text-align:left; border-right: solid">B</td>        <td style="text-align:center; border-right: solid">Visiting a product page</td>        <td style="text-align:center; border-right: solid">90</td>        <td style="text-align:left; border-right: solid">30</td>        <td style="text-align:center; border-right: solid">300x250</td>        <td style="text-align:right; border-right: solid">Image</td>        <td style="text-align:center; border-right: solid">942</td>        <td style="text-align:right; border-right: solid">E-commerce</td>        <td style="border-right: solid"><font style="normal">&#x0024;</font>8.29</td>        <td><font style="normal">&#x0024;</font>46.86</td>        </tr>       </tbody>      </table>     </div>     <p>After we got the approvals, we launched the attack against 3 public advertisers. However, we cannot precisely obtain the numbers of ads displayed, CPM or budget because they are confidential business information. Instead, we use the public ad reports providing category-based average CPM for the first two quarters of 2016 [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0029">29</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"       href="#BibPLXBIB0030">30</a>] and do our best to estimate the damage. Although the estimation may be biased, we believe it approximately demonstrates how much ad budget we could drain with our attack against real-world advertisers.</p>     <p>Table &#x00A0;<a class="tbl" href="#tab5">5</a> shows the result of the attack and the estimated damage. The columns 2 to 7 describe the output of the advertiser profiling. The column 8 shows the number of ads we fetched from each advertisers. We report the average CPM in column 10 and use them to calculate the estimated damage. The estimated budget drained within one hour (column 11) ranges from <font style="normal">&#x0024;</font>46.86 to <font style="normal">&#x0024;</font>155.89.</p>     </section>    </section>    <section id="sec-33">     <header>     <div class="title-info">      <h3>       <span class="section-number">4.3</span> Ethical Considerations</h3>     </div>     </header>     <p>We would like to highlight that we take the ethical issues seriously in our evaluation. This study was closely advised by a lawyer and conducted in a responsible manner. <em>Our evaluation process has been reviewed by IRB and we received IRB exemption</em>.</p>     <p>In the experiment of attacking a controlled advertiser, we own the advertiser&#x0027;s account and we pay for the charges. In the experiment with the three real-world advertisers, we explained our methods and potential damage to them. We start the experiments with their approvals. We purposely performed a proof-of-concept experiment using only 1 attack machine within 10 minutes to minimize the damage. We reported our findings and suggestions to them.</p>     <p>In spite of all of our efforts, due to the nature of the problem, ads from other advertisers showed up in our experiments. However, we confirmed that total rewards we collected from the untargeted advertisers as a publisher was less than <font style="normal">&#x0024;</font>10. As the damages are distributed among all of the advertisers, the financial loss of one advertiser is negligible. More importantly, Google DFP is able to refund credits to advertisers when publishers violate their policies. We are in communication with DFP so that they can refund we earned throughout all of our experiments to the affected advertisers.</p>    </section>   </section>   <section id="sec-34">    <header>     <div class="title-info">     <h2>      <span class="section-number">5</span> Countermeasures</h2>     </div>    </header>    <p>In this section, we describe countermeasures against our attack. We introduce the detection and prevent methods.</p>    <section id="sec-35">     <header>     <div class="title-info">      <h3>       <span class="section-number">5.1</span> Detection</h3>     </div>     </header>     <p>In order to detect our attack, ad providers or ad networks can look for anomalies in ad request traffics. We discuss three possible detection approaches and their limitations in the following paragraphs.</p>     <p>     <strong>Browsing profile based detection.</strong>The number of ad requests generated by a benign users is usually smaller than that from attack machines. Therefore, the number of ad requests per browsing profile can be used as a detection feature. For example, if a large amount of requests with the same browsing profile within certain period are observed, we can consider this as the attack situation. However, this feature may not be effective since our attack does not use the same browsing profiles for many times. Another viable feature is the number of browsing histories in a single browsing profile. In order to increase efficiency of our attack, we only train a browsing profile with few pages in a targeted website. Those profiles created in that way contain the limited number of browsing histories, but benign users normally have larger number of browsing activities.</p>     <p>     <strong>IP address based detection.</strong>IP address based blacklists can be used too. We can mark requests suspicious if an excessive number of requests are made from the same address. The attack using the short-time-use profiles may evade the browsing profile based detection, but it cannot bypass IP address based detection because requests are from the same IP address. However, as we discussed, attack machines created using virtual instances can have different IP addresses by simply rebooting them or leveraging publicly available proxies, which makes IP address based detection less effective.</p>     <p>     <strong>Click-Through-Rate (CTR) based detection.</strong>CTR is a metric that measures the number of clicks advertisers receive from a certain number of impressions. Our attack generate a huge number of impressions without actually clicking them. Therefore, the CTR is low. However, this can be bypassed by inserting valid clicks between our attacks so that CTR can be increased.</p>     <p>Our attack is similar to distributed denial of service (DDoS) attack since both attacks generate a large amount of traffic using distributed machines. Although detecting the DDoS attack is not that difficult, the attack is still powerful due to the characteristic of distributed attack. Once an attack machine is blocked, a newly created machine can continue the attack. Therefore, it is possible that our attack can be detected with various features. However, we believe it is extremely challenging to nullify the attacks.</p>    </section>    <section id="sec-36">     <header>     <div class="title-info">      <h3>       <span class="section-number">5.2</span> Prevention</h3>     </div>     </header>     <p>As it is challenging for ad networks to effectively suppress the attack, in this section, we suggest practical prevention approaches for advertisers. One possible solution is to use event-based targeting strategies. They can track users who actually scroll pages or stay on the website for a certain period of time. Such event tracking utilities are already supported by many ad networks [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0006">6</a>, <a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"      href="#BibPLXBIB0009">9</a>]. Although the methods may not completely prevent the attack, it can minimize the probability of being selected as a target.</p>    </section>   </section>   <section id="sec-37">    <header>     <div class="title-info">     <h2>      <span class="section-number">6</span> Related Work</h2>     </div>    </header>    <p>     <strong>Browsing profile manipulation.</strong>There are two existing studies that explore attack mechanisms based on browsing profile manipulation. Xing et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0035">35</a>] proposed an attack where adversaries can change the customized content of services from popular providers, such as YouTube, Amazon and Google, by manipulating browsing profiles. They provided specific attack methods for each services, and showed what attacks could be possible. While the proposed method worked well, their study only showed possibility of the attack. In contrast, our approach provided more practical, and beneficial attack mechanism for advertisers. The second attack is presented by Meng et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0026">26</a>]. They proposed a fraud mechanism to increase ad revenue for publishers by injecting higher-paying advertiser websites to publishers&#x2019; pages. Although they successfully increased the revenue, their attacking perspective is different.</p>    <p>     <strong>Ad fraud and mitigation.</strong>Representative attacks and countermeasures were discussed in [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0015">15</a>]. Recently, Stone-Gross et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0032">32</a>] performed a large scale study on fraudulent activities in online ad exchange and suggested practical detection methods.</p>    <p>Recent research are focused on specific fraud activities. Among them, click fraud/spam is the most popular one. Dave et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0016">16</a>] proposed a method for advertisers to measure click spam rates and conducted a large scale measurement study of click spam across ten major ad networks. Faou et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0018">18</a>] proposed a click fraud prevention technique using the value chain, the links between fraudulent actors and legitimate businesses. Their results showed that pressuring a limited number of actors would disrupt the ability of click fraud. Recently, Jaafar et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0021">21</a>] proposed FCFraud, a method for detecting automated clickers from the user side in order to prevent from becoming victimized attackers of click fraud. It analyzes web requests and events from user processes, classifies ad requests, and detects fraudulent ad clicks.</p>    <p>Another prevalent ad fraud activity is impression fraud/spam. Springborn et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0031">31</a>] showed an impression fraud via pay-per-view (PPV) networks by analyzing ad traffic from honeypot websites. Their results showed that hundreds of millions of fraudulent impressions per day were delivered by the PPV networks. Marciel et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0025">25</a>] proposed tools to audit systems of five major online video portals to investigate fraud in video ads.</p>    <p>Ad frauds also target on mobile apps. Crussell et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0014">14</a>] performed a study on mobile ad fraud perpetrated by Android apps. They developed MAdFraud, an automatic app analysis tool, to emulating event and extract ADs. They found that about 30% of apps made ad request are running in the background and identified 27 apps generating clicks without user interactions. Liu et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0024">24</a>] proposed a system to detect placement frauds that manipulate visual ads layouts to trigger unintentional clicks from users. They implemented a tool called DECAF and characterized the prevalence of ad frauds in 50,000 apps.</p>    <p>     <strong>Online behavior tracking.</strong>Roesner et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0028">28</a>] investigated how third-party web tracking services performed. They showed how tracking worked, where the data can be stored, and how web tracking behaviors are classified. Englehardt et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0017">17</a>] proposed OpenWPM, a web privacy measurement platform, to show how third-party tracking cookies can be used to reveal browsing histories. Conti et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0013">13</a>] proposed TRAP, a system to unveil Google personal profiles using targeted AD. They focused on revealing topics a user is interested in instead of her actual browsing histories. Recently, Bashir et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0010">10</a>] showed information flows between ad exchanges using retargeting ad. They showed how user profiles were shared among ad exchanges by investigating 5,102 retargeting ads. Cahn et al. [<a class="bib" data-trigger="hover" data-toggle="popover" data-placement="top"     href="#BibPLXBIB0012">12</a>] assessed a privacy threat caused by the third-party tracking. Our research was inspired by their study and we utilized them to build our attack method.</p>   </section>   <section id="sec-38">    <header>     <div class="title-info">     <h2>      <span class="section-number">7</span> Conclusion</h2>     </div>    </header>    <p>In this paper, we present a novel ad budget draining attack against targeted advertisers in the online retargeting ads system. The attack creates crafted browsing profiles based on information collected by an ad crawler <em>ADHoneyClient</em>. It executes a large-scale attack using public cloud computing services and repeatedly fetches ads from the targeted advertisers. We evaluate the efficacy of proposed methods through an extensive set of experiments. We were able to reverse engineer the targeting strategies used by 254 (out of 291) public advertisers selected from Alexa Top 500. In addition, we executed a series of attacks against 3 real-world advertisers. The evaluation results show that our ad budget draining attack is effective and efficient. It successfully fetched 40,958 ads from the targeted advertisers and drained up to <font style="normal">&#x0024;</font>155.89 from their campaign budget within an hour.</p>   </section>  </section>  <section class="back-matter">   <section id="ref-001">    <header>     <div class="title-info">     <h2 class="page-brake-head">REFERENCES</h2>     </div>    </header>    <ul class="bibUl">     <li id="BibPLXBIB0001" label="[1]">2017. Alexa Top 500 - Shopping category. <a class="link-inline force-break" href="http://www.alexa.com/topsites/category/Top/Shopping">http://www.alexa.com/topsites/category/Top/Shopping</a>. (2017).</li>     <li id="BibPLXBIB0002" label="[2]">2017. Amazon Elastic Compute Cloud (Amazon EC2). <a class="link-inline force-break" href="https://aws.amazon.com/ec2/">https://aws.amazon.com/ec2/</a>. (2017).</li>     <li id="BibPLXBIB0003" label="[3]">2017. Azure. <a class="link-inline force-break" href="https://azure.microsoft.com">https://azure.microsoft.com</a>. (2017).</li>     <li id="BibPLXBIB0004" label="[4]">2017. Criteo Dynamic Retargeting. <a class="link-inline force-break" href="http://www.criteo.com/">http://www.criteo.com/</a>. (2017).</li>     <li id="BibPLXBIB0005" label="[5]">2017. Google Cloud Platform. <a class="link-inline force-break" href="https://cloud.google.com/">https://cloud.google.com/</a>. (2017).</li>     <li id="BibPLXBIB0006" label="[6]">2017. Perfect Audience - Event Audiences. <a class="link-inline force-break" href="http://support.perfectaudience.com/knowledgebase/articles/233996-understanding-action-lists">http://support.perfectaudience.com/knowledgebase/articles/233996-understanding-action-lists</a>. (2017).</li>     <li id="BibPLXBIB0007" label="[7]">2017. Selenium Browser Automation. <a class="link-inline force-break" href="http://www.seleniumhq.org/">http://www.seleniumhq.org/</a>. (2017).</li>     <li id="BibPLXBIB0008" label="[8]">2017. Technical Report - AdBudgetKiller: Online Advertising Budget Draining Attack. <a class="link-inline force-break" href="https://sites.google.com/view/adbudgetkiller">https://sites.google.com/view/adbudgetkiller</a>. (2017).</li>     <li id="BibPLXBIB0009" label="[9]">Adroll. 2017. Event Segments. <a class="link-inline force-break" href="https://help.adroll.com/hc/en-us/articles/212014288-Event-Segments">https://help.adroll.com/hc/en-us/articles/212014288-Event-Segments</a>. (2017).</li>     <li id="BibPLXBIB0010" label="[10]">Muhammad&#x00A0;Ahmad Bashir, Sajjad Arshad, William Robertson, and Christo Wilson. 2016. Tracing information flows between ad exchanges using retargeted ads. In <em>      <em>Proceedings of the 25th USENIX Security Symposium</em>     </em>.</li>     <li id="BibPLXBIB0011" label="[11]">AdWords&#x00A0;Robot Bv. 2017. 9 Remarketing/Retargeting Services which Drive your Online Sales. <a class="link-inline force-break" href="https://www.adwordsrobot.com/en/blog/9-remarketing-retargeting-services-which-drive-your-online-sales">https://www.adwordsrobot.com/en/blog/9-remarketing-retargeting-services-which-drive-your-online-sales</a>. (2017).</li>     <li id="BibPLXBIB0012" label="[12]">Aaron Cahn, Scott Alfeld, Paul Barford, and S Muthukrishnan. 2016. What&#x0027;s in the community cookie jar?. In <em>      <em>Advances in Social Networks Analysis and Mining (ASONAM), 2016 IEEE/ACM International Conference on</em>     </em>. IEEE, 567&#x2013;570.</li>     <li id="BibPLXBIB0013" label="[13]">Mauro Conti, Vittoria Cozza, Marinella Petrocchi, and Angelo Spognardi. 2015. TRAP: using targeted ads to unveil google personal profiles. In <em>      <em>Information Forensics and Security (WIFS), 2015 IEEE International Workshop on</em>     </em>. IEEE, 1&#x2013;6.</li>     <li id="BibPLXBIB0014" label="[14]">Jonathan Crussell, Ryan Stevens, and Hao Chen. 2014. Madfraud: Investigating ad fraud in android applications. In <em>      <em>Proceedings of the 12th annual international conference on Mobile systems, applications, and services</em>     </em>. ACM, 123&#x2013;134.</li>     <li id="BibPLXBIB0015" label="[15]">Neil Daswani, Chris Mysen, Vinay Rao, Stephen Weis, Kourosh Gharachorloo, and Shuman Ghosemajumder. 2008. Online advertising fraud. <em>      <em>Crimeware: understanding new attacks and defenses</em>     </em>40, 2 (2008), 1&#x2013;28.</li>     <li id="BibPLXBIB0016" label="[16]">Vacha Dave, Saikat Guha, and Yin Zhang. 2012. Measuring and fingerprinting click-spam in ad networks. <em>      <em>ACM SIGCOMM Computer Communication Review</em>     </em>42, 4 (2012), 175&#x2013;186.</li>     <li id="BibPLXBIB0017" label="[17]">Steven Englehardt, Dillon Reisman, Christian Eubank, Peter Zimmerman, Jonathan Mayer, Arvind Narayanan, and Edward&#x00A0;W Felten. 2015. Cookies that give you away: The surveillance implications of web tracking. In <em>      <em>Proceedings of the 24th International Conference on World Wide Web</em>     </em>. ACM, 289&#x2013;299.</li>     <li id="BibPLXBIB0018" label="[18]">Matthieu Faou, Antoine Lemay, David D&#x00E9;cary-H&#x00E9;tu, Joan Calvet, Fran&#x00E7;ois Labr&#x00E8;che, Militza Jean, Benoit Dupont, and Jos&#x00E9;&#x00A0;M Fernande. 2016. Follow the traffic: Stopping click fraud by disrupting the value chain. In <em>      <em>Privacy, Security and Trust (PST), 2016 14th Annual Conference on</em>     </em>. IEEE, 464&#x2013;476.</li>     <li id="BibPLXBIB0019" label="[19]">IAB. 2015. What is an untrustworthy supply chain costing the US digital advertising industry? <a class="link-inline force-break" href="http://www.iab.com/wp-content/uploads/2015/11/IAB_EY_Report.pdf">http://www.iab.com/wp-content/uploads/2015/11/IAB_EY_Report.pdf</a>. (2015).</li>     <li id="BibPLXBIB0020" label="[20]">IAB. 2016. IAB internet advertising revenue report 2016 full year results. <a class="link-inline force-break" href="https://www.iab.com/wp-content/uploads/2016/04/IAB_Internet_Advertising_Revenue_Report_FY_2016.pdf">https://www.iab.com/wp-content/uploads/2016/04/IAB_Internet_Advertising_Revenue_Report_FY_2016.pdf</a>. (2016).</li>     <li id="BibPLXBIB0021" label="[21]">Md&#x00A0;Shahrear Iqbal, Mohammad Zulkernine, Fehmi Jaafar, and Yuan Gu. 2017. Protecting Internet users from becoming victimized attackers of click-fraud. <em>      <em>Journal of Software: Evolution and Process</em>     </em>(2017).</li>     <li id="BibPLXBIB0022" label="[22]">Lauren Johnson. 2017. U.S. Digital Advertising Will Make <font style="normal">&#x0024;</font>83 Billion This Year, Says EMarketer. <a class="link-inline force-break" href="http://www.adweek.com/digital/u-s-digital-advertising-will-make-83-billion-this-year-says-emarketer/">http://www.adweek.com/digital/u-s-digital-advertising-will-make-83-billion-this-year-says-emarketer/</a>. (2017).</li>     <li id="BibPLXBIB0023" label="[23]">Peter LaFond. 2016. How Retailer ShopStyle Gained a 200% Increase in Retargeting Conversions with TruSignal and MediaMath. <a class="link-inline force-break" href="http://www.mediamath.com/blog/how-retailer-shopstyle-gained-a-200-increase-in-retargeting-conversions-with-trusignal-and-mediamath/">http://www.mediamath.com/blog/how-retailer-shopstyle-gained-a-200-increase-in-retargeting-conversions-with-trusignal-and-mediamath/</a>. (2016).</li>     <li id="BibPLXBIB0024" label="[24]">Bin Liu, Suman Nath, Ramesh Govindan, and Jie Liu. 2014. DECAF: Detecting and Characterizing Ad Fraud in Mobile Apps.. In <em>      <em>NSDI</em>     </em>. 57&#x2013;70.</li>     <li id="BibPLXBIB0025" label="[25]">Miriam Marciel, Rub&#x00E9;n Cuevas, Albert Banchs, Roberto Gonz&#x00E1;lez, Stefano Traverso, Mohamed Ahmed, and Arturo Azcorra. 2016. Understanding the detection of view fraud in video content portals. In <em>      <em>Proceedings of the 25th International Conference on World Wide Web</em>     </em>. International World Wide Web Conferences Steering Committee, 357&#x2013;368.</li>     <li id="BibPLXBIB0026" label="[26]">Wei Meng, Xinyu Xing, Anmol Sheth, Udi Weinsberg, and Wenke Lee. 2014. Your online interests: Pwned! a pollution attack against targeted advertising. In <em>      <em>Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security</em>     </em>. ACM, 129&#x2013;140.</li>     <li id="BibPLXBIB0027" label="[27]">Mateusz Pawlik and Nikolaus Augsten. 2016. Tree edit distance: Robust and memory-efficient. <em>      <em>Information Systems</em>     </em>56(2016), 157&#x2013;173.</li>     <li id="BibPLXBIB0028" label="[28]">Franziska Roesner, Tadayoshi Kohno, and David Wetherall. 2012. Detecting and defending against third-party tracking on the web. In <em>      <em>Proceedings of the 9th USENIX conference on Networked Systems Design and Implementation</em>     </em>. USENIX Association, 12&#x2013;12.</li>     <li id="BibPLXBIB0029" label="[29]">Salesforce. 2016. Marketing Cloud Advertising Index Q1 2016 Report. <a class="link-inline force-break" href="https://www.marketingcloud.com/sites/exacttarget/files/deliverables/salesforce-advertising-index-q1-2016-advertising-studio.pdf">https://www.marketingcloud.com/sites/exacttarget/files/deliverables/salesforce-advertising-index-q1-2016-advertising-studio.pdf</a>. (2016).</li>     <li id="BibPLXBIB0030" label="[30]">Salesforce. 2016. Marketing Cloud Advertising Index Q2 2016 Report. <a class="link-inline force-break" href="https://www.marketingcloud.com/sites/exacttarget/files/salesforce-advertising-index-q2-2016-advertising-studio-v8.pdf">https://www.marketingcloud.com/sites/exacttarget/files/salesforce-advertising-index-q2-2016-advertising-studio-v8.pdf</a>. (2016).</li>     <li id="BibPLXBIB0031" label="[31]">Kevin Springborn and Paul Barford. 2013. Impression Fraud in On-line Advertising via Pay-Per-View Networks.. In <em>      <em>USENIX Security</em>     </em>. 211&#x2013;226.</li>     <li id="BibPLXBIB0032" label="[32]">Brett Stone-Gross, Ryan Stevens, Apostolis Zarras, Richard Kemmerer, Chris Kruegel, and Giovanni Vigna. 2011. Understanding fraudulent activities in online ad exchanges. In <em>      <em>Proceedings of the 2011 ACM SIGCOMM conference on Internet measurement conference</em>     </em>. ACM, 279&#x2013;294.</li>     <li id="BibPLXBIB0033" label="[33]">Florida Tech. 2017. Retargeting vs. Remarketing. <a class="link-inline force-break" href="https://www.floridatechonline.com/blog/business/retargeting-vs-remarketing/">https://www.floridatechonline.com/blog/business/retargeting-vs-remarketing/</a>. (2017).</li>     <li id="BibPLXBIB0034" label="[34]">Peter Willett. 1988. Recent trends in hierarchic document clustering: a critical review. <em>      <em>Information Processing &#x0026; Management</em>     </em>24, 5 (1988), 577&#x2013;597.</li>     <li id="BibPLXBIB0035" label="[35]">Xinyu Xing, Wei Meng, Dan Doozan, Alex&#x00A0;C Snoeren, Nick Feamster, and Wenke Lee. 2013. Take This Personally: Pollution Attacks on Personalized Services.. In <em>      <em>USENIX Security</em>     </em>. 671&#x2013;686.</li>     <li id="BibPLXBIB0036" label="[36]">Kaizhong Zhang and Dennis Shasha. 1989. Simple fast algorithms for the editing distance between trees and related problems. <em>      <em>SIAM journal on computing</em>     </em>18, 6 (1989), 1245&#x2013;1262.</li>    </ul>   </section>  </section>  <section id="foot-001" class="footnote">   <header>    <div class="title-info">     <h2>FOOTNOTE</h2>    </div>   </header>   <div class="bibStrip">    <p>This paper is published under the Creative Commons Attribution 4.0 International (CC-BY&#x00A0;4.0) license. Authors reserve their rights to disseminate the work on their personal and corporate Web sites with the appropriate attribution.</p>    <p>     <em>WWW '18, April 23-27, 2018, Lyon, France</em>    </p>    <p>&#x00A9; 2018; IW3C2 (International World Wide Web Conference Committee), published under Creative Commons CC-BY&#x00A0;4.0 License. ACM ISBN 978-1-4503-5639-8/18/04.<br/>DOI: <a class="link-inline force-break" target="_blank"     href="https://doi.org/10.1145/3178876.3186096">https://doi.org/10.1145/3178876.3186096</a>    </p>   </div>  </section>  <div class="pubHistory">   <p/>  </div>  </body> </html> 
