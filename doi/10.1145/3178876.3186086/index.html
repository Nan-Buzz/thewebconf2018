<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.16" />
  <title>ProxyTorrent: Untangling the Free HTTP(S) Proxy
  Ecosystem</title><!-- Copyright (c) 2010-2015 The MathJax Consortium -->
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8" />
  <meta name="viewport" content=
  "width=device-width; initial-scale=1.0;" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap-theme.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/main.css" />
  <script src="../../../data/dl.acm.org/pubs/lib/js/jquery.min.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bootstrap.min.js"
  type="text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bibCit.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/divTab.js" type=
  "text/javascript"></script>
  <script type="text/javascript" src=
  "../../../data/dl.acm.org/pubs/lib/js/MathJax.js?config=TeX-AMS_CHTML"></script>
  <script type="text/x-mathjax-config">
  <![CDATA[
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  ]]>
  </script>
</head>
<body id="main">
  <section class="front-matter">
    <section>
      <header class="title-info">
        <div class="journal-title">
          <h1><span class="title">ProxyTorrent: Untangling the Free
          HTTP(S) Proxy Ecosystem</span><br />
          <span class="subTitle"></span></h1>
        </div>
      </header>
      <div class="authorGroup">
        <div class="author">
          <span class="givenName">Diego</span> <span class=
          "surName">Perino</span>, Telefónica Research, <a href=
          "mailto:diego.perino@telefonica.com">diego.perino@telefonica.com</a>
        </div>
        <div class="author">
          <span class="givenName">Matteo</span> <span class=
          "surName">Varvello</span>, AT&amp;T Labs -
          Research<a class="fn" href="#fn1" id=
          "foot-fn1"><sup>⁎</sup></a>, <a href=
          "mailto:varvello@research.att.com">varvello@research.att.com</a>
        </div>
        <div class="author">
          <span class="givenName">Claudio</span> <span class=
          "surName">Soriente</span>, NEC Labs Europe, <a href=
          "mailto:claudio.soriente@emea.nec.com">claudio.soriente@emea.nec.com</a>
        </div>
      </div><br />
      <div class="pubInfo">
        <p>DOI: <a href="https://doi.org/10.1145/3178876.3186086"
        target=
        "_blank">https://doi.org/10.1145/3178876.3186086</a><br />
        WWW '18: <a href="https://doi.org/10.1145/3178876" target=
        "_blank">Proceedings of The Web Conference 2018</a>, Lyon,
        France, April 2018</p>
      </div>
      <div class="abstract">
        <p><small>Free web proxies promise anonymity and censorship
        circumvention at no cost. Several websites publish lists of
        free proxies organized by country, anonymity level, and
        performance. These lists index hundreds of thousand of
        hosts discovered via automated tools and crowd-sourcing. A
        complex free proxy <em>ecosystem</em> has been forming over
        the years, of which very little is known. In this paper we
        shed light on this ecosystem via ProxyTorrent, a
        distributed measurement platform that leverages both
        <em>active</em> and <em>passive</em> measurements. Active
        measurements discover free proxies, assess their
        performance, and detect potential malicious activities.
        Passive measurements relate to proxy performance and usage
        in the wild, and are collected by free proxies users via a
        Chrome plugin we developed. ProxyTorrent has been running
        since January 2017, monitoring up to 180,000 free proxies
        and totaling more than 1,500 users over a 10 months period.
        Our analysis shows that less than 2% of the proxies
        announced on the Web indeed proxy traffic on behalf of
        users; further, only half of these proxies have decent
        performance and can be used reliably. Around 10% of the
        working proxies exhibit malicious behaviors, e.g., ads
        injection and TLS interception, and these proxies are also
        the ones providing the best performance. Through the
        analysis of more than 2&nbsp;Terabytes of proxied traffic,
        we show that web browsing is the primary user activity.
        Geo-blocking avoidance is not a prominent use-case, with
        the exception of proxies located in countries hosting
        popular geo-blocked content.</small></p>
      </div>
      <div class="classifications">
        <div class="AcmReferenceFormat">
          <p><small><span style="font-weight:bold;">ACM Reference
          Format:</span><br />
          Diego Perino, Matteo Varvello, and Claudio Soriente.
          2018. ProxyTorrent: Untangling the Free HTTP(S) Proxy
          Ecosystem. In <em>WWW 2018: The 2018 Web Conference,</em>
          <em>April 23–27, 2018,</em> <em>Lyon, France. ACM, New
          York, NY, USA</em> 10 Pages. <a href=
          "https://doi.org/10.1145/3178876.3186086" class=
          "link-inline force-break" target=
          "_blank">https://doi.org/10.1145/3178876.3186086</a></small></p>
        </div>
      </div>
    </section>
  </section>
  <section class="body">
    <section id="sec-4">
      <header>
        <div class="title-info">
          <h2><span class="section-number">1</span>
          Introduction</h2>
        </div>
      </header>
      <p>Web proxies are intermediary boxes enabling HTTP
      (sometimes also HTTPS) connections between a client and a
      server. They are widely used for security, privacy,
      performance optimization or policy enforcement, to cite a few
      use cases. Many web proxies are free of charge and publicly
      available. Such proxies can be used, for example, for private
      web surfing and to access content that would be blocked
      otherwise (e.g., due to geographical restrictions).</p>
      <p>Specialized forums, websites, and even VPN service
      providers<a class="fn" href="#fn2" id=
      "foot-fn2"><sup>1</sup></a> compile daily lists of free web
      proxies. When tested, most of these proxies are slow,
      unreachable or not even real proxies. Furthermore, it is
      folklore that free web proxies perform malicious activities,
      e.g., injection of advertisements and user fingerprinting. It
      is fair to say that free proxies form a massive and complex
      <em>ecosystem</em> of which very little is known. For
      example, what is the magnitude of the ecosystem and how many
      proxies are safe to use? How and for what are these proxies
      used? Answering these questions is hard because of the scale
      of the ecosystem and because it involves two players out of
      reach: <em>free proxies</em> and their <em>users</em>.</p>
      <p>In this work we tackle the above challenge by building
      ProxyTorrent, a distributed measurement platform of the free
      proxy ecosystem. ProxyTorrent leverages our premises to
      <em>actively</em> discover and assess the performance of the
      core of the ecosystem that can be used safely. Usage
      statistics are instead <em>passively</em> (and anonymously)
      collected at free proxy users in exchange of high-quality
      proxies list compiled by ProxyTorrent.</p>
      <p>ProxyTorrent is daily fed with tens of thousands
      <em>potential</em> proxies obtained by crawling the most
      popular free proxies aggregator websites. Potential proxies
      are tested in order to discard the ones that are unreachable,
      do not proxy traffic, or perform malicious activities. This
      is done by loading a “bait” webpage we have crafted as well
      as few popular webpages, and comparing the content received
      via the proxy with the one received when no proxy was set.
      The same approach is used to detect issues with X.509
      certificates in case of TLS connections. These operations run
      daily at our premises and generate a few thousand
      <em>trusted</em> proxies. Next, we test the performance of
      trusted proxies from ∼ 30 network locations (Planetlab
      nodes&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0017">17</a>])
      while fetching the landing pages of popular websites via
      HTTP/HTTPS. Collected data is finally used to populate a list
      of <em>good</em> proxies, <em>i.e.,</em> working and
      trustworthy free proxies.</p>
      <p>This list of good proxies is then offered to a Chrome
      plugin (Ciao &nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0003">3</a>, <a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0018">18</a>]) we developed to help users
      interacting with the free proxy ecosystem. Ciao users select
      a target anonymity level and country, and the plugin
      automatically identifies the best free proxy for the task, if
      any. As the user browse the Internet through the proxy, we
      collect anonymous statistics on free proxy performance and
      how they are used in the wild.</p>
      <p>We use data collected by ProxyTorrent to provide a unique
      overview of the free proxy ecosystem. In this paper we
      present ten months worth of data spanning up to 180,000 free
      web proxies and more than 1,500 users. The analysis of this
      data-set reveals the following key findings:</p>
      <p><strong>The free proxy ecosystem is large and
      ever-growing, but only a small fraction of the announced
      proxies actually works.</strong> While thousands of new free
      proxies are announced daily, overall, less than 2% of them
      are reachable and correctly proxy traffic. Further, half of
      these proxies stop working after few days. Many reasons are
      behind such ephemeral behavior: host misconfigurations,
      dynamic addressing, and even bait proxies from VPN providers
      aiming at attracting more customers.</p>
      <p><strong>A non negligible percentage of working proxies are
      suspicious, but provide better performance than safe
      proxies.</strong> Every day, around 10% of the working
      proxies announced on the Web exhibit suspicious behavior,
      from injection of advertisements to TLS man-in-the-middle
      attempts. On average, these proxies are twice as fast as
      non-malicious ones. Fast connectivity is likely used to
      attract potential “victims”, supporting the general belief
      that free proxies are “free for a reason”.</p>
      <p><strong>The geographical distribution of proxies is fairly
      skewed.</strong> Half of the working free proxies reside in a
      handful of countries, with US, France, and China at the top.
      While US and China are at the top due to their sizes, the
      presence of large cloud providers in France is the reason
      behind such large number of proxies.</p>
      <p><strong>Geo-blocking avoidance is not a prominent use-case
      for free web proxies.</strong> By analyzing 2 TBytes of
      traffic generated by 1,500 Ciao users over 7 months, we
      conclude that web browsing is the most prominent activity.
      Proxy are rarely selected in the same location where a
      visited website resides, which suggests that circumvention of
      potential geo-blocking rules is not a primary user concern.
      Some countries like the US are an exception though, likely
      because hosting a lot of popular geo-blocked content.</p>
    </section>
    <section id="sec-5">
      <header>
        <div class="title-info">
          <h2><span class="section-number">2</span> Background and
          Related work</h2>
        </div>
      </header>
      <p><strong>Background</strong> – A <em>web proxy</em> is a
      device/application that acts as an intermediary for HTTP(S)
      requests, such as <tt>GET</tt> and <tt>CONNECT</tt>, issued
      by clients seeking resources on servers. Web proxies are
      commonly classified as <em>transparent</em>,
      <em>anonymous</em>, and <em>elite</em>, depending on the
      degree of anonymity they provide.</p>
      <p>Transparent proxies reveal the IP address of the client to
      the origin server, e.g., by adding the
      <tt>X-FORWARDED-FOR</tt> header which specifies the address
      of the client. Anonymous proxies block headers that may allow
      the origin server to detect the identity of the client, but
      still announce themselves as proxies, e.g., by adding the
      <tt>HTTP_VIA</tt> header. Elite proxies do not send any of
      the above headers and look like regular clients to the origin
      server. Yet, the origin server may detect that a proxy is
      used by probing the IP address extracted from the received
      traffic to check if it acts as a proxy.</p>
      <p><strong>Related Work</strong> – We briefly overview
      relevant results from related work and highlight differences
      with ProxyTorrent.</p>
      <p><em>Free Web Proxies.</em>Scott et al.,&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0020">20</a>] also study
      free web proxies but both their goal and methodology differ
      from ours. While our goal is a complete view of the free
      proxy ecosystem, they mostly focus on how and for what free
      proxies are used. They do so by scanning the IPv4 address
      space at popular proxy ports (e.g., 3128, 8080, and 8123)
      looking for open management interfaces (<em>i.e.,</em> proxy
      interfaces with no authentication required) from which they
      can “steal” usage statistics. This approach is intended to
      run seldomly due to the cost associated with IPv4 scanning.
      Further, it raises some ethical concerns related to exposing
      hosts found via scanning as well as intruding their
      management interfaces. ProxyTorrent was instead designed with
      both scalability and user privacy in mind. Note that we once
      ran a full scan of the IPv4 address space at popular proxy
      ports to compare our methodology with the one
      in&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0020">20</a>]
      (see Table&nbsp;<a class="tbl" href="#tab2">2</a>).</p>
      <p>ProxyTorrent shares some similarities with
      <tt>proxycheck</tt>&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0007">7</a>], a tool that can check the behavior
      of a proxy by using it to download few distinct objects
      hosted on a private webserver. Next, it labels a proxy as
      untrusted if the retrieved objects differ from the original
      ones even by a single bit, potentially generating a large
      number of false positives. Proxies are tested one at a time,
      which only allows to test ∼ 10,000 proxies a day. Despite
      some similarities, our approach is fundamentally different
      since we designed a funnel-shaped methodology (see
      Figure&nbsp;<a class="fig" href="#fig1">1</a>) aiming to
      minimize false positives while maximizing performance, e.g.,
      scaling up to hundreds of thousands proxies per day.</p>
      <p>In a parallel research work, Tsirantonakis et
      al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0021">21</a>]
      analyze about 66,000 open proxies over a two months period.
      We share a similar methodology for proxy discovery and
      content manipulation detection, and our results are aligned.
      However, we present a larger observation period
      (<em>i.e.,</em> 10 months, 180,000 proxies), and also
      consider TLS certificate manipulations and proxy performance.
      Further, we augment this similar methodology with passive
      experiments to understand proxy performance and usage in the
      wild.</p>
      <p><em>In-path Manipulations.</em> A number of papers study
      in-path web content manipulation by leveraging bait content
      served from a controlled host. Reis et al.,&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0019">19</a>] focus on
      middleboxes and serve a page with an embedded JavaScript that
      detects and reports modifications. Their data-set contains
      50,000 unique visits to their website, totaling 650 instances
      of content manipulation. Chung et al.,&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0002">2</a>] use the paid version of
      Hola&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0008">8</a>]
      (a peer-to-peer proxy network) to detect end-to-end violation
      in DNS, HTTP, and HTTPS traffic. They witness DNS hijacking,
      HTTP manipulations, image transcoding, and a few cases of TLS
      man-in-the-middle attempts. Many of the violations reported
      in&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0002">2</a>]
      are attributed to ISPs and to (malicious) software running at
      Hola proxying peers. Tyson et al.,&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0022">22</a>] use the same approach to
      investigate HTTP header manipulations. They leverage Hola to
      gather 143k vantage points in 3,818 Autonomous Systems (ASes)
      and detect header manipulation in about 25% of the ASes.
      Weaver et al.,&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0024">24</a>] detect, using
      Netalyzr&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0011">11</a>], that 14% of the HTTP connections
      are manipulated by in-network middleboxes, <em>i.e.,</em>
      devices that intercept traffic without informing the
      user.</p>
      <p>Differently from all of the above, we look at performance
      and content manipulations of free Web proxies that users
      explicitly insert in their traffic to provide privacy,
      censorship circumvention, etc. Further, we use bait content
      served from a controlled host, as well as real websites. Our
      measurement platform also leverages real users by means of a
      plugin that provides easy proxy usage in exchange of
      anonymous statistics of proxy usage in the wild.</p>
      <p><em>Virtual Private Networks.</em>Perta et
      al.,&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0015">15</a>]
      study privacy leaks in commercial VPN systems. Despite a VPN
      tunnel, they discover the following traffic leakages. First,
      IPv6 traffic is usually not tunneled. Second, poor management
      of the DNS configuration at the client may result in an
      adversary hijacking DNS requests and learning which websites
      a user visit. Similar issues are also reported by Ikram et
      al.,&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0010">10</a>]
      that analyze 283 Android VPN apps. The authors
      of&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0010">10</a>]
      also detect VPN apps with embedded tracking libraries and
      malware. Differently from these works, we focus on free web
      proxies that are a valid alternative to commercial VPNs in
      use cases such as accessing geoblocked content. Apart from
      their behavior, we further assess their performance.</p>
      <figure id="fig1">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig1.jpg"
        class="img-responsive" alt="Figure 1" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 1:</span> <span class=
          "figure-title">ProxyTorrent system overview.</span>
        </div>
      </figure>
      <p></p>
      <div class="table-responsive" id="tab1">
        <div class="table-caption">
          <span class="table-number">Table 1:</span> <span class=
          "table-title">Key aspects of each phase in
          ProxyTorrent.</span>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th style="text-align:right;"></th>
              <th style="text-align:center;"><strong>Phase
              I</strong></th>
              <th style="text-align:center;"><strong>Phase
              II</strong></th>
              <th style="text-align:center;"><strong>Phase
              III.A</strong></th>
              <th style="text-align:center;"><strong>Phase
              III.B</strong></th>
              <th style="text-align:center;"><strong>Phase
              IV</strong></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align:right;"><strong>#
              clients</strong></td>
              <td style="text-align:center;">1</td>
              <td style="text-align:center;">1</td>
              <td style="text-align:center;">1</td>
              <td style="text-align:center;">∼ 30</td>
              <td style="text-align:center;">up to 1,500</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>tools</strong></td>
              <td style="text-align:center;">beautifoulsoup</td>
              <td style="text-align:center;">curl</td>
              <td style="text-align:center;">
              PhantomJS/curl/OpenSSL</td>
              <td style="text-align:center;">curl</td>
              <td style="text-align:center;">Chrome plugin</td>
            </tr>
            <tr>
              <td style="text-align:right;"><strong>main
              task</strong></td>
              <td style="text-align:center;">web-crawling</td>
              <td style="text-align:center;">fetch 1KB synthetic
              object</td>
              <td style="text-align:center;">fetch syntetic
              webpage</td>
              <td style="text-align:center;">fetch real
              webpages</td>
              <td style="text-align:center;">interface with free
              proxies</td>
            </tr>
            <tr>
              <td style="text-align:right;"><strong>main
              goal</strong></td>
              <td style="text-align:center;">find potential
              proxies</td>
              <td style="text-align:center;">find working
              proxies</td>
              <td style="text-align:center;">test behavior</td>
              <td style="text-align:center;">test performance</td>
              <td style="text-align:center;">monitor perf. and
              usage</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>frequency</strong></td>
              <td style="text-align:center;">daily</td>
              <td style="text-align:center;">daily, on-demand</td>
              <td style="text-align:center;">daily</td>
              <td style="text-align:center;">every 5 minutes</td>
              <td style="text-align:center;">user-controlled</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>classification</strong></td>
              <td style="text-align:center;">potential</td>
              <td style="text-align:center;">
              working/unresponsible/</td>
              <td style="text-align:center;">
              trusted/suspicious/unrated</td>
              <td style="text-align:center;">
              trusted/suspicious/unrated</td>
              <td style="text-align:center;">—</td>
            </tr>
            <tr>
              <td style="text-align:right;"></td>
              <td style="text-align:center;"></td>
              <td style="text-align:center;">unreachable/other</td>
              <td style="text-align:center;"></td>
              <td style="text-align:center;"></td>
              <td style="text-align:center;"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="sec-6">
      <header>
        <div class="title-info">
          <h2><span class="section-number">3</span>
          ProxyTorrent</h2>
        </div>
      </header>
      <p>This section describes ProxyTorrent, a distributed
      measurement platform built to monitor the free proxy
      ecosystem (see Figure&nbsp;<a class="fig" href=
      "#fig1">1</a>).</p>
      <p>Due to the scale of the proxy ecosystem — potentially
      millions of machines&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0020">20</a>] — we use a funnel-shaped methodology
      with several phases (see Figure&nbsp;<a class="fig" href=
      "#fig1">1</a>). Proxies are fed into the funnel and, at each
      phase, go through a series of tests of increasing complexity.
      Only proxies that pass a given phase are admitted to the next
      one. Since each phase decreases the number of proxies under
      test, we can progressively increase test complexity. The last
      phase takes place at real proxy users, allowing to complement
      results of controlled experiments with measurements in the
      wild. Table&nbsp;<a class="tbl" href="#tab1">1</a> lists the
      key aspects of each phase. In the remainder of this section,
      we describe all phases in detail.</p>
      <p><strong>Phase I</strong> discovers free proxies (&lt; ip,
      port &gt; pairs) on the Internet by crawling several
      aggregator websites which regularly publish free proxy lists.
      Daily crawling runs from a single machine at our premises.
      The hosts discovered are used to populate a list of
      “potential proxies” sorted by the last day when each proxy
      appeared on any of the websites we crawl.</p>
      <p><strong>Phase II</strong> tests the potential proxies
      populated by Phase I for proxying capability. We use
      curl&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0004">4</a>],
      instrumented for full statistics and headers collection, to
      fetch a 1KB object—served via nginx&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0014">14</a>] from a server hosted by
      Amazon Ireland—via each potential proxy. Curl's user agent
      (UA) is set to a recent Chrome's UA in order to appear as a
      standard browser. Phase II runs daily from a single machine.
      It traverses the potential proxies list in order, and runs
      for up to 24 hours until either all proxies have been tested
      or time is over. This strategy rules out the least recently
      crawled potential proxies, in case the list becomes too big
      to be processed in a day.</p>
      <p>Each proxy is associated with a <em>similarity score</em>
      computed as the ratio of common content between the webpage
      retrieved with and without the proxy. Accordingly, a
      similarity score of 1 means that the content fetched through
      the proxy is identical to the one fetched without a
      proxy.</p>
      <p>Phase II categorizes hosts as follows.
      <em>Unresponsive</em>: hosts for which either a connection or
      max duration timeout was triggered.<a class="fn" href="#fn3"
      id="foot-fn3"><sup>2</sup></a> <em>Unreachable</em>: hosts
      that either closed the TCP connection with a reset message or
      sent ICMP messages declaring the network or the requested
      host as unreachable. <em>Working</em>: hosts with a
      similarity score ≥ 0.5, <em>i.e.,</em> that have correctly
      proxied at least 50% of our synthetic 1KB object. This
      threshold was chosen to discard proxies returning errors or
      login pages, for which we empirically measured similarity
      scores lower than 0.3 (on average). Note that proxies that
      largely alter a webpage might be caught in this rule as well.
      This is fine as far as finding safe working proxies, but it
      prevents the full behavioral analysis from phase III thus
      generating false negatives (see Section&nbsp;<a class="sec"
      href="#sec-9">4.2</a>). We further classify working proxies
      as <em>transparent</em>, <em>anonymous</em>, or
      <em>elite</em> (see Section&nbsp;<a class="sec" href=
      "#sec-5">2</a>) using HTTP headers collected both at the
      client and at the server. HTTP headers of all proxies are
      also analyzed to identify header manipulations that can be
      potentially malicious. Finally, Maxmind&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0013">13</a>] is used to obtain
      country/AS information of each working proxy. <em>Other</em>:
      all remaining hosts that relay content substantially
      different from the expected one, e.g., all the hosts
      returning a login page (private or paid proxies) or an error
      page (misconfigured hosts).</p>
      <p><strong>Phase III</strong> tests working proxies with
      respect to behavior and performance. To assess a proxy
      behavior, we use the previous methodology of comparing
      proxied content with content received when no proxy is used.
      Compared to Phase II, we introduce a headless browser, real
      content, HTTPS testing, and clients at multiple locations.
      For performance, we measure both <em>page download time</em>
      (PDT) and <em>page load time</em> (PLT). PDT is the time
      required to download the index page of a website; PLT is the
      time from when a browser starts fetching a website to the
      firing of the JavaScript <tt>onLoad()</tt> event, which
      occurs once the page's embedded resources have been
      downloaded, but possibly before all objects loaded via
      scripts are downloaded. Phase III consists of two parts (A
      and B) which both operate on the set of working proxies
      identified by Phase II within the last 7 days.</p>
      <p><strong>Phase III.A</strong> runs daily from a single
      machine at our premises. It uses PhantomJS&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0016">16</a>], a popular
      headless browser, to fetch a realistic website we serve. We
      designed this website to include elements that could trigger
      content manipulation by a proxy: a landing page
      <tt>index.html</tt> (83.7KB), two <tt>javascripts</tt> (635B
      and 22.9KB), two <tt>png</tt> images (1.5KB and 13.5KB), and
      a <tt>favicon</tt> (4.3KB). Our bait webpage is similar to
      the one set up by related work that looks for en-route
      content manipulation&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0002">2</a>].</p>
      <p>Data is collected as an HTTP Archive (HAR); for this, we
      have extended PhantomJS's HAR capturer<a class="fn" href=
      "#fn4" id="foot-fn4"><sup>3</sup></a> to also dump the actual
      content downloaded. The HAR file includes detailed
      information about which object was loaded and when, as well
      as PLT. We stop PhantomJS either one second after the
      <tt>onLoad()</tt> event, to allow for potentially pending
      objects to be downloaded, or after a 45 second maximum
      duration timeout. Compared to Phase II, we increase the
      maximum duration timeout to account for an overall more
      complex operation. As in Phase II, we set PhantomJS's US to a
      recent Chrome's UA.</p>
      <p>Phase III.A also checks for issues with X.509
      certificates. First, we use curl to connect to our server via
      port 433 and compare the X.509 certificate presented to the
      client with our original certificate (provided by
      LetsEncrypt&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0012">12</a>]). If curl detects any issue with the
      certificate, we use OpenSSL to download the X.509
      certificates from our website as well as from two popular
      websites.<a class="fn" href="#fn5" id=
      "foot-fn5"><sup>4</sup></a></p>
      <p>Phase III.A classifies a working proxy as
      <em>trusted</em>, <em>suspicious</em>, or <em>unrated</em>.
      Trusted proxies serve the expected content with no alteration
      and do not replace or modify X.509 certificates. Suspicious
      proxies alter the relayed traffic, e.g., by adding
      unsolicited content or by not relaying the expected X.509
      certificates. Finally, <em>unrated</em> proxies operate at
      such a slow speed that they are incapable to serve the full
      content requested within the maximum duration allowed. The
      partial content they serve was not modified, otherwise we
      mark them as suspicious. Phase III.A quantifies the
      performance of trusted and suspicious proxies using the PLT
      of our realistic website.</p>
      <p><strong>Phase III.B</strong> runs daily from 30 Planetlab
      nodes. Curl is used to fetch, via each proxy in the working
      proxy list, the landing pages of Alexa's top websites.
      Precisely, we construct two 1,000-website lists from Alexa
      with support for HTTP and HTTPS, respectively. For each proxy
      and fetched page, Phase III.B reports both PDT and similarity
      score. Proxies are tested mostly against HTTP websites; only
      once every 10 tests a proxy is also tested for HTTPS support
      by fetching a random website from the HTTPS list. We
      empirically measured that phase III.B is currently capable of
      testing each working proxy at least once every 5 minutes.</p>
      <p><strong>Phase IV</strong> allows to both test free web
      proxies in the wild, as well as to learn how free proxies are
      used. It runs on the machines of the users that installed
      Ciao,<a class="fn" href="#fn6" id="foot-fn6"><sup>5</sup></a>
      a Chrome plugin we developed to help users finding free
      proxies. Users pick the desired anonymity level (transparent,
      anonymous, elite) and location, and Ciao automatically sets
      up a free proxy based on input from ProxyTorrent. In order to
      minimize risk and maximize usability, we only consider
      proxies that have been labeled as <em>trusted</em> in Phase
      III.A, and that have shown the best performance in Phase
      III.B. At any time the user can request a new proxy either to
      reflect a new preference or in case of failure.</p>
      <p>Ciao reports statistics per <em>download</em>, which
      captures all the events in a browser's tab transitioning from
      one URL to another, usually in response to directly typing a
      URL, refreshing or aborting the load of a webpage, clicking a
      link within a page, etc. We leverage Chrome's
      <tt>webNavigation</tt> APIs to identify the beginning and end
      of a download. For each download, the following statistics
      are collected: timestamps associated to the beginning and end
      of a download, PLT, number of requests and bytes per protocol
      type (HTTP/HTTPS), navigation errors (if any). No personal
      information, such as IP address, browser/OS information, or
      URLs are reported at any time. Users are informed about the
      collected data and potential for anonymized research
      publications.</p>
      <div class="table-responsive" id="tab2">
        <div class="table-caption">
          <span class="table-number">Table 2:</span> <span class=
          "table-title">Crawling and scanning (Zmap) summary, June
          18th 2017. Results in the last four rows refer to
          scanning per port.</span>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th style="text-align:right;"></th>
              <th style="text-align:center;">
              <strong>Total</strong></th>
              <th style="text-align:center;">
              <strong>Unresp.</strong></th>
              <th style="text-align:center;">
              <strong>Unreach.</strong></th>
              <th style="text-align:center;">
              <strong>Other</strong></th>
              <th style="text-align:center;">
              <strong>Working</strong></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align:right;">
              <strong>Crawling</strong></td>
              <td style="text-align:center;">0.16M</td>
              <td style="text-align:center;">0.11M</td>
              <td style="text-align:center;">0.04</td>
              <td style="text-align:center;">8,000</td>
              <td style="text-align:center;">2,895</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>Zmap</strong></td>
              <td style="text-align:center;">29.1M</td>
              <td style="text-align:center;">17M</td>
              <td style="text-align:center;">5.66M</td>
              <td style="text-align:center;">6.4M.</td>
              <td style="text-align:center;">2,518</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>8080</strong></td>
              <td style="text-align:center;">13.5M</td>
              <td style="text-align:center;">6.6M</td>
              <td style="text-align:center;">2.2M</td>
              <td style="text-align:center;">4.7M</td>
              <td style="text-align:center;">376</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>8081</strong></td>
              <td style="text-align:center;">7.2M</td>
              <td style="text-align:center;">4.65M</td>
              <td style="text-align:center;">1.55M</td>
              <td style="text-align:center;">0.95M</td>
              <td style="text-align:center;">171</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>8118</strong></td>
              <td style="text-align:center;">4.7M</td>
              <td style="text-align:center;">3.45M</td>
              <td style="text-align:center;">1.15</td>
              <td style="text-align:center;">0.1M</td>
              <td style="text-align:center;">1,093</td>
            </tr>
            <tr>
              <td style="text-align:right;">
              <strong>3128</strong></td>
              <td style="text-align:center;">3.7M</td>
              <td style="text-align:center;">2.29M</td>
              <td style="text-align:center;">0.76M</td>
              <td style="text-align:center;">0.65M</td>
              <td style="text-align:center;">878</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="sec-7">
      <header>
        <div class="title-info">
          <h2><span class="section-number">4</span> The Free Proxy
          Ecosystem</h2>
        </div>
      </header>
      <p>This section characterizes the free proxy ecosystem. We
      first quantify its magnitude and evolution over time. Next,
      we provide data supporting (or not) the preconception that
      free proxies are mostly malicious and tend to manipulate
      served content. We then conclude by assessing the ecosystem
      performance and by providing some evidence on how free
      proxies are used in the wild. We report on 10 months worth of
      data (January-October, 2017) spanning more than 180,000
      proxies and 1,500 users.</p>
      <p><strong>Limitations</strong>We acknowledge from the outset
      the limitations of our methodology. According to our
      findings, around 10% of the working proxies every day exhibit
      malicious behavior by either injecting content, manipulating
      headers, or by replacing X.509 certificates. This is a lower
      bound to the fraction of malicious proxy since an exhaustive
      behavioral analysis by only controlling a few clients and
      servers is out of reach. We stress, however, that related
      work using a setup similar to ours, share the same
      limitations&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0002">2</a>, <a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0019">19</a>, <a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0022">22</a>, <a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0024">24</a>].</p>
      <p>A proxy could behave maliciously only in some cases in
      order to avoid detection. For example, it may decide to
      manipulate content based on contextual factors, such as the
      client IP address, the domain requested, etc. Our experiments
      indicate that only 20% of the malicious proxies manipulate
      the content of each requested page while many (40%) do so
      only for one out of ten pages requested. Furthermore, there
      is no guarantee that a proxy that in our experiment proxied
      traffic without alterations, will not manipulate content when
      serving other users. Perhaps the content we requested or the
      IP address of our clients simply did not trigger content
      manipulation at the proxy. Another form of malicious behavior
      that we cannot fully assess is user tracking and profiling.
      Our experiments reveal several attempts to inject
      tracking/fingerprinting code, but we cannot rule out that
      even innocent-looking proxies carry out user profiling by
      simply leveraging the IP address of the user and her list of
      requests. We nevertheless argue that ProxyTorrent improves
      the current situation for proxy users that are clueless on
      whether a given proxy is performing any kind of malicious
      activity with the relayed traffic. Furthermore, ProxyTorrent
      raises the bar for malicious proxies to avoid detection.</p>
      <section id="sec-8">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.1</span>
            Characterization</h3>
          </div>
        </header>
        <p><strong>Magnitude.</strong> Table&nbsp;<a class="tbl"
        href="#tab2">2</a> shows a snapshot of the free proxy
        ecosystem (June 18th, 2017). We chose this date since, at
        that time, we supplemented ProxyTorrent's crawling strategy
        by scanning the full IPv4 space and targeting the most
        popular proxy ports according to the aggregator websites.
        Our goal is to understand the <em>coverage</em> of the
        aggregator websites we crawl. IPv4 address scanning
        leverages Zmap&nbsp;[<a class="bib" data-trigger="hover"
        data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0005">5</a>] from a number of machines we
        control. Because of the ethical issues related to
        port-scanning, we run the scan only once. While we test the
        found proxies to categorize them, we <em>do not</em> use
        proxies found exclusively via scanning in the following
        experiments nor we make them available to Ciao users.</p>
        <p>Table&nbsp;<a class="tbl" href="#tab2">2</a> reports
        proxies obtained by <em>crawling</em> the aggregator
        websites (first row), and the one found via port-scanning
        (second row). The table distinguishes between four hosts
        categories: unreachable, unresponsive, working, and other
        (see Section&nbsp;<a class="sec" href="#sec-6">3</a>).
        Crawling yields a higher ratio of working proxies (2,895
        out of approximately 160k) compared to port-scanning (2,518
        out of more than 29M). Only 719 proxies appear in both
        data-sets. Regardless of the discovery strategy, the table
        shows that most hosts are either unresponsive or
        unreachable, and that only a few thousand hosts can
        actually be labeled as working proxies. The last four rows
        of Table&nbsp;<a class="tbl" href="#tab2">2</a> show the
        breakdown of the proxies discovered via scanning by
        port.</p>
        <figure id="fig2">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig2.jpg"
          class="img-responsive" alt="Figure 2" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 2:</span>
            <span class="figure-title">Time evolution of host
            classification: unreachable, unresponsive, working, and
            other.</span>
          </div>
        </figure>
        <figure id="fig3">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig3.jpg"
          class="img-responsive" alt="Figure 3" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 3:</span>
            <span class="figure-title">Time evolution of working
            proxies by category: unrated, trusted, and suspicious
            (either data or TLS certificate manipulation)</span>
          </div>
        </figure>
        <p></p>
        <p>Figure&nbsp;<a class="fig" href="#fig2">2</a> shows the
        evolution over time of each proxy category as defined in
        Phase II. On the first day, we bootstrap ProxyTorrent with
        a list of potential proxies containing 118,915 hosts (&lt;
        ip, port &gt; pairs) collected on specialized forums. We
        then daily supplement such list via crawling. Overall, the
        figure shows that the working proxy category has a
        different trend than the others. While the number of hosts
        in each category increases over time, the number of working
        proxies oscillates between 900 and 3,000.</p>
        <p>We now focus on the (small) core of working proxies for
        which further testing was conducted. Figure&nbsp;<a class=
        "fig" href="#fig3">3</a> shows the evolution over time of
        the <em>active</em> proxies, <em>i.e.,</em> the set proxies
        that were reachable during phase III.A at least once within
        a day. Figure&nbsp;<a class="fig" href="#fig3">3</a> also
        shows the evolution of the categories <em>trusted</em>,
        suspicious (split between proxies that manipulate TLS
        certificates—<em>cert. issue</em>—and proxies that
        manipulate actual content—<em>manipulation</em>), and
        <em>unrated</em>. <a class="fn" href="#fn7" id=
        "foot-fn7"><sup>6</sup></a></p>
        <p>According to Figure&nbsp;<a class="fig" href=
        "#fig3">3</a>, every day roughly 66% of active proxies are
        marked as trustworthy, while around 24% are marked as
        unrated. Suspicious proxies amount to 10% of the active,
        where 100-300 proxies manipulate proxied content and only a
        handful of them is caught replacing X.509 certificates. On
        average, 40% of the proxies support HTTPS. The drop
        observed in all curves at mid-June is caused by a partial
        failure of our system resources.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;The proxy ecosystem
        is characterized by a small and volatile core of proxies
        surrounded by a large and increasing set of non-proxy hosts
        that are erroneously announced on aggregator
        websites.</em></p>
        <p><strong>Geo-location.</strong> Figure <a class="fig"
        href="#fig4">4</a> and <a class="fig" href="#fig5">5</a>
        show, for the top 20 countries and ASes, the total number
        of proxies they host and the amount of suspicious proxies.
        Figures are computed considering all working proxies
        observed at least once during the six months monitoring
        period. USA (11%), France (9%) China (6.7%), Indonesia
        (6.6%), Brazil (6.5%), and Russia (6%) host 45% of the
        proxies, while the remainder is scattered across 160
        countries. A similar trend is noticeable for suspicious
        proxies, with the main difference being that China (130
        proxies) passes the US (120) and the gap with France (70)
        increases. As for the hosting ASs, about 28% of proxies are
        concentrated in only six ASs, while the remaining proxies
        reside in 4,386 ASs. Both ISPs and cloud service providers
        appear in the top 20 ASs.</p>
        <p><strong>(In)stability.</strong> Next, we explore the
        stability of the proxies located in the (usable) core of
        the free proxy ecosystem. We report their
        <em>lifetime</em>, the number of days between the first and
        the last time a proxy has been active, and their
        <em>uptime</em>, the number of days a proxy was active
        within its lifetime. Both metrics are derived using a
        proxy's IP address and port as an identifier; our estimates
        are thus lower bounds in presence of dynamic addressing.
        Figure&nbsp;<a class="fig" href="#fig6">6</a> shows the CDF
        of lifetime and uptime over 10 months, distinguishing
        between all proxies and the suspicious ones. Proxies tend
        to have a long uptime, e.g., 55% of the proxies are
        available for their whole lifetime, regardless if they are
        suspicious or not. The figure also shows that suspicious
        proxies have a significantly shorter lifetime compared to
        the rest of the ecosystem, e.g., a median lifetime of 15
        versus 35 days.</p>
        <p>Roughly half of the monitored proxies last up to a
        month. This result suggests that free proxies are fairly
        unstable over time. This can be due to dynamic addressing,
        for example when proxies run on residential hosts where
        they get their IP assigned by a dhcp server. Another
        possible reason is that some proxies serve public traffic
        due to misconfigurations that are eventually discovered and
        fixed by their administrators. The shorter lifetime
        measured for suspicious proxies could also be intentional,
        <em>i.e.,</em> frequent changes to the IP address might be
        used as a mean to circumvent banning from remote
        servers.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;The core of the
        free proxy ecosystem is characterized by an high level of
        instability which makes locating a usable proxy extremely
        challenging. Half of this core resides in a handful of
        countries, with the US leading the pack of trusted proxies
        and China the pack of suspicious ones.</em></p>
        <figure id="fig4">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig4.jpg"
          class="img-responsive" alt="Figure 4" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 4:</span>
            <span class="figure-title">Number of proxies per top 20
            countries.</span>
          </div>
        </figure>
        <figure id="fig5">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig5.jpg"
          class="img-responsive" alt="Figure 5" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 5:</span>
            <span class="figure-title">Number of proxies per top 20
            ASes.</span>
          </div>
        </figure>
        <p></p>
      </section>
      <section id="sec-9">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.2</span>
            Behavior</h3>
          </div>
        </header>
        <p>Differently from above, the following figures are
        aggregated statistics over the 10 month monitoring period.
        We discovered 39,143 working proxies of which 16,700 (42%)
        are classified as unrated, 1,833 (4.5%) as suspicious and
        20,610 (53.5%) as trusted. Excluding unrated proxies—that
        do not serve enough content to enable a classification—8.2%
        of proxies are suspicious, and 91.8% are trusted. This
        subsection focuses on suspicious proxies to comment on
        their behavior in detail.</p>
        <p><strong>Suspicious Behavior
        Classification</strong>Content manipulated by suspicious
        proxies can be summarized as follows: <tt>html</tt> (74% of
        all manipulated traffic), <tt>javascripts</tt> (24%), and
        <tt>images</tt> (2%). Unsolicited content injection mostly
        consists of <tt>javascripts</tt>, though we also spotted
        few <tt>php</tt> and <tt>image</tt> injections. Overall, we
        witnessed 228 unique content manipulations — this implies
        that several proxies manipulate traffic in the same way.
        Also, suspicious proxies do not manipulate traffic at each
        request: only 20% of them manipulate traffic all the time,
        while 40% do it less than 10% of the time.</p>
        <p>To better understand the purpose of content
        manipulation, we resort to visual inspection. To minimize
        the effort, we first cluster manipulated content using
        affinity propagation clustering&nbsp;[<a class="bib"
        data-trigger="hover" data-toggle="popover" data-placement=
        "top" href="#BibPLXBIB0006">6</a>]. Specifically, we
        consider each piece of altered or injected content as a
        string and compute the distance matrix required by the
        clustering algorithm using the edit distance between each
        pair of strings.</p>
        <figure id="fig6">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig6.jpg"
          class="img-responsive" alt="Figure 6" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 6:</span>
            <span class="figure-title">CDF of lifetime and uptime
            for all proxies and the suspicious ones.</span>
          </div>
        </figure>
        <p></p>
        <p>Among the output clusters, two of them cover about 60%
        of the content manipulation instances. The first cluster
        contains 84 instances of <em>ad injection code</em>, of
        which 50 can be linked to two companies that provide
        hotspot monetization services. The second cluster contains
        47 instances of <em>fingerprinting/tracking code</em>,
        mostly javascripts attempting to identify a user; 30 out of
        these 47 instances include <tt>rum.js</tt>, a popular
        library to monitor user-webpage interactions. Although
        <tt>rum.js</tt> is commonly used by CDN providers, there is
        no apparent motivation for a free proxy to inject such
        code.</p>
        <p>The remaining clusters include the following instances
        of injected code. Nine instances, imputable to only two
        proxies, display <em>religious-related content</em>. Four
        times we witness metadata of <em>pyweb</em>, a popular
        proxy rewriting tool for live web content. Pyweb's metadata
        triggerered our detection, but further inspection shows no
        actual content rewriting. Finally, we could not figure out
        the semantics of the remaining 84 content manipulations
        either because they were obfuscated or because they were
        only a few bytes in size.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;Few content
        manipulation strategies exist that are shared among many
        proxies, advertisement injection being the most frequent
        one. Suspicious proxies do not manipulate traffic
        constantly;</em> ProxyTorrent <em>’s continuous monitoring
        is thus paramount to detect such proxies.</em></p>
        <p><strong>Invalid X.509 Certificates</strong>HTTPS is
        supported by 17,350 proxies (about 44% of the working
        proxies) and 0.9% of them (173 proxies) were caught
        interfering with TLS handshakes. The most common behavior
        among such proxies is to replace the original certificate
        with a self-signed one showing vague <tt>CommonName</tt>
        attributes such as “https” or “US”. Three proxies provide
        certificates with <tt>CommonName</tt> matching the original
        domain but signed by “Zecurion Zgate Web”, a company
        offering corporate gateways to mitigate information
        exfiltration, and “Olofeo.com”, a French company that
        offers managed security services. Only one proxy delivers a
        certificate chain of size two, where the leaf certificate
        has the expected <tt>CommonName</tt> but the root
        certificate has <tt>CommonName</tt> set to
        “STATESTATESTATESTATESTATE”. The issuer of this certificate
        is <tt>wscert.com</tt>, a domain expired as of February
        2017.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;Attempts of TLS
        interception are rare in the free proxy ecosystem. Modern
        browsers would easily detect these potential attacks and
        inform the user. Yet previous work has shown that users
        tend to click through warnings</em>&nbsp;[<a class="bib"
        data-trigger="hover" data-toggle="popover" data-placement=
        "top" href="#BibPLXBIB0001">1</a>].</p>
        <figure id="fig7">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig7.jpg"
          class="img-responsive" alt="Figure 7" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 7:</span>
            <span class="figure-title">Header manipulation: request
            headers.</span>
          </div>
        </figure>
        <figure id="fig8">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig8.jpg"
          class="img-responsive" alt="Figure 8" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 8:</span>
            <span class="figure-title">Header manipulation:
            response headers.</span>
          </div>
        </figure><strong>Header Analysis</strong> We now analyze
        HTTP request and response headers with the two-fold
        objective of understanding the level of anonymity provided
        by proxies, and if header manipulation by free proxies goes
        beyond traffic anonymization. First, we focus on the
        working proxies observed at least once during six months.
        Then, we extend our analysis to proxies categorized as
        <em>other</em>, <em>i.e.,</em> proxies that relay a webpage
        that differs more than 50% from our bait webpage (see Phase
        II in Section&nbsp;<a class="sec" href="#sec-6">3</a>).
        <p></p>
        <p>Figure&nbsp;<a class="fig" href="#fig7">7</a> shows the
        top 10 request header modifications and injections
        observed; <tt>Via</tt>, <tt>X-Proxy-ID</tt>,
        <tt>X-Forwarded-For</tt>, and <tt>Connection</tt> are the
        most frequently added headers. The first two headers are
        used by proxies to announce themselves to origin servers,
        while the third one specifies the client IP address to the
        origin server, when the proxy acts transparently. By
        leveraging those headers we classify proxies as: 1)
        transparent (77%), proxies that reveal the original client
        IP to the server; 2) anonymous (6%), proxies that preserve
        client anonymity but reveal their presence to the server;
        3) elite (17%), proxies that preserve client anonymity and
        do not announce themselves to the origin server.</p>
        <p><tt>Connection</tt> is another frequently injected
        header. Roughly 60% of the proxies tested set it to
        <tt>close</tt> or <tt>keep-alive</tt>. This behavior is not
        surprising as this header is reserved for point-to-point
        communication, <em>i.e.,</em> between client and proxy or
        between server and proxy. The <tt>Proxy-Connection</tt>
        header plays a similar role, and it is also added in about
        10% of cases. <tt>Cache-Control</tt> is the only request
        header which is altered; about 10% of proxies modify this
        header to accept cached content with a given
        <tt>max-age</tt> value, despite our testing tools
        explicitly specify not to serve cached content. We also
        observe that less than 1% of proxies (not shown in
        Figure&nbsp;<a class="fig" href="#fig7">7</a>) modify the
        user-agent by either removing it or specifying their own
        agents. While the exposure of the client user-agent reduces
        anonymity, it allows the server to optimize the content
        served based on the user device and application.</p>
        <p>Figure&nbsp;<a class="fig" href="#fig8">8</a> shows the
        top 10 response header modifications and injections
        performed by working proxies. As for the request headers,
        the <tt>Via</tt> header is among the most frequently
        injected one; this is used by proxies to to announce
        themselves and their protocol capabilities to clients.
        About 30% of proxies also add the <tt>X-Cache</tt> header
        to specify if the requested content was served from the
        proxy's cache or if a previously cached response is
        available. The most frequently modified header is the
        <tt>Connection</tt> header, that is either removed (50% of
        cases) or set to <tt>close</tt>. As previously stated, this
        is a common behavior as this header is connection specific
        and does not need to be propagated to the client. Finally,
        less than 10% of the proxies modify the <tt>Server</tt>
        header to reflect the software they use, rather than the
        one of the origin server.</p>
        <figure id="fig9">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig9.jpg"
          class="img-responsive" alt="Figure 9" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 9:</span>
            <span class="figure-title">CDF of average PLT per proxy
            distinguishing between suspicious, all, and best
            performing proxies.</span>
          </div>
        </figure>
        <figure id="fig10">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig10.jpg"
          class="img-responsive" alt="Figure 10" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 10:</span>
            <span class="figure-title">Proxy usage and geo-location
            analysis.</span>
          </div>
        </figure>
        <p></p>
        <p>We now focus on proxies categorized as <em>others</em>.
        Similar observations as above hold; in addition, we observe
        a non negligible amount of <tt>Set-Cookie</tt> (5%),
        <tt>Access-Control-Allow-*</tt> (1%), and
        <tt>X-Adblock-Key</tt> (0.5%) headers injected in the
        responses to clients. The <tt>Set-Cookie</tt> header pushes
        a cookie to the client that may be used for tracking.</p>
        <p>The <tt>Access-Control-Allow-*</tt> headers are used to
        grant permission to clients to access resources from a
        different origin domain than the one currently in use. Both
        headers expose clients to malicious or unintended
        activities; however, they are also frequent for private and
        enterprise proxies. Because similar headers were not
        observed, at this scale, for the working proxies, we
        conclude that this behavior is unlikely malicious.
        Conversely, the <tt>X-Adblock-Key</tt> response header
        allows ads to be displayed at clients bypassing ad-blocker
        tools. Proxies injecting this header likely return a
        modified version of our “bait” webpage including extra
        advertisements, which largely departs from the original
        page (similarity score &lt; 0.5). Proxies categorized as
        <em>others</em> were between 30,000 and 40,000; this
        analysis suggests that the similarity score rule introduces
        about 150-200 false negatives or about 1%.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;HTTP header
        analysis reveals that the free proxy ecosystem is mostly
        composed of transparent proxies which announce themselves
        and/or reveal the client's IP address to the origin server.
        Suspicious header manipulation is rare; when present, it
        aims at ensuring that injected advertisements are not
        filtered by ad-blockers</em>.</p>
      </section>
      <section id="sec-10">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.3</span>
            Performance</h3>
          </div>
        </header>
        <p>We now investigate the <em>performance</em> of the free
        proxy ecosystem, or how fast can free proxies deliver
        content to their users. We use page load time (PLT) as a
        performance metric since it accurately quantifies end user
        experience&nbsp;[<a class="bib" data-trigger="hover"
        data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0023">23</a>]. However, PLT also depends on the
        composition of a webpage, <em>i.e.,</em> its overall size
        and complexity in terms of number of objects. Accordingly,
        it has to be noted that PLT values from experiments in
        Phase III refer to our synthetic webpage—small size and
        only few objects—while PLT values for experiments in Phase
        IV refer to proxies usage in the wild, <em>i.e.,</em>
        overall bigger webpages with hundreds of embedded
        objects.</p>
        <p>Figure <a class="fig" href="#fig9">9</a> shows the CDF
        of the average PLT measured through each proxy,
        distinguishing between suspicious proxies
        (<em>suspicious</em>), all proxies in the ecosystem
        (<em>working</em>), and the best performing proxies
        ProxyTorrent offers to its users via Ciao (<em>top</em>).
        PLT values for both all and suspicious proxies are measured
        in Phase III, while PLT values for top proxies are measured
        in Phase IV. Failed downloads, where no PLT was measured
        are not taken into account.</p>
        <p>Figure <a class="fig" href="#fig9">9</a> shows that
        suspicious proxies are faster than other proxies in the
        ecosystem, e.g., the median PLT they provide is 2.5x faster
        (7 seconds versus 18). The figure also shows that
        ProxyTorrent correctly identifies the best performing
        proxies since their PLT measured at the user is 15% faster
        than the rest of the ecosystem.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;Suspicious proxies
        are, on average, twice as fast as safe proxies. Faster
        connectivity may be used by malicious proxy as a bait to
        attract more potential victims. Our finding support the
        popular belief that free proxies are “free for a
        reason”.</em></p>
        <figure id="fig11">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186086/images/www2018-95-fig11.jpg"
          class="img-responsive" alt="Figure 11" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 11:</span>
            <span class="figure-title">Scatterplot of download size
            and duration.</span>
          </div>
        </figure>
        <p></p>
      </section>
      <section id="sec-11">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.4</span> Usage</h3>
          </div>
        </header>
        <p>We released Ciao—our Chrome plugin to facilitate
        discovery and usage of free proxies—on the Chrome Web store
        on March 17th 2017, and announced it via email, social
        media, and few forums on free proxies, anonymity,
        censorship circumvention, etc. Between March 2017 and
        October 2017 Ciao has been installed by more than 1,500
        users who generated about 1,3 Millions downloads, totaling
        2&nbsp;TBytes of HTTP/HTTPS traffic (1.5/0.5&nbsp;TBytes,
        respectively).</p>
        <p>We start by investigating user preferences in terms of
        both proxy location and anonymity level. While for 70% of
        the queries the users did specify a country preference,
        they requested a specific anonymity level only for 16% of
        their queries. This indicates that users are overall more
        interested in the proxy location than its anonymity level.
        According to user preferences, anonymity levels can be
        ranked as follows: transparent proxies (7%), elite (5%),
        and anonymous (4%). With respect to proxy locations, only
        20% of the queries are concentrated in the 10 most popular
        locations (see Figure&nbsp;10(a)), while the remainder 80%
        are spread across 120 countries. These top 10 countries are
        also among the ones where most proxies are located (see
        Figure&nbsp;<a class="fig" href="#fig4">4</a>). Since Ciao
        shows how many proxies are available per country, it is
        possible that user preferences have been influenced by this
        information.</p>
        <p>Next, we investigate <em>where</em> most of the traffic
        is proxied. Figure&nbsp;10(b) shows the fraction of
        downloads and bytes for the top 10 countries only
        considering downloads where a country preference was set
        (70% of the time). In this case, the distribution is
        heavily skewed towards the top 10 locations accounting,
        overall, for about 60% of all downloads and bytes
        transferred. However, the ranking between the two figures
        is fairly similar.</p>
        <p>Figure&nbsp;<a class="fig" href="#fig10">10(c)</a> shows
        the distribution of “geo-localized” Ciao traffic,
        <em>i.e.,</em> traffic associated with a webpage hosted in
        the same country of the proxy being used. For this
        analysis, we temporarily (one month) extended the
        statistics collected by Ciao (see Section&nbsp;<a class=
        "sec" href="#sec-6">3</a>, phase IV) to infer whether the
        location of a requested website is the same of the proxy
        used. Ciao users have been informed of this temporary
        change in the data collection.</p>
        <p>Figure&nbsp;<a class="fig" href="#fig10">10(c)</a> shows
        that, on average, the websites accessed via a free proxy
        and the proxy itself are hosted in the same country for 30%
        of downloads and 20% of bytes. Further, we observe no
        geo-localized traffic for half of the countries. This
        results suggests that geo-blocking avoidance is not a
        prominent use-case for free web proxies. However, the
        figure also shows some countries with high percentages of
        geo-localized traffic, e.g., 60% in the US.</p>
        <p>The geo-localized traffic observed in
        Figure&nbsp;<a class="fig" href="#fig10">10(c)</a> could be
        attempts to access popular geo-blocked services like Hulu
        or Netflix in the US. In absence of URL visibility, we
        investigate whether these users are particularly concerned
        about leaking their IP/location, <em>i.e.,</em> are more
        likely to request anonymous and elite proxies. We find that
        for these downloads anonymous proxies are the most popular
        choice (70%)—while normally being the least popular
        choice—followed by transparent (23%) and elite (7%). Even
        if elite proxies provide a higher anonymity level than
        anonymous ones, they are less likely used to access
        geo-blocked content. This may be due to their name that
        does not clearly highlight strong anonymity to non-expert
        users, differently from <em>anonymous</em> proxies.</p>
        <p>Finally, we investigate which type of content is
        downloaded when using free web proxies. Our analysis relies
        on the little information Ciao collects to preserve its
        users privacy, <em>i.e.,</em> download size and duration.
        Figure&nbsp;<a class="fig" href="#fig11">11</a> shows a
        scatterplot of the size of each download (bytes) as a
        function of its duration (seconds). 95% of downloads are
        short (&lt; 1 minute) and contain, on average,
        500&nbsp;KBytes. Even though 500&nbsp;KBytes is less than
        the size of an average webpage (2.9 MBytes according to
        <em>httparchive</em>&nbsp;[<a class="bib" data-trigger=
        "hover" data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0009">9</a>]) these downloads relate to regular
        web browsing. The smaller download size we observe is due
        to: 1) <em>httparchive</em> derives its statistics from
        crawling Alexa's top webpages while our workload is driven
        by real users that may visit a different set of websites,
        2) our download size estimation is a lower bound on the
        actual webpage size as Ciao is oblivious to data retrieved
        from the browser's cache. Figure&nbsp;<a class="fig" href=
        "#fig11">11</a> also shows a non-negligible amount of
        downloads lasting several minutes (0.1%) and containing few
        100&nbsp;MBytes, as well as two very long downloads (up to
        couple of hours) containing few GBytes. These large
        downloads could be due to software or video downloads, live
        streaming, etc. We speculate the latter since no additional
        browsing activity was observed during these long sessions,
        <em>i.e.,</em> the user did not perform any other download
        suggesting that she could be watching the content being
        retrieved.</p>
        <p><strong>Takeaway:</strong> <em>&nbsp;</em>Ciao <em>has
        proven to be a valuable tool to shed some lights on how
        free proxies are used. By analyzing 2 TBytes of traffic
        generated by 1,500 users over 7 months, we identify web
        browsing as the most prominent user activity. Overall,
        geo-blocking avoidance is not a prominent use-case for free
        web proxies, with exception of countries hosting a lot of
        geo-blocked content like the US.</em></p>
      </section>
    </section>
    <section id="sec-12">
      <header>
        <div class="title-info">
          <h2><span class="section-number">5</span> Conclusion</h2>
        </div>
      </header>
      <p>Fueled by an increasing need of anonymity and censorship
      circumvention, the (free) web proxy <em>ecosystem</em> has
      been growing wild in the last decade. Such ecosystem
      consists, potentially, of millions of hosts, whose
      reachability and performance information are scattered across
      multiple forums and websites. Studying this ecosystem is hard
      because of its large scale, and because it involves two
      players out of reach: free proxies and their users. The key
      contributions of this work are ProxyTorrent, a distributed
      measurement platform for the free proxy ecosystem, and an
      analysis of 10 months of data spanning up to 180,000 free
      proxies and 1,500 users. ProxyTorrent leverages a
      funnel-based testing methodology to actively monitor hundreds
      of thousand free proxies every day. Further, it leverages
      free proxies users to understand how proxies perform and how
      they are used in the wild. The latter is achieved via a
      Chrome plugin we developed which simplifies the (hard) task
      of finding a <em>working</em> and <em>safe</em> free proxy in
      exchange of anonymous proxy usage statistics. Our analysis
      shows that the free proxy ecosystem consists of a very small
      and volatile core, less than 2% of all announced proxies with
      a lifetime of few days. Only half of the proxies in this core
      have good enough performance to be used. However, users
      should be aware that about 10% of the best working proxies
      are “free for a reason”: ads injection and TLS interception
      are two examples of malicious behaviors we observed from such
      proxies. Finally, the analysis of more than 2&nbsp;Terabytes
      of proxied traffic shows that free proxies are mostly used
      for web browsing and that geo-blocking avoidance is not a
      prominent use-case.</p>
    </section>
  </section>
  <section class="back-matter">
    <section id="ref-001">
      <header>
        <div class="title-info">
          <h2 class="page-brake-head">REFERENCES</h2>
        </div>
      </header>
      <ul class="bibUl">
        <li id="BibPLXBIB0001" label="[1]">Devdatta Akhawe and
        Adrienne&nbsp;Porter Felt. 2013. Alice in Warningland: A
        Large-Scale Field Study of Browser Security Warning
        Effectiveness. In <em><em>USENIX Security
        Symposium</em></em> . 257–272.</li>
        <li id="BibPLXBIB0002" label="[2]">Taejoong Chung,
        David&nbsp;R. Choffnes, and Alan Mislove. 2016. Tunneling
        for Transparency: A Large-Scale Analysis of End-to-End
        Violations in the Internet. In <em><em>ACM Internet
        Measurement Conference,IMC</em></em> . 199–213.</li>
        <li id="BibPLXBIB0003" label="[3]">CIAO. 2017. Automated
        free proxies discovery/usage.(2017). <a class=
        "link-inline force-break" href=
        "https://goo.gl/NgJmLE">https://goo.gl/NgJmLE</a>.
        </li>
        <li id="BibPLXBIB0004" label="[4]">CURL. 2017. Command line
        tool and library for transferring data with URLs.(2017).
        <a class="link-inline force-break" href=
        "https://curl.haxx.se/">https://curl.haxx.se/</a>.
        </li>
        <li id="BibPLXBIB0005" label="[5]">Zakir Durumeric, Eric
        Wustrow, and J.&nbsp;Alex Halderman. 2013. ZMap: Fast
        Internet-Wide Scanning and its Security Applications. In
        <em><em>USENIX Security Symposium</em></em> . 605–620.</li>
        <li id="BibPLXBIB0006" label="[6]">Brendan&nbsp;J Frey and
        Delbert Dueck. 2007. Clustering by passing messages between
        data points. <em><em>science</em></em> 315, 5814 (2007),
        972–976.</li>
        <li id="BibPLXBIB0007" label="[7]">Haschek Solutions. 2017.
        ProxyChecker. (2017). <a class="link-inline force-break"
        href=
        "https://github.com/chrisiaut/proxycheck_script">https://github.com/chrisiaut/proxycheck_script</a>.
        </li>
        <li id="BibPLXBIB0008" label="[8]">Hola. 2017. Free VPN,
        Secure Browsing, Unrestricted Access. (2017). <a class=
        "link-inline force-break" href=
        "http://hola.org/">http://hola.org/</a>.
        </li>
        <li id="BibPLXBIB0009" label="[9]">HTTP Archive.[n. d.].
        The HTTP Archive tracks how the Web is built.([n. d.]).
        <a class="link-inline force-break" href=
        "http://httparchive.org/">http://httparchive.org/</a>.
        </li>
        <li id="BibPLXBIB0010" label="[10]">Muhammad Ikram, Narseo
        Vallina-Rodriguez, Suranga Seneviratne, Mohamed&nbsp;Ali
        Kâafar, and Vern Paxson. 2016. An Analysis of the Privacy
        and Security Risks of Android VPN Permission-enabled Apps.
        In <em><em>ACM Internet Measurement
        Conference,IMC</em></em> . 349–364.</li>
        <li id="BibPLXBIB0011" label="[11]">Christian Kreibich,
        Nicholas Weaver, Boris Nechaev, and Vern Paxson. 2010.
        Netalyzr: illuminating the edge network. In <em><em>ACM
        nternet Measurement Conference, IMC</em></em> .
        246–259.</li>
        <li id="BibPLXBIB0012" label="[12]">letsencrypt. 2017. A
        free, automated, and open Certificate Authority.(2017).
        <a class="link-inline force-break" href=
        "https://letsencrypt.org/">https://letsencrypt.org/</a>.
        </li>
        <li id="BibPLXBIB0013" label="[13]">MAXMIND. 2017. IP
        Geolocation and Online Fraud Prevention. (2017).
          <a class="link-inline force-break" href=
          "https://www.maxmind.com/">https://www.maxmind.com/</a>.
        </li>
        <li id="BibPLXBIB0014" label="[14]">NGINX. 2017. A free,
        open-source, high-performance HTTP server.(2017).
          <a class="link-inline force-break" href=
          "https://nginx.org/">https://nginx.org/</a>.
        </li>
        <li id="BibPLXBIB0015" label="[15]">Vasile&nbsp;Claudiu
        Perta, Marco&nbsp;Valerio Barbera, Gareth Tyson, Hamed
        Haddadi, and Alessandro Mei. 2015. A Glance through the VPN
        Looking Glass: IPv6 Leakage and DNS Hijacking in Commercial
        VPN clients. <em><em>PoPETs</em></em> 2015, 1 (2015),
        77–91.</li>
        <li id="BibPLXBIB0016" label="[16]">PhantomJS. 2017.
        Headless Browser. (2017). <a class=
        "link-inline force-break" href=
        "http://phantomjs.org/">http://phantomjs.org/</a>.
        </li>
        <li id="BibPLXBIB0017" label="[17]">PLANETLAB. 2017. An
        open platform for developing, deploying, and accessing
        planetary-scale services. (2017). <a class=
        "link-inline force-break" href=
        "https://www.planet-lab.org/">https://www.planet-lab.org/</a>.
        </li>
        <li id="BibPLXBIB0018" label="[18]">ProxyTorrent team.2017.
        Ciao code.(2017). <a class="link-inline force-break"
          href="https://github.com/ciao-dev/CIAO">https://github.com/ciao-dev/CIAO</a>.
        </li>
        <li id="BibPLXBIB0019" label="[19]">Charles Reis,
        Steven&nbsp;D. Gribble, Tadayoshi Kohno, and
        Nicholas&nbsp;C. Weaver. 2008. Detecting In-Flight Page
        Changes with Web Tripwires. In <em><em>USENIX Symposium on
        Networked Systems Design &amp; Implementation,
        NSDI</em></em> . 31–44.</li>
        <li id="BibPLXBIB0020" label="[20]">Will Scott, Ravi
        Bhoraskar, , and Arvind Krishnamurthy. 2015. Understanding
        Open Proxies in the Wild. In <em><em>Chaos Communication
        Camp</em></em> .</li>
        <li id="BibPLXBIB0021" label="[21]">Georgios Tsirantonakis,
        Panagiotis Ilia, Sotiris Ioannidis, Elias Athanasopoulos,
        and Michalis Polychronakis. 2018. A Large-scale Analysis of
        Content Modification by Open HTTP Proxies. <em><em>Network
        and Distributed System Security Symposium (NDSS).</em></em>
        (2018).</li>
        <li id="BibPLXBIB0022" label="[22]">Gareth Tyson, Shan
        Huang, Félix Cuadrado, Ignacio Castro, Vasile&nbsp;Claudiu
        Perta, Arjuna Sathiaseelan, and Steve Uhlig. 2017.
        Exploring HTTP Header Manipulation In-The-Wild. In
        <em><em>International Conference on World Wide Web,
        WWW</em></em> . 451–458.</li>
        <li id="BibPLXBIB0023" label="[23]">Matteo Varvello, Jeremy
        Blackburn, David Naylor, and Konstantina Papagiannaki.
        2016. EYEORG: A Platform For Crowdsourcing Web Quality Of
        Experience Measurements. In <em><em>CONEXT</em></em> .</li>
        <li id="BibPLXBIB0024" label="[24]">Nicholas Weaver,
        Christian Kreibich, Martin Dam, and Vern Paxson. 2014. Here
        Be Web Proxies. In <em><em>Passive and Active Measurement,
        PAM</em></em> . 183–192.</li>
      </ul>
    </section>
  </section>
  <section id="foot-001" class="footnote">
    <header>
      <div class="title-info">
        <h2>FOOTNOTE</h2>
      </div>
    </header>
    <p id="fn1"><a href="#foot-fn1"><sup>⁎</sup></a>Work done while
    at Telefonica Research</p>
    <p id="fn2"><a href="#foot-fn2"><sup>1</sup></a>For example,
    <a class="link-inline force-break" href=
    "https://hide.me">https://hide.me</a></p>
    <p id="fn3"><a href="#foot-fn3"><sup>2</sup></a>We measured
    empirically that 3 seconds (TCP handshake) and 30 seconds
    (maximum duration) are long enough for 95% of the proxies.</p>
    <p id="fn4"><a href="#foot-fn4"><sup>3</sup></a><a class=
    "link-inline force-break" target="_blank" href=
    "http://phantomjs.org/network-monitoring.html">http://phantomjs.org/network-monitoring.html</a></p>
    <p id="fn5"><a href="#foot-fn5"><sup>4</sup></a><a class=
    "link-inline force-break" href=
    "https://www.theguardian.com">https://www.theguardian.com</a>
    and <a class="link-inline force-break" href=
    "https://www.google.com">https://www.google.com</a></p>
    <p id="fn6"><a href="#foot-fn6"><sup>5</sup></a><a class=
    "link-inline force-break" target="_blank" href=
    "https://goo.gl/y86fOy">https://goo.gl/y86fOy</a></p>
    <p id="fn7"><a href="#foot-fn7"><sup>6</sup></a>The curve
    <em>cert. issue</em> starts from mid February, when we added
    HTTPS support to ProxyTorrent.</p>
    <div class="bibStrip">
      <p>This paper is published under the Creative Commons
      Attribution 4.0 International (CC-BY&nbsp;4.0) license.
      Authors reserve their rights to disseminate the work on their
      personal and corporate Web sites with the appropriate
      attribution.</p>
      <p><em>WWW '18, April 23-27, 2018, Lyon, France</em></p>
      <p>© 2018; IW3C2 (International World Wide Web Conference
      Committee), published under Creative Commons CC-BY&nbsp;4.0
      License. ACM ISBN 978-1-4503-5639-8/18/04.<br />
      DOI: <a class="link-inline force-break" target="_blank" href=
      "https://doi.org/10.1145/3178876.3186086">https://doi.org/10.1145/3178876.3186086</a></p>
    </div>
  </section>
  <div class="pubHistory">
    <p></p>
  </div>
</body>
</html>
