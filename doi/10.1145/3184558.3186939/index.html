<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.16" />
  <title>MapSQ: A Plugin-based MapReduce Framework for SPARQL
  Queries on GPU</title>
  <!-- Copyright (c) 2010-2015 The MathJax Consortium -->
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8" />
  <meta name="viewport" content=
  "width=device-width; initial-scale=1.0;" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap-theme.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/main.css" />
  <script src="../../../data/dl.acm.org/pubs/lib/js/jquery.min.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bootstrap.min.js"
  type="text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bibCit.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/divTab.js" type=
  "text/javascript"></script>
  <script type="text/javascript" src=
  "../../../data/dl.acm.org/pubs/lib/js/MathJax.js?config=TeX-AMS_CHTML"></script>
  <script type="text/x-mathjax-config">
  <![CDATA[
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  ]]>
  </script>
</head>
<body id="main">
  <section class="front-matter">
    <section>
      <header class="title-info">
        <div class="journal-title">
          <h1><span class="title">MapSQ: A Plugin-based MapReduce
          Framework for SPARQL Queries on GPU</span><br />
          <span class="subTitle"></span></h1>
        </div>
      </header>
      <div class="authorGroup">
        <div class="author">
          <span class="givenName">Jiaming</span> <span class=
          "surName">Song</span>, School of Computer Science and
          Technology, Tianjin University, Tianjin 300350,
          China<br />
          Tianjin Key Laboratory of Cognitive Computing and
          Application, Tianjin 300350, China
        </div>
        <div class="author">
          <span class="givenName">Xiaowang</span> <span class=
          "surName">Zhang</span>, School of Computer Science and
          Technology, Tianjin University, Tianjin 300350,
          China<br />
          Tianjin Key Laboratory of Cognitive Computing and
          Application, Tianjin 300350, China
        </div>
        <div class="author">
          <span class="givenName">Peng</span> <span class=
          "surName">Peng</span>, College of Computer Science and
          Electronic Engineering, Hunan University, Changsha
          410082, China
        </div>
        <div class="author">
          <span class="givenName">Zhiyong</span> <span class=
          "surName">Feng</span>, School of Computer Software,
          Tianjin University, Tianjin 300350, China<br />
          Tianjin Key Laboratory of Cognitive Computing and
          Application, Tianjin 300350, China
        </div>
        <div class="author">
          <span class="givenName">Lei</span> <span class=
          "surName">Zou</span>, Institute of Computer Science and
          Technology, Peking University, Beijing 100871, China
        </div>
      </div><br />
      <div class="pubInfo">
        <p>DOI: <a href="https://doi.org/10.1145/3184558.3186939"
        target=
        "_blank">https://doi.org/10.1145/3184558.3186939</a><br />
        WWW '18: <a href="https://doi.org/10.1145/3184558" target=
        "_blank">Proceedings of The Web Conference 2018</a>, Lyon,
        France, April 2018</p>
      </div>
      <div class="abstract">
        <p><small>In this paper, we present a plugin-based
        framework (MapSQ) with three parts for SPARQL queries
        utilizing high-performance of GPU to accelerate answering
        in a convenient way. Selector chooses suitable join order
        according to characteristics of data and queries. Executor
        answers subqueries and returns intermediate solutions and
        GPU Computing obtains the join result of intermediate
        solutions through MapReduce. Finally, we evaluate MapSQ
        bulit on gStore and RDF-3X on the LUBM benchmark and YAGO
        datasets (over 200 million triples). The experimental
        results show that MapSQ significantly improves the
        performance of SPARQL query engines with speedup up to
        33.</small></p>
      </div>
      <div class="classifications">
        <div class="author">
          <span style=
          "font-weight:bold;"><small>Keywords:</small></span>
          <span class="keyword"><small>RDF</small>,</span>
          <span class="keyword"><small>SPARQL</small>,</span>
          <span class="keyword"><small>Parallel
          Computing</small>,</span> <span class=
          "keyword"><small>MapReduce</small>,</span> <span class=
          "keyword"><small>GPU</small></span>
        </div><br />
        <div class="AcmReferenceFormat">
          <p><small><span style="font-weight:bold;">ACM Reference
          Format:</span><br />
          Jiaming Song, Xiaowang Zhang, Peng Peng, Zhiyong Feng,
          and Lei Zou. 2018. MapSQ: A Plugin-based MapReduce
          Framework for SPARQL Queries on GPU. In <em>WWW '18
          Companion: The 2018 Web Conference Companion,</em>
          <em>April 23–27, 2018 (WWW ’18 Companion),</em> <em>Lyon,
          France. ACM, New York, NY, USA</em> 3 Pages. <a href=
          "https://doi.org/10.1145/3184558.3186939" class=
          "link-inline force-break" target=
          "_blank">https://doi.org/10.1145/3184558.3186939</a></small></p>
        </div>
      </div>
    </section>
  </section>
  <section class="body">
    <section id="sec-9">
      <header>
        <div class="title-info">
          <h2><span class="section-number">1</span>
          Introduction</h2>
        </div>
      </header>
      <p>Queries over RDF data (i.e., a triple) can be expressed as
      SPARQL which is the standard query language over an RDF graph
      (a set of triples). To process SPARQL queries, there emerge
      many engines with various kinds of storage methods and query
      approaches&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0001">1</a>]. However, those SPARQL query engines
      based on different optimizations bring difficulties to
      essential improvement of performance in processing
      large-scale data.</p>
      <p>As an efficient parallel processing way, graphics
      processing units (GPUs) are pervasively applied and provide a
      higher level of speedup by executing multiple threads
      simultaneously. A lot of GPU-based systems have been proposed
      for large-scale data processing, such as GCMR&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0003">3</a>]. However,
      there is few open researches on utilizing GPU to query RDF
      graph. In addition, the cost of transmission between CPU and
      GPU has to be taken into account&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0004">4</a>].</p>
      <p>In this paper, we present a plugin-based MapReduce
      framework for SPARQL query processing on GPU. This framework
      contains three parts, namely, <em>Selector</em>,
      <em>Executor</em>, and <em>GPU Computing</em>. We apply
      Selector to choose the best underlying engine and suitable
      join order according to characteristics of data and queries.
      Furthermore, Executor is used to answer subqueries and return
      intermediate solutions by employing SPARQL engines. Finally,
      GPU is applied to compute the join of intermediate solutions
      through MapReduce on GPU. We evaluate four popular kinds of
      queries in MapSQ on gStore and RDF-3X over the LUBM and YAGO
      datasets. The experimental results show that GPU in MapSQ
      essentially improves the performance of SPARQL engines with
      speedup up to 33.</p>
    </section>
    <section id="sec-10">
      <header>
        <div class="title-info">
          <h2><span class="section-number">2</span> Framework of
          MapSQ</h2>
        </div>
      </header>
      <p>The framework of MapSQ is shown in Figure&nbsp;<a class=
      "fig" href="#fig1">1</a>.</p>
      <figure id="fig1">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186939/images/www18companion-179-fig1.jpg"
        class="img-responsive" alt="Figure 1" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 1:</span> <span class=
          "figure-title">Framework of MapSQ.</span>
        </div>
      </figure>
      <p>MapSQ consists of three main parts: <em>Selector</em>,
      <em>Excecutor</em>, and <em>GPU Computing</em>.</p>
      <p><strong>Selector</strong>. Selector also contains three
      modules: <em>Analyzer</em>, <em>Query Engine Selector</em>,
      and <em>Join Decider</em>.</p>
      <ul class="list-no-style">
        <li id="list1" label="•">The module of Analyzer provides
        arguments for engine selecting and join-order decision
        making by counting the distinct predicates of the RDF data
        and classifies the shape of SPARQL queries. In fact, SPARQL
        query engines are mostly sensitive to the shape of SPARQL
        queries&nbsp;[<a class="bib" data-trigger="hover"
        data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0001">1</a>]. For instance,
        RDF-3X&nbsp;[<a class="bib" data-trigger="hover"
        data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0005">5</a>] is more suitable for triangle
        queries than gStore&nbsp;[<a class="bib" data-trigger=
        "hover" data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0002">2</a>] due to the VS-tree index of
        gStore.<br />
        </li>
        <li id="list2" label="•">The module of Query Engine
        Selector, based on arguments from Analyzer, chooses a
        suitable engine to improve performance in an adaptive
        way.<br /></li>
        <li id="list3" label="•">The module of Join Decider, based
        on arguments from Analyzer, splits a SPARQL query into
        subqueries to be joined in the GPU Computing in order to
        find a best strategy for GPU join. In the parallel
        processing on GPU, load balancing and the cost of
        transmission between host memory and device memory are two
        major factors of the performance. So the best place for a
        GPU join is where the subqueries have the similar small
        amounts of the partial results. For instance, consider
        Query2 of LUBM shown in Figure&nbsp;<a class="fig" href=
        "#fig2">2</a>. Because gStore has powerful processing
        capability of the subgraphs with less selectivity, Join
        Decider assigns the subqueries of this type to the
        underlying engines as more as possible.<br />
        </li>
      </ul>
      <figure id="fig2">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186939/images/www18companion-179-fig2.jpg"
        class="img-responsive" alt="Figure 2" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 2:</span> <span class=
          "figure-title">An example of join deciding for
          gStore.</span>
        </div>
      </figure>
      <p><strong>Excecutor</strong>. The part of Excecutor provides
      SPARQL&nbsp;API to answer subqueries and then obtains all
      intermediate solutions by employing SPARQL engines.</p>
      <p><strong>GPU Computing</strong>. The module of GPU
      Computing provides a MapReduce-based Join algorithm utilizing
      GPU for parallel joining. Note that the tasks can be
      decomposed and assigned to several streams. In this way, the
      proposed algorithm can improve the performance of joining
      because the specified stream parallel processing of GPU is
      suitable for executing in the pipeline via MapReduce. For
      instance, the copy and executions of kernel are overlapped so
      that the time used is reduced as shown in Figure <a class=
      "fig" href="#fig3">3</a>.</p>
      <figure id="fig3">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186939/images/www18companion-179-fig3.jpg"
        class="img-responsive" alt="Figure 3" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 3:</span> <span class=
          "figure-title">An example of multi-stream
          overlapping.</span>
        </div>
      </figure>
    </section>
    <section id="sec-11">
      <header>
        <div class="title-info">
          <h2><span class="section-number">3</span> Experiments and
          Evaluations</h2>
        </div>
      </header>
      <p><strong>Hardware Setup</strong>. Our experiments are
      performed on a PC equipped with 64GB memory, 3.4GHz Intel
      CPU, a NVIDIA Tesla M40 GPU, which has 24GB device memory,
      288 GB/sec bandwidth and is clocked at 1.7Hz. The operating
      system is Ubuntu 14.04. We use MapSQ-3X and MapSQ-g by
      empolying RDF-3X&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0005">5</a>] and gStore&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0002">2</a>] within MapSQ.</p>
      <p><strong>Datasets</strong>. In the first experiment,
      LUBM400 (55.26 million triples, 6.71GB) to LUBM1600 (221.30
      million triples, 27.07GB) are used to compare the performance
      of RDF-3X and MapSQ-3X. Because of memory constraint for
      loading datasets in gStore, we omit the evaluation of gStore
      and MapSQ-g over LUBM. In the second experiment, YAGO (200.73
      million triples, 13.53GB) is used to evaluate the performance
      of gStore, MapSQ-g, RDF-3X, and MapSQ-3X.</p>
      <p><strong>Query Performance</strong>. We defines the SPARQL
      queries classified into four categories: linear (L), triangle
      (T), star (S), and snowflake (F) in our experiments. Figure
      <a class="fig" href="#fig4">4</a> shows the RDF3X performs
      better with MapSQ (speedup of T1 over LUBM1600 up to 32.42)
      and MapSQ makes it more scalable for larger LUBM datasets.
      Similarly, Figure <a class="fig" href="#fig5">5</a> shows the
      improvement provided by MapSQ over YAGO datasets. Especially
      the speedup of L1 is up to 33.01.</p>
      <figure id="fig4">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186939/images/www18companion-179-fig4.jpg"
        class="img-responsive" alt="Figure 4" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 4:</span> <span class=
          "figure-title">Query runtimes for LUBM datasets.</span>
        </div>
      </figure>
      <figure id="fig5">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186939/images/www18companion-179-fig5.jpg"
        class="img-responsive" alt="Figure 5" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 5:</span> <span class=
          "figure-title">Query runtimes for YAGO dataset.</span>
        </div>
      </figure>
    </section>
    <section id="sec-12">
      <header>
        <div class="title-info">
          <h2><span class="section-number">4</span>
          Conclusions</h2>
        </div>
      </header>
      <p>In this paper, we proposed a plugin-based framework to
      take advantage of high-preformance of GPUs for supporting
      large-scale RDF data querying in an efficient and simple way.
      We think that this proposal would provide an idea to process
      large-scale RDF data by employing new processing units such
      as GPU and FPGA.</p>
    </section>
    <section id="sec-13">
      <header>
        <div class="title-info">
          <h2>Acknowledgments</h2>
        </div>
      </header>
      <p>This work is supported by the National Key Research and
      Development Program of China (2016YFB1000603) and the
      National Natural Science Foundation of China
      (61672377,61502336).</p>
    </section>
  </section>
  <section class="back-matter">
    <section id="ref-001">
      <header>
        <div class="title-info">
          <h2 class="page-brake-head">REFERENCES</h2>
        </div>
      </header>
      <ul class="bibUl">
        <li id="BibPLXBIB0001" label="[1]">Abdelaziz&nbsp;I.,
        Harbi&nbsp;R., Khayyat&nbsp;Z., and Kalnis P.2017. A survey
        and experimental comparison of distributed SPARQL engines
        for very large RDF data. <em><em>PVLDB</em></em> . 10(13):
        2049–2060.</li>
        <li id="BibPLXBIB0002" label="[2]">Chen L., Zsu&nbsp;M.T.,
        Zou&nbsp;L., Mo&nbsp;J., and Zhao D.2011. gStore: Answering
        SPARQL queries via subgraph matching.
        <em><em>PVLDB</em></em> . 4(8):482–493.</li>
        <li id="BibPLXBIB0003" label="[3]">Guo Y., Liu W., Voss
        G.,and Mueller-Wittig W.2014. GCMR: A GPU cluster-based
        MapReduce framework for large-scale data processing. In
        <em><em>Proc. of HPCC &amp; EUC’14</em></em> .
        580–586.</li>
        <li id="BibPLXBIB0004" label="[4]">Kaldewey T., Lohman G.,
        and Mueller R.2012. GPU Join processing revisited. In
        <em><em>Proc. of EDBT’12</em></em> . pp.55–62.</li>
        <li id="BibPLXBIB0005" label="[5]">Weikum&nbsp;G. and
        Neumann&nbsp;T.2008. RDF-3X: A RISC-style engine for RDF.
        <em><em>PVLDB</em></em> . 1(1):647–659.</li>
      </ul>
    </section>
  </section>
  <section id="foot-001" class="footnote">
    <header>
      <div class="title-info">
        <h2>FOOTNOTE</h2>
      </div>
    </header>
    <div class="bibStrip">
      <p>This paper is published under the Creative Commons
      Attribution 4.0 International (CC-BY&nbsp;4.0) license.
      Authors reserve their rights to disseminate the work on their
      personal and corporate Web sites with the appropriate
      attribution.</p>
      <p><em>WWW '18, Companion, April 23–27, 2018, Lyon,
      France</em></p>
      <p>© 2018; IW3C2 (International World Wide Web Conference
      Committee), published under Creative Commons CC-BY&nbsp;4.0
      License. ACM ISBN 978-1-4503-5640-4/18/04.<br />
      DOI: <a class="link-inline force-break" target="_blank" href=
      "https://doi.org/10.1145/3184558.3186939">https://doi.org/10.1145/3184558.3186939</a></p>
    </div>
  </section>
  <div class="pubHistory">
    <p></p>
  </div>
</body>
</html>
