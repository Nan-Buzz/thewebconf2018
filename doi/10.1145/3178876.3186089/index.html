<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.16" />
  <title>Betrayed by Your Dashboard: Discovering Malicious
  Campaigns via Web Analytics</title>
  <!-- Copyright (c) 2010-2015 The MathJax Consortium -->
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8" />
  <meta name="viewport" content=
  "width=device-width; initial-scale=1.0;" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/bootstrap-theme.min.css" />
  <link media="screen, print" rel="stylesheet" href=
  "../../../data/dl.acm.org/pubs/lib/css/main.css" />
  <script src="../../../data/dl.acm.org/pubs/lib/js/jquery.min.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bootstrap.min.js"
  type="text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/bibCit.js" type=
  "text/javascript"></script>
  <script src="../../../data/dl.acm.org/pubs/lib/js/divTab.js" type=
  "text/javascript"></script>
  <script type="text/javascript" src=
  "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script>
  <script type="text/x-mathjax-config">
  <![CDATA[
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  ]]>
  </script>
</head>
<body id="main">
<div>
<p style='font-size: 75%; color #444'>
This is a web copy of <a href='https://doi.org/10.1145/3178876.3186089'>https://doi.org/10.1145/3178876.3186089</a> 
originally published by ACM Press, 
redistributed under the terms of 
<a href='https://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 (CC BY 4.0)</a>.
The <a href='https://github.com/usable-oa/thewebconf2018/tree/master/scripts'>modifications</a> 
from the original are solely to improve HTML aiming to make it Findable, Accessible, Interoperable and Reusable. 
augmenting HTML metadata and avoiding ACM trademark.
To reference this HTML version, use:
</p><p>
<strong>Permalink:</strong>
<a href='https://w3id.org/oa/10.1145/3178876.3186089'>https://w3id.org/oa/10.1145/3178876.3186089</a>
</p></div>
<hr>


  <section class="front-matter">
    <section>
      <header class="title-info">
        <div class="journal-title">
          <h1><span class="title">Betrayed by Your Dashboard:
          Discovering Malicious Campaigns via Web
          Analytics</span><br />
          <span class="subTitle"></span></h1>
        </div>
      </header>
      <div class="authorGroup">
        <div class="author">
          <span class="givenName">Oleksii</span> <span class=
          "surName">Starov</span>, Stony Brook University, <a href=
          "mailto:ostarov@cs.stonybrook.edu">ostarov@cs.stonybrook.edu</a>
        </div>
        <div class="author">
          <span class="givenName">Yuchen</span> <span class=
          "surName">Zhou</span>, Palo Alto Networks, Inc., <a href=
          "mailto:yzhou@paloaltonetworks.com">yzhou@paloaltonetworks.com</a>
        </div>
        <div class="author">
          <span class="givenName">Xiao</span> <span class=
          "surName">Zhang</span>, Palo Alto Networks, Inc.,
          <a href="mailto:xizhang@paloaltonetworks.com">xizhang@paloaltonetworks.com</a>
        </div>
        <div class="author">
          <span class="givenName">Najmeh</span> <span class=
          "surName">Miramirkhani</span>, Stony Brook University,
          <a href=
          "mailto:nmiramirkhani@cs.stonybrook.edu">nmiramirkhani@cs.stonybrook.edu</a>
        </div>
        <div class="author">
          <span class="givenName">Nick</span> <span class=
          "surName">Nikiforakis</span>, Stony Brook University,
          <a href=
          "mailto:nick@cs.stonybrook.edu">nick@cs.stonybrook.edu</a>
        </div>
      </div><br />
      <div class="pubInfo">
        <p>DOI: <a href="https://doi.org/10.1145/3178876.3186089"
        target=
        "_blank">https://doi.org/10.1145/3178876.3186089</a><br />
        WWW '18: <a href="https://doi.org/10.1145/3178876" target=
        "_blank">Proceedings of The Web Conference 2018</a>, Lyon,
        France, April 2018</p>
      </div>
      <div class="abstract">
        <p><small>To better understand the demographics of their
        visitors and their paths through their websites, the vast
        majority of modern website owners make use of third-party
        analytics platforms, such as, Google Analytics and
        ClickTale. Given that all the clients of a third-party
        analytics platform report to the same server, the tracking
        requests need to contain identifiers that allow the
        analytics server to differentiate between their
        clients.</small></p>
        <p><small>In this paper, we analyze the analytics
        identifiers utilized by eighteen different third-party
        analytics platforms and show that these identifiers enable
        the clustering of seemingly unrelated websites as part of a
        common third-party analytics account (i.e. websites whose
        analytics are managed by a single person or team). We focus
        our attention on malicious websites that also utilize
        third-party web analytics and show that threat analysts can
        utilize web analytics to both discover previously unknown
        malicious pages in a threat-agnostic fashion, as well as to
        cluster malicious websites into campaigns. We build a
        system for automatically identifying, isolating, and
        querying analytics identifiers from malicious pages and use
        it to discover an additional 11K live domains that use
        analytics associated with malicious pages. We show how our
        system can be used to improve the coverage of existing
        blacklists, discover previously unknown phishing campaigns,
        identify malicious binaries and Android apps, and even aid
        in attribution of malicious domains with protected WHOIS
        information.</small></p>
      </div>
      <div class="classifications">
        <div class="AcmReferenceFormat">
          <p><small><span style="font-weight:bold;">ACM Reference
          Format:</span><br />
          Oleksii Starov, Yuchen Zhou, Xiao Zhang, Najmeh
          Miramirkhani, and Nick Nikiforakis. 2018. Betrayed by
          Your Dashboard: Discovering Malicious Campaigns via Web
          Analytics. In <em>WWW 2018: The 2018 Web Conference,</em>
          <em>April 23–27, 2018,</em> <em>Lyon, France. ACM, New
          York, NY, USA</em> 11 Pages. <a href=
          "https://doi.org/10.1145/3178876.3186089" class=
          "link-inline force-break" target=
          "_blank">https://doi.org/10.1145/3178876.3186089</a></small></p>
        </div>
      </div>
    </section>
  </section>
  <section class="body">
    <section id="sec-6">
      <header>
        <div class="title-info">
          <h2><span class="section-number">1</span>
          Introduction</h2>
        </div>
      </header>
      <p>Web analytics is a necessary tool for modern websites to
      better understand their users and how they interact with
      their content. Most web developers make use of third-party
      analytics platforms, such as, Google Analytics, Yandex
      Metrica, and ClickTale, both because of their ease of
      adoption as well as the typical presence of
      no-cost/“freemium” plans. For instance, according to recent
      statistics from BuiltWith&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0002">2</a>], 77.8% of the web's 1 million most
      popular sites utilize Google Analytics.</p>
      <p>Given that all the clients of a third-party analytics
      platform report to the same centralized backend, the tracking
      requests emitted from web browsers need to contain
      identifiers that allow the analytics server to differentiate
      between their clients. A single identifier (referred to as
      <em>ID</em> throughout this paper) is often shared across
      different websites that belong to the same account, or to the
      same project in the analytics dashboard, thus effectively
      becoming a method of grouping websites together, even among
      domains that otherwise seem unrelated. As a result, there
      exist services for reverse lookups of Google Analytics IDs
      (e.g., SpyOnWeb&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0015">15</a>] and SameID&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0013">13</a>]) which are used, for
      example, by journalists to reveal hidden connections between
      websites&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0018">18</a>].</p>
      <p>In this paper, we analyze the analytics identifiers
      utilized by eighteen different third-party analytics
      platforms and show that these identifiers allow for the
      clustering of seemingly unrelated websites as part of a
      common third-party analytics account (i.e. websites whose
      analytics are managed by a single person or team). We use
      this observation to perform the first large-scale analysis of
      analytics utilized by malicious content and quantify the
      extent to which matching analytics IDs allows for the
      identification of new malicious content, the clustering of
      malicious content into campaigns, and even the
      deanonymization of malicious actors. To that extent, we
      design and develop a reliable pipeline for parsing sources of
      malicious content, identifying and extracting IDs associated
      with the studied analytics services, and searching for new
      malicious content that shares the extracted IDs in a
      <em>threat-agnostic fashion</em>, i.e., being able to
      identify malicious content without tailored, abuse-specific
      detection methods.</p>
      <p>We use our system to crawl 145K malicious URLs provided by
      VirusTotal on a daily basis for a period of two weeks and
      identify a total of 9,395 unique analytics IDs associated
      with malicious pages. Our system was able to, on average,
      discover 1,442 malicious analytics IDs per day, most of which
      belonging to Google Analytics. Moreover, we extracted 872
      analytics identifiers from a two-year corpus of technical
      support scams and other social-engineering attacks, allowing
      us to calculate the lifetime of some scam campaigns to more
      than two years. By searching for domains and URLs reusing the
      extracted IDs in the wild, we were able to discover 11K
      additional websites and showed how the sharing of analytic
      IDs can allow for the deanonymization of owners of domains,
      even when WHOIS privacy solutions are utilized. Next, we show
      how our analytics-ID-matching technique applies beyond
      regular websites (to malicious mobile apps, suspicious
      extensions, and malware binaries) and how we were able to
      utilize it to discover 13 phishing campaigns against popular
      websites. Finally, we explain why evading our detection
      methods will not be trivial for attackers as long as they
      find value in analytics, and we describe how analytics
      companies can utilize their privileged positions to assist in
      discovering malicious content and aid law-enforcement
      identify the real culprits behind attacks.</p>
    </section>
    <section id="sec-7">
      <header>
        <div class="title-info">
          <h2><span class="section-number">2</span> Background on
          Web analytics</h2>
        </div>
      </header>
      <figure id="fig1">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig1.jpg"
        class="img-responsive" alt="Figure 1" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 1:</span> <span class=
          "figure-title">Example of a scam page that calls Google
          Analytics.</span>
        </div>
      </figure>
      <p>For virtually all types of web analytics, web developers
      are asked by the analytics service to embed a piece of
      JavaScript code throughout their website. This JavaScript
      code includes logic for tracking user visits and at least one
      identifier (referred to as <em>ID</em> throughout the paper)
      that is used by the analytics platform to later differentiate
      between tracking requests of their clients. When visitors
      load one of the corresponding pages inside their browsers,
      the analytics script issues requests to the analytics backend
      which collects tracking data about the current visitor. The
      analytics services then aggregate the data and make them
      available through a convenient web dashboard which is made
      available to website owners.</p>
      <p>At this point, it is important to note that while the
      analytics IDs embedded in websites need to be
      per-analytics-client unique, they do not need to be
      per-domain unique. That is, website owners can manage
      multiple websites as part of a single <em>project</em> where,
      e.g., all the analytics requests for <a class=
      "link-inline force-break" href=
      "http://example.com">example.com</a>, <a class=
      "link-inline force-break" href=
      "http://example.net">example.net</a>, and <a class=
      "link-inline force-break" href=
      "http://example.org">example.org</a> are aggregated together.
      In this case, the JavaScript code embedded in all three
      websites would be utilizing the same analytics ID. This
      allows a third-party observer to infer that these three
      domains are somehow related (i.e. managed by the same
      person/team) even when the ID-sharing domains are lexically
      different, are hosted on different servers, and utilize WHOIS
      privacy solutions. Through our experiments, we have found
      that this type of aggregation is very common across both
      benign and malicious website owners and can therefore be used
      for clustering seemingly-unrelated websites together into
      campaigns.</p>
      <p>To gauge how well this ID-sharing observation generalizes
      across different analytics services, we analyze 18 popular
      services offering general web analytics (listed in
      Table&nbsp;<a class="tbl" href="#tab1">1</a> according to
      their popularity, as reported by BuiltWith&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0002">2</a>]). One can
      notice that the majority of services provide an option of
      no-cost subscription, which makes them even more attractive
      for website owners. Upon signup to any web analytics service,
      a web developer gets an ability to set up a project, which
      may or may not require to specify targeted domains. We want
      to emphasize that even if specific domains are specified in
      the analytics dashboard, traffic statistics are collected
      across different origins, and thus the analytics script can
      be distributed across different websites at the discretion of
      the web developer. In this case, the analytics request from
      each website contains the same project ID, which can be used
      to associate them. Moreover, even if the website owner
      creates a separate analytics project per each monitored
      domain, there are services that still require a separate
      <em>account identifier</em>, such as, Google Analytics.
      Specifically, each Google Analytics account can create up to
      100 identifiers of the following format <em>UA</em> −
      <em>XX</em>...<em>XX</em> − <em>YY</em>, where <em>UA</em> −
      <em>XX</em>...<em>XX</em> is the constant account ID.
      Similarly, tracking requests to New Relic Insight include a
      “global license key” which is common across all websites
      managed by a single account.</p>
      <div class="table-responsive" id="tab1">
        <div class="table-caption">
          <span class="table-number">Table 1:</span> <span class=
          "table-title">Comparison of popular web analytics</span>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th style="text-align:center;"><strong>Web
              analytics</strong></th>
              <th style="text-align:center;">
              <strong>Price</strong></th>
              <th style="text-align:center;"><strong>Leaked
              ID</strong></th>
              <th style="text-align:center;"><strong>Example
              ID</strong></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align:center;">Google Analytics</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">UA-22417551-1</td>
            </tr>
            <tr>
              <td style="text-align:center;">Google Tag
              Manager</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">GTM-N7R3KH</td>
            </tr>
            <tr>
              <td style="text-align:center;">New Relic Insight</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">9a40653a95</td>
            </tr>
            <tr>
              <td style="text-align:center;">Yandex Metrica</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">42880164</td>
            </tr>
            <tr>
              <td style="text-align:center;">Quantcast</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">p-b6_rD1Ba7gEIM</td>
            </tr>
            <tr>
              <td style="text-align:center;">StatCounter</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">
              7040321/0/9a83071e</td>
            </tr>
            <tr>
              <td style="text-align:center;">Optimizely</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">5328963582</td>
            </tr>
            <tr>
              <td style="text-align:center;">CrazyEgg</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">0023/6581</td>
            </tr>
            <tr>
              <td style="text-align:center;">Clicky</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">101071552</td>
            </tr>
            <tr>
              <td style="text-align:center;">Mixpanel</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">
              481d51295e...f5547</td>
            </tr>
            <tr>
              <td style="text-align:center;">Segment</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">6q5KVhqz...6DONr</td>
            </tr>
            <tr>
              <td style="text-align:center;">Mouseflow</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">
              ff5128b8-7...caba8</td>
            </tr>
            <tr>
              <td style="text-align:center;">Chartbeat</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">50874</td>
            </tr>
            <tr>
              <td style="text-align:center;">Heap Analytics</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">429571327</td>
            </tr>
            <tr>
              <td style="text-align:center;">Kissmetrics</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">
              e4756f9bee...c2dc3</td>
            </tr>
            <tr>
              <td style="text-align:center;">ClickTale</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Account</td>
              <td style="text-align:center;">
              6ea876d3-3...b4f00</td>
            </tr>
            <tr>
              <td style="text-align:center;">Gauges</td>
              <td style="text-align:center;">Paid</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">
              58caae4f4b...1c18a</td>
            </tr>
            <tr>
              <td style="text-align:center;">W3Counter</td>
              <td style="text-align:center;">Free</td>
              <td style="text-align:center;">Project</td>
              <td style="text-align:center;">63908</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>The exact format of each service's analytics ID influences
      the difficulty of correctly identifying other websites that
      share a given ID. For example, as shown in
      Table&nbsp;<a class="tbl" href="#tab1">1</a>, Yandex Metrica
      uses a highly ambiguous format consisting of a short string
      of digits. In order to find other websites using the same ID,
      we need to crawl as many websites as possible and either
      dynamically locate requests to Yandex backend servers as they
      are occurring, or statically attempt to locate Yandex-related
      JavaScript code which may be further complicated through the
      use of minimization and obfuscation.</p>
      <p>Contrastingly, ClickTale utilizes longer strings (e.g.,
      “6ea876 d3-3...f00”) while StatCounter uses a combination of
      the project ID and additional identifier (e.g.,
      “/7040321/0/9a83071e/1/”). In both cases, the resulting IDs
      are more likely to be globally unique, and thus can be
      searched with generic search engines that index the source
      code of web pages (such as, PublicWWW&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0011">11</a>] and
      NerdyData&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0005">5</a>]). Furthermore, the specific format of
      some analytics providers, such as, Google Analytics and
      Google Tag Manager, provide us with the ability to not only
      search for a specific ID, but to retrieve all the identifiers
      while statically analyzing a page's source code (e.g., all
      IDs of the format <em>GTM</em> − <em>XXXXXX</em>).</p>
      <p>Finally, it is worth pointing out that the aforementioned
      analytics services are not necessarily limited to websites.
      Browser extensions can straightforwardly utilize web
      analytics by including the appropriate JavaScript code in
      their background pages&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0033">33</a>] while Android APKs can include
      analytics SDKs that emit the appropriate HTTP requests that
      are recognized by the analytics backend servers. In addition
      to Google Analytics and Google Tag Manager which are
      available for both websites as well as Android apps, we
      analyzed the following mobile-specific, analytics services:
      FireBase, Appflyer, App Metrica, Flurry, Umeng, and Adjust.
      Google Analytics, FireBase, and Appflyer leak a global
      analytics account ID with each tracking request, whereas the
      remaining register unique application IDs for each separate
      app.</p>
    </section>
    <section id="sec-8">
      <header>
        <div class="title-info">
          <h2><span class="section-number">3</span> Data collection
          and analysis</h2>
        </div>
      </header>
      <p>In this section, we describe our pipeline for mining
      analytics IDs from different sources of malicious URLs,
      browser extensions, and mobile applications.</p>
      <section id="sec-9">
        <header>
          <div class="title-info">
            <h3><span class="section-number">3.1</span> Analytics
            IDs from malicious websites</h3>
          </div>
        </header>
        <figure id="fig2">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig2.jpg"
          class="img-responsive" alt="Figure 2" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 2:</span>
            <span class="figure-title">High-level view of our
            pipeline for mining analytics IDs from known malicious
            URLs (e.g., reported by third-party scanners) and
            potentially malicious URLs (e.g., typosquatting
            domains). Given these two sources, the system applies a
            sequence of domain filters and a set of content-based
            scam detection heuristics.</span>
          </div>
        </figure>
        <figure id="fig3">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig3.jpg"
          class="img-responsive" alt="Figure 3" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 3:</span>
            <span class="figure-title">Example of a malicious
            browser extension installed by more than 63K
            users.</span>
          </div>
        </figure>
        <p>For our project we utilize two sources of malicious
        URLs: i) daily lists of malicious URLs from VirusTotal and,
        ii) URLs and HTML code of typosquatting domains and the
        destination URLs of ad-based URL shorteners, kindly
        provided to us by Miramirkhani et al.&nbsp;[<a class="bib"
        data-trigger="hover" data-toggle="popover" data-placement=
        "top" href="#BibPLXBIB0028">28</a>]. Given these two
        sources, extracting analytics IDs from malicious websites
        appears, at first, straightforward. One would need to
        merely visit each URL, identify the presence of one or more
        analytics providers, and isolate the utilized analytics
        IDs. Unfortunately, the following reasons complicate this
        seemingly straightforward process:</p>
        <ul class="list-no-style">
          <li id="list1" label="•">When visiting a malicious URL
          some time after it was first reported, the resulting page
          may now be operated by a domain parking company with its
          own benign analytics.<br /></li>
          <li id="list2" label="•">When trusting third-party
          verdicts about the maliciousness of a given URL, it is
          unclear which part of the page was malicious, i.e., the
          main page versus a particular iframe embedded in the
          page. Malicious pages may include benign content and vice
          versa, both of which may be utilizing their own web
          analytics.<br /></li>
        </ul>
        <p>To account for these complications during the VirusTotal
        crawl, we deploy a set of filters, as shown in
        Figure&nbsp;<a class="fig" href="#fig2">2</a>. First, after
        crawling URLs from VirusTotal, we extract the pairs of
        valid analytics IDs and actual domain where they were found
        (i.e. the domain of the main page or that of an iframe). We
        then check whether that domain was malicious according to
        VirusTotal and discard those that are reported as benign,
        allowing us to remove many instances which would otherwise
        be false positives. Second, we filter out whitelisted
        domains and known benign analytics IDs from websites in the
        Alexa top 100K.</p>
        <p>During pilot experiments, we discovered that domains
        resulting from these two filtering steps still contained a
        large number of false positives. These false positives were
        mainly due to a few common analytics IDs that were present
        in large numbers of pages that are part of the lifecycle of
        a malicious URL but are not malicious in-and-of themselves.
        For example, the error pages shown by hosting providers
        when they have suspended a user's account (a common
        reaction to a malicious URL) may all share the same
        analytics ID. Thus, if we do not exclude these pages, we
        would be marking all domains that were suspended/deleted as
        malicious. To account for such cases, we utilize PublicWWW
        and SpyOnWeb (two search engines for HTML code) to find
        other domains with pages that utilize the same analytics ID
        and ignore a given ID if it is used by more pages than an
        empirically discovered threshold (500 domains according to
        our experiments). Our rationale for this threshold is that,
        if we discover more than 500 unpopular domains all of which
        share the same analytics ID and some of which are marked as
        malicious, we consider it more plausible that these are
        related to a known benign service rather that they are
        managed by a single dedicated attacker.</p>
        <p>Contrastingly, because Miramirkhani et
        al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
        "popover" data-placement="top" href=
        "#BibPLXBIB0028">28</a>] provide us with both HTML code as
        well as URLs, we can develop our own heuristics for
        identifying a malicious page and if those heuristics match
        a page that contains an analytics ID, we can immediately
        isolate and extract that ID. Given the nature of their
        project and data sources, we search through the HTML and JS
        corpus for keywords associated with technical support
        scams, toll-free phone numbers, and messages indicating
        that we need to download new software (e.g. missing
        codecs), or update our existing one (e.g. update Flash,
        Chrome, or Java).</p>
        <p>To faithfully mimic a user who lands on a malicious
        domain, our crawler is based on the headless Chrome
        Browser. Our crawler is capable of intercepting JavaScript
        alerts, simulate clicks, and extract analytics identifiers
        from both network traffic, as well as the page's HTML code
        and browser DOM. By running our crawler on multiple
        machines, we are able to crawl and analyze over 10 million
        domains per day. All network traffic and extracted
        analytics IDs are stored in database for further
        analysis.</p>
        <p>The statistics described in the remainder of the paper,
        are based on the following datasets:</p>
        <ul class="list-no-style">
          <li id="list3" label="•">Three daily sets of malicious
          URLs reported by VirusTotal (VT) in August 2017 and
          fourteen consecutive VT URL dumps from September 2017.
          Each set consists on average of 145K unique URLs
          belonging to 24.3K unique TLD+1 domains. For example,
          just for the September, we crawled more than two million
          URLs on 340,873 unique domains.<br /></li>
          <li id="list4" label="•">The domains from Miramirkhani et
          al.&nbsp;[<a class="bib" data-trigger="hover"
            data-toggle="popover" data-placement="top" href=
            "#BibPLXBIB0028">28</a>] include almost two years of
            crawling 10,000 typosquatting domains daily from
            September, 2015, and a set of 3,000 shortened URLs from
            top ad-based URL shorteners starting from April,
            2016.<br />
          </li>
        </ul>
        <p>Finally, we make use of a commercial URL filtering
        service belonging to Palo Alto Networks, a network and
        enterprise security company, which provides its customers
        with URL categories including: malware, phishing, adult,
        drugs, and weapons. Any given URL that is visited by a
        client of their firewall solution and is not part of their
        list, is placed into a separate UNKNOWN_URLs database. We
        make use of this database to evaluate the increased
        coverage that our threat-agnostic, analytics-ID-matching
        technique offers.</p>
      </section>
      <section id="sec-10">
        <header>
          <div class="title-info">
            <h3><span class="section-number">3.2</span> Analytics
            IDs from malware samples</h3>
          </div>
        </header>
        <p>Next to webpages utilizing analytics IDs, in this paper,
        we consider the following additional sources of analytics
        IDs, involved in suspicious/malicious campaigns.</p>
        <p><strong>Malicious browser extensions.</strong> While
        crawling our lists of URLs in order to extract their
        analytics IDs, we noticed that many resulting pages were
        trying to trick users into installing unwanted browser
        extensions. Figure&nbsp;<a class="fig" href="#fig3">3</a>
        shows an example of such a browser extension which claims
        to make a user's searches more private. Upon installation,
        these types of extensions typically request the permission
        to track a user's browsing history across tabs, to modify
        visited websites, and to access their cookies. Our system
        automatically downloads the offered extensions and unpacks
        them, in search of analytics-IDs utilized by the
        extensions’ authors. Skipping over extensions with more
        than 4 million active users (we experimentally chose that
        threshold to reduce false positives from web pages that
        redirected us to popular benign extensions) we were able to
        identify 315 extension URLs, 255 were available for
        download (we assume that the remaining ones were already
        detected as being abusive and removed from the Chrome
        store).</p>
        <p><strong>Malicious Android apps.</strong> For our study
        on mobile analytics we use a dataset of 796,304 Android
        APKs, which was kindly provided to us by Palo Alto
        Networks. These APKs are collected from a variety of
        sources (customer submissions, VirusTotal, Google Play
        Store) and 477,829 of them have received a “strong” malware
        verdict from the proprietary detection system developed by
        that company. These 796K APKs were collected from February
        till September 2017.</p>
        <p>Due to the large number of APKs and the potential to
        miss the analytics IDs from malfunctioning and evasive
        APKs, we identify the analytics IDs by inspecting the
        unpacked APKs. We found that, because most analytics
        platforms encourage developers to embed the analytics IDs
        in the metadata of their application, discovering these IDs
        from configuration files, like
        <tt>AndroidManifest.xml</tt>, was a straightforward
        process. Listing&nbsp;1 shows an example of how an app
        developer should include their analytics IDs when utilizing
        Google Analytics.</p>
        <p><strong>Listing 1: Google Analytics in
        AndroidManifest.xml</strong></p>
        <p><img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-img1.jpg"
        class="img-responsive" alt="" longdesc="" /></p>
        <p><strong>Other malware binaries.</strong> The final
        dataset originating from the Palo Alto Networks is a list
        of malware samples which, among others, send HTTP requests
        to Google Analytics. By analyzing this list and their
        requests, we discovered that 173,236 malware samples
        contained 4,162 Google Analytics IDs. To ensure that we
        filter out analytics IDs that are not necessarily malicious
        (e.g. a malware author cloning a benign application which
        includes a benign analytics ID), we focus on 2,912 IDs that
        are almost never seen in benign binary samples, i.e., found
        less than ten times, in a pool of hundreds of thousands of
        benign-labeled binaries.</p>
      </section>
    </section>
    <section id="sec-11">
      <header>
        <div class="title-info">
          <h2><span class="section-number">4</span> Analysis of
          results</h2>
        </div>
      </header>
      <p>In this section, we describe our analytics-IDs findings
      for each different source of malicious content.</p>
      <section id="sec-12">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.1</span> Analytics
            from malicious web pages</h3>
          </div>
        </header>
        <p><strong>Mining malicious analytics IDs.</strong> After
        crawling three daily sets of malicious URLs from VirusTotal
        in July-August 2017, and repeating the experiment for two
        weeks in the end of September 2017 we were able to extract
        9,395 analytics IDs associated with malicious content.
        Table&nbsp;<a class="tbl" href="#tab2">2</a> shows the
        distribution of these IDs across popular web analytics.
        First, we see that Google Analytics is as popular with
        attackers as it is with legitimate web developers (85% of
        all identifiers belonged to Google Analytics). Second, we
        observe that for a number of these services, there are more
        domains than unique IDs (e.g. 8,182 domains vs. 7,945 IDs
        for Google Analytics) which immediately points to the reuse
        of IDs across domains.</p>
        <p>Figure&nbsp;<a class="fig" href="#fig4">4</a> shows the
        detection rate of malicious analytics for each day of our
        experiment. On average, we were able to discover 1,442
        total IDs per day, 553 of which were not previously
        discovered (note that the figure is not a CDF since each
        day, a fraction of our previously discovered IDs, do not
        reappear in new crawls). As before, the recurrent reuse of
        analytics means that attackers are deploying the same
        analytics code, across multiple malicious pages.</p>
        <p>In contrast with the VirusTotal source, the data
        provided to us by Miramirkhani et al.&nbsp;[<a class="bib"
        data-trigger="hover" data-toggle="popover" data-placement=
        "top" href="#BibPLXBIB0028">28</a>] is by definition skewed
        towards social-engineering attacks, particularly of the
        fake technical support kind. From that data, we were able
        to extract 872 unique Google Analytics IDs across 3,185
        domain names. Most of these IDs (89.2%) were located on
        technical support scams while the remaining ones were on
        other types of scam pages, such as, fake surveys and fake
        plugin updates.</p>
        <p>Interestingly, while 51.8% of these analytics IDs were
        only observed for a single day, there were other IDs that
        belonged to long-running campaigns (overall, average
        lifetime was 46 days). For example, using a common Google
        Analytics ID, we observed a fake-survey campaign that was
        live for at least 764 days (UA-11040674 seen on 4 captured
        domains) and a separate fake Flash Player update / fake
        technical support campaign that was live for at least 730
        days (UA-67441257 seen on 44 captured domains). The fact
        that these campaigns lasted for over two years, suggests
        not only that these attackers are able to avoid detection
        for prolonged period of time but also that our proposed
        method of utilizing analytics IDs to discover campaigns of
        seemingly unrelated URLs is currently not utilized.</p>
        <div class="table-responsive" id="tab2">
          <div class="table-caption">
            <span class="table-number">Table 2:</span> <span class=
            "table-title">Mining malicious analytics IDs</span>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th style="text-align:left;"><strong>Web
                analytics</strong></th>
                <th style="text-align:center;">
                <strong>IDs</strong></th>
                <th style="text-align:center;">
                <strong>Domains</strong></th>
                <th style="text-align:center;">
                <strong>Potential</strong></th>
                <th style="text-align:center;">
                <strong>Verified</strong></th>
                <th style="text-align:center;">
                <strong>Unseen</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:left;">Google Analytics</td>
                <td style="text-align:center;">7,945</td>
                <td style="text-align:center;">8,182</td>
                <td style="text-align:center;">27,472</td>
                <td style="text-align:center;">10,901</td>
                <td style="text-align:center;">8,132</td>
              </tr>
              <tr>
                <td style="text-align:left;">Yandex</td>
                <td style="text-align:center;">816</td>
                <td style="text-align:center;">912</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">1,364</td>
                <td style="text-align:center;">971</td>
              </tr>
              <tr>
                <td style="text-align:left;">Google Tag
                Manager</td>
                <td style="text-align:center;">278</td>
                <td style="text-align:center;">289</td>
                <td style="text-align:center;">1,598</td>
                <td style="text-align:center;">683</td>
                <td style="text-align:center;">564</td>
              </tr>
              <tr>
                <td style="text-align:left;">StatCounter</td>
                <td style="text-align:center;">155</td>
                <td style="text-align:center;">144</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">22</td>
                <td style="text-align:center;">20</td>
              </tr>
              <tr>
                <td style="text-align:left;">Clicky</td>
                <td style="text-align:center;">58</td>
                <td style="text-align:center;">68</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">113</td>
                <td style="text-align:center;">83</td>
              </tr>
              <tr>
                <td style="text-align:left;">New Relic
                Insights</td>
                <td style="text-align:center;">55</td>
                <td style="text-align:center;">107</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">803</td>
                <td style="text-align:center;">779</td>
              </tr>
              <tr>
                <td style="text-align:left;">Quantcast</td>
                <td style="text-align:center;">46</td>
                <td style="text-align:center;">56</td>
                <td style="text-align:center;">336</td>
                <td style="text-align:center;">113</td>
                <td style="text-align:center;">101</td>
              </tr>
              <tr>
                <td style="text-align:left;">CrazyEgg</td>
                <td style="text-align:center;">13</td>
                <td style="text-align:center;">17</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">0</td>
              </tr>
              <tr>
                <td style="text-align:left;">Optimizely</td>
                <td style="text-align:center;">11</td>
                <td style="text-align:center;">12</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">4</td>
                <td style="text-align:center;">2</td>
              </tr>
              <tr>
                <td style="text-align:left;">MouseFlow</td>
                <td style="text-align:center;">9</td>
                <td style="text-align:center;">9</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">4</td>
                <td style="text-align:center;">1</td>
              </tr>
              <tr>
                <td style="text-align:left;">Mixpanel</td>
                <td style="text-align:center;">5</td>
                <td style="text-align:center;">5</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">272</td>
                <td style="text-align:center;">272</td>
              </tr>
              <tr>
                <td style="text-align:left;">Segment</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">0</td>
              </tr>
              <tr>
                <td style="text-align:left;">ClickTale</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">0</td>
              </tr>
              <tr>
                <td style="text-align:left;">Heap Analytics</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">0</td>
              </tr>
              <tr>
                <td style="text-align:left;">
                <strong>Overall</strong></td>
                <td style="text-align:center;">9,395</td>
                <td style="text-align:center;">9,226</td>
                <td style="text-align:center;">-</td>
                <td style="text-align:center;">14,267</td>
                <td style="text-align:center;">10,921</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p><strong>Discovering malicious web campaigns.</strong>
        Having a set of analytics IDs associated with malicious
        websites allows us to search for the same IDs in the wild
        and discover previously-unreported malicious websites.
        Using two code search engines (PublicWWW and SpyOnWeb), we
        were able to find other known domains for more than 63% of
        the 9,395 malicious analytics IDs discovered from our VT
        crawls. Table&nbsp;<a class="tbl" href="#tab2">2</a> shows
        how many potentially-malicious domains we discovered, and
        how many of them were verified with our own crawlers to
        still have the matched analytics IDs. We restrict the
        potential results to analytics providers with sufficiently
        distinct ID formats (described in Section&nbsp;<a class=
        "sec" href="#sec-7">2</a>) to ensure that we are really
        discovering analytics-related identifiers.</p>
        <p>Overall, we were able to discover 14,267 live websites
        containing malicious analytic IDs, 76.5% of which were new,
        previously unseen domains, i.e., not part of our VT-sourced
        URLs. As Table&nbsp;<a class="tbl" href="#tab2">2</a>
        shows, for many analytics providers, we are able to at
        least <em>double</em> the number of known live malicious
        domains from our VT seeds (e.g, we discovered another 8,132
        Google analytics domains reusing analytics IDs from the
        original 8,182 domains), and presumably can at least
        <em>triple</em> the number if we include potentially or
        formerly malicious websites (e.g. 27K Google analytics
        domains for the original 8.1K domains). Moreover, by
        querying VT about our newly-discovered domains, we find
        that the vast majority of new websites have successfully
        avoided detection, i.e., only 18.9% of the newly discovered
        websites are marked as malicious. We argue that this shows
        the power of this technique since it can associate
        seemingly benign websites to the same adversaries operating
        the more explicitly malicious ones.</p>
        <figure id="fig4">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig4.jpg"
          class="img-responsive" alt="Figure 4" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 4:</span>
            <span class="figure-title">Discovery rate of malicious
            analytics IDs during the daily crawl of VirusTotal
            feed.</span>
          </div>
        </figure>
        <figure id="fig5">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig5.jpg"
          class="img-responsive" alt="Figure 5" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 5:</span>
            <span class="figure-title">Discovery rate of malicious
            Google Analytics domains during the daily crawl of
            VirusTotal feed.</span>
          </div>
        </figure>
        <p></p>
        <p>Figure&nbsp;<a class="fig" href="#fig5">5</a> shows the
        daily rate on the number of newly discovered domains
        reusing malicious Google Analytics IDs. We observe the same
        peak on 10/02 as we did in the daily number of VT-sourced
        malicious IDs (Figure&nbsp;<a class="fig" href=
        "#fig4">4</a>). Using this approach one can expect to, on
        average, be able to associate 364 new, previously unseen,
        malicious domains per day, which share analytics IDs with
        existing malicious domains (considering results starting
        from 09/27). Similarly, we were able to identify 2,926
        other domains (with 2,821 being newly discovered) for 33.6%
        of the 872 scam-related Google Analytics IDs. Out of those,
        836 were still active at the time of this writing with 95%
        of them being flagged as malicious by VirusTotal scanners.
        Many examples like <a class="link-inline force-break" href=
        "http://error01234567890microsoft.xyz">error01234567890microsoft.xyz</a>
        (combosquatting domain&nbsp;[<a class="bib" data-trigger=
        "hover" data-toggle="popover" data-placement="top" href=
        "#BibPLXBIB0026">26</a>] utilized for technical support
        scams) or <a class="link-inline force-break" href=
        "http://search-privacy.online">search-privacy.online</a>
        (potentially unwanted programs) were discovered to be
        threats by matching Google Analytics.</p>
        <figure id="fig6">
          <img src=
          "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig6.jpg"
          class="img-responsive" alt="Figure 6" longdesc="" />
          <div class="figure-caption">
            <span class="figure-number">Figure 6:</span>
            <span class="figure-title">Example of “unknown” website
            detected via UA-81239183. Each click navigates to a
            different scam page.</span>
          </div>
        </figure>
        <p></p>
        <div class="table-responsive" id="tab3">
          <div class="table-caption">
            <span class="table-number">Table 3:</span> <span class=
            "table-title">Intersection with “unknown”
            websites</span>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th style="text-align:center;"><strong>Web
                analytics</strong></th>
                <th style="text-align:center;"><strong>#
                IDs</strong></th>
                <th style="text-align:center;"><strong>#
                Domains</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:center;">Google
                Analytics</td>
                <td style="text-align:center;">122</td>
                <td style="text-align:center;">774</td>
              </tr>
              <tr>
                <td style="text-align:center;">Yandex</td>
                <td style="text-align:center;">16</td>
                <td style="text-align:center;">671</td>
              </tr>
              <tr>
                <td style="text-align:center;">Google Tag
                Manager</td>
                <td style="text-align:center;">7</td>
                <td style="text-align:center;">108</td>
              </tr>
              <tr>
                <td style="text-align:center;">New Reli
                cInsights</td>
                <td style="text-align:center;">5</td>
                <td style="text-align:center;">26</td>
              </tr>
              <tr>
                <td style="text-align:center;">Clicky</td>
                <td style="text-align:center;">4</td>
                <td style="text-align:center;">3</td>
              </tr>
              <tr>
                <td style="text-align:center;">Optimizely</td>
                <td style="text-align:center;">3</td>
                <td style="text-align:center;">79</td>
              </tr>
              <tr>
                <td style="text-align:center;">CrazyEgg</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;">28</td>
              </tr>
              <tr>
                <td style="text-align:center;">MouseFlow</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">72</td>
              </tr>
              <tr>
                <td style="text-align:center;">Mixpanel</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">25</td>
              </tr>
              <tr>
                <td style="text-align:center;">Quantcast</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">1</td>
              </tr>
              <tr>
                <td style="text-align:center;">Overall</td>
                <td style="text-align:center;">162</td>
                <td style="text-align:center;">1785</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p><strong>Domain and Campaign Forensics.</strong> The
        ability to, given a list of malicious analytics IDs,
        identify other websites sharing these IDs, allows for a
        number of powerful forensic applications including: i)
        estimating the size of malicious campaigns, ii) identifying
        common attackers behind diverse attacks, and iii)
        deanonymizing malicious actors. In terms of campaign-size,
        using the VT-sourced URLs, we were able to find an average
        campaign size of 7.6 domains, with the largest campaign
        including 480 domains (note that this is a lower bound on
        the largest size as we decided to cut-off analytics IDs
        with more than 500 discovered domains as those may include
        false-positives). Similarly, for the scam-related dataset,
        the average campaign size was 3.6 with the largest campaign
        including 293 domains. By analyzing some of the
        scam-related data we were able to identify one New Relic
        Analytics ID (“bfd2c38d50”) which was associated with both
        technical support scams as well as phishing domains. This
        finding suggests either that one attacker/team is
        responsible for a wide-range of attacks, or that they have
        outsourced their analytics to the same entity. In both
        cases, this identified “link” can be powerful for both
        expedient take-downs as well as for identifying the
        culprits by law-enforcement.</p>
        <p>Finally, we were able to deanonymize 59 malicious actors
        behind VirusTotal URLs by finding public WHOIS records for
        other domains sharing the same analytics IDs. This means
        that as long as an, otherwise careful attacker who uses
        WHOIS privacy and fake registration details, links at least
        one onymous domain to the same analytics account, this can
        be used to link all of the anonymously-registered domains
        back to him. For example, Google Analytics ID UA-58907283
        was originally found on <a class="link-inline force-break"
        href=
        "http://verification-login.com">verification-login.com</a>
        from VirusTotal, and later was discovered on many phishing
        pages for Instagram. The same analytics ID was present on
        <a class="link-inline force-break" href=
        "http://ccg.gal">ccg.gal</a> which had public WHOIS
        information, including the registrant's email address.
        Other examples include deanonymization of suspicious online
        shops and web pages that distribute suspicious
        software.</p>
        <p><strong>Preventing unknown attacks.</strong> To further
        evaluate our threat-agnostic, analytics-ID-matching, method
        of finding and correlating malicious websites, we extracted
        the analytics IDs from the UNKNOWN_URLs dataset (the list
        of URLs whose categorization was unknown, as described in
        Section&nbsp;<a class="sec" href="#sec-9">3.1</a>) and
        calculated the overlap with our 9,395 malicious analytics
        IDs. Table&nbsp;<a class="tbl" href="#tab3">3</a> shows the
        number of overlapping IDs across services and the number of
        previously unlabeled domains that we could associate with
        known malicious URLs. Figure&nbsp;<a class="fig" href=
        "#fig6">6</a> shows an example of “unknown” website matched
        via UA-81239183, a Google Analytics from another website
        known to be malicious by 5 reputable scanners from
        VirusTotal. Each click on that website navigates the user
        to a different scam page. Other examples include
        UA-89467400 found on over 63 “unknown” websites, each
        leading to a different scam (like <a class=
        "link-inline force-break" href=
        "http://harbiturk.xyz">harbiturk.xyz</a> or <a class=
        "link-inline force-break" href=
        "http://digiz.xyz">digiz.xyz</a>).</p>
        <p><strong>Intersection between web and malware.</strong>
        Knowing that more than 173K malware samples send requests
        to Google Analytics (Section&nbsp;<a class="sec" href=
        "#sec-10">3.2</a>), we decided to quantify the possible
        overlap between the malware IDs and those of malicious
        websites. Specifically, we calculated the intersection of
        7,945 Google Analytics IDs collected from our VirusTotal
        crawl and the 872 IDs found on scam pages, with the ones
        present in the HTTP traffic dumps of malicious APKs and
        malware binaries for different OS. Overall, 29 matched in
        former case, and 35 in the later. Table&nbsp;<a class="tbl"
        href="#tab4">4</a> presents the most popular of the common
        IDs.</p>
        <div class="table-responsive" id="tab4">
          <div class="table-caption">
            <span class="table-number">Table 4:</span> <span class=
            "table-title">Querying benign and malicious
            samples</span>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th style="text-align:center;"><strong>Google
                Analytics</strong></th>
                <th style="text-align:center;"><strong>#
                Benign</strong></th>
                <th style="text-align:center;"><strong>#
                Malware</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:center;">3cTop IDs from
                VirusTotal URLs</td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-43126514</td>
                <td style="text-align:center;">137</td>
                <td style="text-align:center;">23,333</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-69254683</td>
                <td style="text-align:center;">3</td>
                <td style="text-align:center;">605</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-74694740</td>
                <td style="text-align:center;">22</td>
                <td style="text-align:center;">541</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-260627</td>
                <td style="text-align:center;">52</td>
                <td style="text-align:center;">520</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-63404602</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">204</td>
              </tr>
              <tr>
                <td colspan="3" style="text-align:center;">
                  Top IDs from scam pages
                  <hr />
                </td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-56634126</td>
                <td style="text-align:center;">19</td>
                <td style="text-align:center;">8,609</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-41451094</td>
                <td style="text-align:center;">16</td>
                <td style="text-align:center;">892</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-72722497</td>
                <td style="text-align:center;">272</td>
                <td style="text-align:center;">37</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-82355406</td>
                <td style="text-align:center;">166</td>
                <td style="text-align:center;">26</td>
              </tr>
              <tr>
                <td style="text-align:center;">UA-61108112</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">21</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>For example, UA-43126514 is found in the traffic of
        23,333 malware samples. The most recent public sample on
        VirusTotal is detected as “SoftPulse” by 53 out of 64 AV
        engines. This type of malware exhibits dropper behavior
        (downloading additional malicious software) and modifying
        registry entries. The same analytics ID is found on many
        domains that deliver PUPs in the form of video players
        (e.g. <a class="link-inline force-break" href=
        "http://vidplayer.net">vidplayer.net</a> and <a class=
        "link-inline force-break" href=
        "http://magnoplayer.com">magnoplayer.com</a>). Similarly,
        UA-56634126 with 8,609 matches in traffic from malware
        binaries has been spotted on domains that distribute
        suspicious versions of MacKeeper and other tools to repair
        Mac computers.</p>
        <p>To better understand the overlap between benign and
        malicious IDs, we randomly sampled a few of the 137 benign
        binaries with the UA-43126514 ID and resubmitted them to
        VirusTotal. There, we saw that most of them were now
        detected as malware by at least 15 AV engines. This result
        further strengthens the idea that matching analytics IDs
        can reveal the true malicious nature of a seemingly benign
        binary, before that binary is eventually detected as
        malware by traditional AV engines.</p>
      </section>
      <section id="sec-13">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.2</span> Analytics
            from browser extensions</h3>
          </div>
        </header>
        <p>During our crawl of potential scam pages, we were able
        to collect 333 unique extension IDs. During the manual
        investigation of some of these extensions, we noticed that
        some of them were benign, highly popular extensions and
        therefore, as described in Section&nbsp;<a class="sec"
        href="#sec-10">3.2</a>, we filtered out all extensions that
        were installed by more than 4 million users.</p>
        <p>Our filtered list contained 315 extensions served over
        11,096 unique URLs hosted on 86 unique TLD<em>+</em>1
        domains. Table&nbsp;<a class="tbl" href="#tab5">5</a> shows
        a number of these extensions to allow the reader to develop
        an intuition of the types of malicious extensions that are
        offered to users. Across different rankings, we observe
        extensions which are detected as Potentially Unwanted
        Programs (PUPs) according to different AV sources (e.g.,
        “safe4search” extension with 5,742 users&nbsp;[<a class=
        "bib" data-trigger="hover" data-toggle="popover"
        data-placement="top" href="#BibPLXBIB0004">4</a>] and
        “BlpSearch” extensions with 332,610 users&nbsp;[<a class=
        "bib" data-trigger="hover" data-toggle="popover"
        data-placement="top" href="#BibPLXBIB0001">1</a>]). At the
        time of our analysis we were able to download only 255
        extensions, while the remaining ones were no longer hosted
        on the Chrome Store. Almost half of the collected
        suspicious extensions (43.5%) belong to the “Search”
        category which allows them a reasonable cover for
        requesting full permissions across all tabs and websites of
        a user's browser.</p>
        <div class="table-responsive" id="tab5">
          <div class="table-caption">
            <span class="table-number">Table 5:</span> <span class=
            "table-title">Extensions found over intrusive install
            pages</span>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th style="text-align:center;"><strong>#
                Users</strong></th>
                <th style="text-align:center;"><strong>#
                Extensions</strong></th>
                <th style="text-align:center;">
                <strong>Example</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:center;">1-4MM</td>
                <td style="text-align:center;">29</td>
                <td style="text-align:center;">Search Manager
                (searchmgr.com)</td>
              </tr>
              <tr>
                <td style="text-align:center;">100K-1MM</td>
                <td style="text-align:center;">88</td>
                <td style="text-align:center;">Movie Search
                (softorama.com)</td>
              </tr>
              <tr>
                <td style="text-align:center;">10K-100K</td>
                <td style="text-align:center;">91</td>
                <td style="text-align:center;">betterMovies
                Search</td>
              </tr>
              <tr>
                <td style="text-align:center;">
                (bettersearchtools.com)</td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td style="text-align:center;">0-10K</td>
                <td style="text-align:center;">29</td>
                <td style="text-align:center;">LastLogin Now
                (lastlog.in)</td>
              </tr>
              <tr>
                <td style="text-align:center;">Unknown</td>
                <td style="text-align:center;">78</td>
                <td style="text-align:center;">Private Search
                Plus</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>Out of 255 extensions that we could successfully
        download and unpack, we found Google Analytics IDs on 120
        extensions. Overall, we detected 70 unique Google Analytics
        accounts which is already evidence of ID sharing across
        extensions. For example, UA-98374100 is utilized in 14
        different Chrome extensions, with installation base ranging
        from 10K to 162K active users, all developed by a developer
        called “Better Search Tools.” In other cases, we can
        associate two different extension developers, such as in
        the case of UA-48154225 used by SearchAssist Tools from
        searchassist.net (4,221 users) and similarly named
        extension from privacyassistant.net (4,636 users). By
        attempting to revisit these extensions two weeks later
        after our initial crawl, we noticed that both had been
        deleted from the Chrome Store.</p>
        <p>Using the two aforementioned code search engines
        (PublicWWW and SpyOnWeb) we searched for these 70
        extension-originating analytics IDs and found 264 websites
        which utilized one of these IDs. Among others, we found
        that UA-101669006 is used on <a class=
        "link-inline force-break" href=
        "http://medianetnow.com">medianetnow.com</a> (associated
        with the developer of a specific suspicious extension) and
        on a set of domains that follow the <a class=
        "link-inline force-break" href=
        "http://nextlnkN.com">nextlnkN.com</a> format, where N can
        be substituted with different integers and redirect users
        to a page requesting the installation of an extension. Our
        VirusTotal feed exhibits similar results with an average of
        54 unique extensions discovered per day, half of which also
        belong to the “Search” category.</p>
        <div class="table-responsive" id="tab6">
          <div class="table-caption">
            <span class="table-number">Table 6:</span> <span class=
            "table-title">Analytics in malware Android APKs</span>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th style="text-align:center;">
                <strong>Analytics</strong></th>
                <th style="text-align:center;"><strong>#
                IDs</strong></th>
                <th style="text-align:center;"><strong>#
                Hits</strong></th>
                <th style="text-align:center;"><strong>Non
                Mal.</strong></th>
                <th style="text-align:center;">
                <strong>Benign</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:center;">App Metrica</td>
                <td style="text-align:center;">12,622</td>
                <td style="text-align:center;">13,445</td>
                <td style="text-align:center;">32.9%</td>
                <td style="text-align:center;">2.4%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Umeng</td>
                <td style="text-align:center;">5,196</td>
                <td style="text-align:center;">92,442</td>
                <td style="text-align:center;">9.6%</td>
                <td style="text-align:center;">0.3%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Google
                Analytics</td>
                <td style="text-align:center;">551</td>
                <td style="text-align:center;">379</td>
                <td style="text-align:center;">22.7%</td>
                <td style="text-align:center;">10.6%</td>
              </tr>
              <tr>
                <td style="text-align:center;">FireBase</td>
                <td style="text-align:center;">350</td>
                <td style="text-align:center;">136</td>
                <td style="text-align:center;">55.9%</td>
                <td style="text-align:center;">32.4%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Localytics</td>
                <td style="text-align:center;">9</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">100.0%</td>
                <td style="text-align:center;">0.0%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Google Tag
                Manager</td>
                <td style="text-align:center;">3</td>
                <td style="text-align:center;">0</td>
                <td style="text-align:center;">0.0%</td>
                <td style="text-align:center;">0.0%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Flurry</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">0.0%</td>
                <td style="text-align:center;">100.0%</td>
              </tr>
              <tr>
                <td style="text-align:center;">AppsFlyer</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;">0.0%</td>
                <td style="text-align:center;">0.0%</td>
              </tr>
              <tr>
                <td style="text-align:center;">Overall</td>
                <td style="text-align:center;">18,734</td>
                <td style="text-align:center;">100,379</td>
                <td style="text-align:center;">9.7%</td>
                <td style="text-align:center;">0.2%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
      <section id="sec-14">
        <header>
          <div class="title-info">
            <h3><span class="section-number">4.3</span> Analytics
            from malicious Android apps</h3>
          </div>
        </header>
        <p>Overall, from 477,829 malicious APKs, we retrieved
        18,734 unique analytics identifiers over 273,232 samples.
        For example, the Google Analytics ID UA-77544562 is present
        on 8 malware APKs, labeled as
        <tt>Android.Trojan.Dropper</tt>. Table&nbsp;<a class="tbl"
        href="#tab6">6</a> shows the distribution of
        malware-related IDs across popular mobile analytics.
        Compared to web analytics, Google Analytics is not the most
        popular choice among malicious actors, taking the third
        place after by App Metrica and Umeng.</p>
        <p>Separately, we tested the detection possibilities
        enabled by our threat-agnostic, analytics-matching scheme.
        For that, we collected a testing sample of 330,117 newer
        APKs from late September 2017. By matching analytics IDs
        found on previous malicious samples, 100,379 unique APKs
        were flagged as malware. Of them, 9,775 were classified by
        Palo Alto Networks’ systems as not malicious, however, with
        9,332 marked as gray, 289 as unknown, and only 154 received
        the stronger “benign” verdict. This means that our system
        can complement existing static/dynamic-analysis malware
        classifiers and assist in reducing potential false
        negatives (gray and unknown samples) with low rate of newly
        introduced false positives (benign samples).
        Table&nbsp;<a class="tbl" href="#tab6">6</a> shows the
        classification results for all mobile analytics. Among
        others, we find that Umeng analytics IDs helped to detect
        the largest fraction of malicious Android apps.</p>
        <p>An interesting case was the Google Analytics ID
        UA-2126908, which was found among many malware APKs, and
        also on 12 websites related to distribution of cracked
        mobile apps (like <a class="link-inline force-break" href=
        "http://iphonecake.com">iphonecake.com</a> or <a class=
        "link-inline force-break" href=
        "http://directapk.net">directapk.net</a>).</p>
      </section>
    </section>
    <section id="sec-15">
      <header>
        <div class="title-info">
          <h2><span class="section-number">5</span> Detecting
          phishing websites</h2>
        </div>
      </header>
      <p>In this section, we present separate results for phishing
      and how analytics-ID matching can assist in the quick
      identification of phishing websites. While crawling URLs from
      our VirusTotal feeds, we noticed many cases of phishing
      websites, such as the ones targeting PayPal and LinkedIn
      users. We were surprised to discover that these types of
      phishing websites often include the benign analytics IDs of
      their victim websites and were therefore initially
      whitelisted by our approach of filtering out websites that
      utilize analytics IDs present in popular Alexa websites. By
      investigating the rest of their source code we came to the
      conclusion that the reason why these phishing websites reuse
      the benign analytics IDs of their victims is because the
      software that is used to clone the benign websites, does not
      remove/substitute the analytics code. Popular phishing
      frameworks like Social Engineering Toolkit
      (SET)&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0014">14</a>]
      and Gophish&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0006">6</a>] make cloning websites a streamlined
      process yet they do not account for analytics code.</p>
      <figure id="fig7">
        <img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig7.jpg"
        class="img-responsive" alt="Figure 7" longdesc="" />
        <div class="figure-caption">
          <span class="figure-number">Figure 7:</span> <span class=
          "figure-title">Example of a phishing website that
          includes original benign analytics ID from Airbnb.</span>
        </div>
      </figure>
      <p></p>
      <p></p>
      <figure id="fig8">
        <div class="figure-caption">
          <span class="figure-number">Algorithm 1</span>
          <span class="figure-title">Pseudocode for detecting
          phishing websites</span>
        </div><img src=
        "../../../data/deliveryimages.acm.org/10.1145/3190000/3186089/images/www2018-98-fig8.svg"
        class="img-responsive" alt="Figure 8" longdesc="" />
      </figure>
      <p></p>
      <p>We can therefore take advantage of this behavior to
      identify phishing websites by matching the analytics IDs
      present in unlabeled websites with those of popular websites
      that are often targeted for phishing.
      Algorithm&nbsp;<a class="fig" href="#fig8">1</a> shows the
      high-level steps involved in our approach. We start by
      monitoring the daily lists of phishing websites from the
      OpenPhish project&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0008">8</a>] which allows us to identify the
      websites most commonly targeted. We amplify that list by
      manually adding labels wherever they were missing and adding
      social networking websites and booking websites to the lists
      of potential victims. Given our final list of 270 potential
      targets, we can automatically crawl the benign websites,
      extract the benign analytics ID associated with each website,
      and then search for the presence of these IDs in our sources
      of malicious URLs.</p>
      <p>Next, we use additional filters to automatically remove
      potential false positives. For example, we select only cases
      with downgraded TLDs (e.g., if the original target is a
      ”.com” website, we match other analytics-ID-sharing websites
      hosted on ”.xyz”, ”.online”, or on a raw IP address). We also
      filter out popular domains, i.e., ones that appear in Alexa's
      top 100K, as those that are sharing IDs are most likely
      managed by the same entities. While false positives do
      remain, these can be further filtered-out by investigating
      the IP address space and Autonomous System on which the
      suspicious website is hosted. We argue, however, that each
      and every one of these matches is suspicious enough to
      warrant the attention of a human analyst.</p>
      <p>After applying Algorithm&nbsp;<a class="fig" href=
      "#fig8">1</a> to the two-week collection of “unknown”
      websites (UNKNOWN_URLs dataset, described in
      Section&nbsp;<a class="sec" href="#sec-9">3.1</a>), we could
      identify 13 phishing campaigns (e.g., Figure&nbsp;<a class=
      "fig" href="#fig7">7</a>). Table&nbsp;<a class="tbl" href=
      "#tab7">7</a> lists the discovered phishing targets,
      associated web analytics, and the number of unique domains
      used to distribute the phishing attacks. We recorded attacks
      on the Battle.net gaming portal, Airbnb booking platform,
      email services, and bank accounts. Usually the attackers used
      phishing replicas hosted on .xyz, .club, .online domains or
      links including IP addresses. We also found examples of .com
      and .ru TLDs to be gateways leading to the final phishing
      pages, and, interestingly, a replica of the IRS website was
      found on a .ru domain.</p>
      <div class="table-responsive" id="tab7">
        <div class="table-caption">
          <span class="table-number">Table 7:</span> <span class=
          "table-title">Phishing campaigns detected during
          study</span>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th style="text-align:center;"><strong>Target
              domain</strong></th>
              <th style="text-align:center;"><strong>Web
              analytics</strong></th>
              <th style="text-align:center;"><strong>#
              Domains</strong></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align:center;">us.battle.net</td>
              <td style="text-align:center;">GA</td>
              <td style="text-align:center;">12</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.airbnb.com</td>
              <td style="text-align:center;">GA, GTM</td>
              <td style="text-align:center;">10</td>
            </tr>
            <tr>
              <td style="text-align:center;">dailymail.co.uk</td>
              <td style="text-align:center;">GA</td>
              <td style="text-align:center;">4</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.flixster.com</td>
              <td style="text-align:center;">GA, Quantcast</td>
              <td style="text-align:center;">4</td>
            </tr>
            <tr>
              <td style="text-align:center;">
              serasaexperian.com.br</td>
              <td style="text-align:center;">GA, GTM</td>
              <td style="text-align:center;">2</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.hotwire.com</td>
              <td style="text-align:center;">GTM, Optimizely</td>
              <td style="text-align:center;">2</td>
            </tr>
            <tr>
              <td style="text-align:center;">lonelyplanet.com</td>
              <td style="text-align:center;">GA, GTM</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">made-in-china.com</td>
              <td style="text-align:center;">GA</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">
              metrobankonline.co.uk</td>
              <td style="text-align:center;">GA, GTM</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">microsoft.com</td>
              <td style="text-align:center;">Optimizely</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.bnz.co.nz</td>
              <td style="text-align:center;">GA</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.irs.gov</td>
              <td style="text-align:center;">GA, New Relic</td>
              <td style="text-align:center;">1</td>
            </tr>
            <tr>
              <td style="text-align:center;">www.singtel.com</td>
              <td style="text-align:center;">GA</td>
              <td style="text-align:center;">1</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="sec-16">
      <header>
        <div class="title-info">
          <h2><span class="section-number">6</span> Discussion</h2>
        </div>
      </header>
      <p><strong>Summary of findings.</strong> Our results from the
      previous sections clearly indicate that not only do malicious
      actors utilize analytics in their attacks, but also that they
      reuse analytics IDs across websites and even across
      platforms. We showed that using analytics IDs extracted from
      known malicious websites allows analysts to double the number
      of malicious websites, group seemingly unrelated websites
      into campaigns, and deanonymize malicious actors hiding
      behind WHOIS privacy proxies (Section&nbsp;<a class="sec"
      href="#sec-12">4.1</a>). Using the same ID-matching
      technique, we were able to identify hundreds of intrusive
      browser extensions in the Chrome Store and cluster extensions
      together, even when those claimed to be developed by
      different developers (Section&nbsp;<a class="sec" href=
      "#sec-13">4.2</a>). Finally, we showed that the same
      techniques apply to mobile malware (Section&nbsp;<a class=
      "sec" href="#sec-14">4.3</a>) and we uncovered a design error
      of modern website-cloning tools that enables the detection of
      phishing websites by the mere fact that they reuse the
      analytics IDs of their victims (Section&nbsp;<a class="sec"
      href="#sec-15">5</a>).</p>
      <p><strong>Analytics providers.</strong> Given our findings,
      we see many avenues where existing web analytics providers
      can assist in the identification of malicious websites and in
      the attribution of these websites back to unscrupulous
      individuals. The analytics providers that we investigated in
      this paper are clearly in the position, given an analytics
      ID, to identify all the websites associated with this ID and
      potentially all other websites managed by the same account.
      We argue that this information, together with details about
      the owner of a given analytics account, would be invaluable
      for law-enforcement purposes. Moreover, analytics platforms
      can help website owners in identifying active phishing
      websites, by warning them about the existence of a new domain
      that is sharing an analytics ID with their current domain and
      exhibits suspicious behavior.</p>
      <p><strong>Attacker adaptation.</strong> Even though
      attackers can, as a result of this work, change their modus
      operandi for launching attacks and utilizing web analytics, a
      change that is effective for evasion purposes is harder than
      it might first appear. For example, even though some
      attackers may start utilizing their own web analytics
      platforms (backed by software such as OWA&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0007">7</a>] and
      Piwik&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href=
      "#BibPLXBIB0010">10</a>]), these analytics backends will
      clearly only be utilized by malicious websites and can
      therefore become signals of website maliciousness, similar to
      Indicators of Compromise (IOCs) present in benign but
      compromised websites&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0022">22</a>]. Alternatively, if they identify
      lesser known analytics platforms that offer stronger privacy
      guarantees, they would still be standing out, assuming that
      the vast majority of benign websites keeps utilizing the
      popular analytics platforms investigated in this paper. Even
      then, these analytics platforms could still assist
      law-enforcement in identifying the operators of malicious
      websites. Finally, even though website-cloning software can
      be modified so that it does not clone the victim analytics
      ID, the ID present on the benign website can be bound to the
      visual representation of that website and form a stronger
      website identity. Phishing-discovery tools can use the
      <em>absence</em> of such an ID from websites that are
      visually similar to popular phishing targets, as an extra
      signal for identifying new phishing attacks.</p>
      <p><strong>Method generalization.</strong> In this work we
      report on the effectiveness of associating analytics IDs for
      detection and discovery of malicious websites and other
      malware. At the same time, we argue that the developed method
      can be generalized to support other artifacts of the modern
      web and mobile applications, which tend to be shared and are
      likely to be used by malicious actors. Examples include
      payment addresses, affiliation identifiers, generated code
      snippets with license tokens, accounts for different widgets
      and services. As with analytics IDs, we expect similar
      challenges in extracting the identifiers, reducing
      false-positives, and evaluating the effectiveness in order to
      assign proper threat scores to the discovered matches.</p>
    </section>
    <section id="sec-17">
      <header>
        <div class="title-info">
          <h2><span class="section-number">7</span> Related
          work</h2>
        </div>
      </header>
      <p>The motivation to this work came from an article by
      Lawrence Alexander about discovering hidden connections of
      websites via Google Analytics IDs&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0017">17</a>]. Specifically, Alexander
      used shared Google Analytics IDs to reveal pro-Kremlin web
      campaigns&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0018">18</a>]. At the same time, there already
      exist services for reverse Google Analytics lookups, such as,
      SpyOnWeb&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0015">15</a>], SameID&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0013">13</a>], domainIQ&nbsp;[<a class=
      "bib" data-trigger="hover" data-toggle="popover"
      data-placement="top" href="#BibPLXBIB0003">3</a>], and
      RiskIQ&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0012">12</a>].
      However, to the best of our knowledge, we are the first to
      generalize the ID-sharing problem to many analytics services
      and perform a large-scale analysis of the applicability of
      this technique for identifying malicious websites, clustering
      malicious content, and performing cross-platform
      attribution.</p>
      <p>In general, the detection of malicious websites by
      inspecting HTTP requests and responses is a known approach,
      e.g., Kosba et al.&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0027">27</a>] created ADAM, a system that
      evaluates network metadata by rendering web pages in a
      sandbox. A cross-layer detection model was developed by Xu et
      al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0035">35</a>],
      considering both network and application level features. Drew
      et al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0024">24</a>]
      investigated the HTML similarities of replicated criminal
      websites and Cova et al.&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0023">23</a>] analyzed the phishing websites
      created by “free” phishing kits. Invernizzi et
      al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0025">25</a>]
      proposed the idea of discovering more malicious pages by
      leveraging the crawling infrastructure of third-party search
      engines, which is conceptually similar to our method of
      discovering other domains using the same analytics IDs.
      Catakoglu et al.&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0022">22</a>] showed that it is possible to use
      high-interaction honeypots to automatically extract
      Indicators of Compromise that can be then used to identify
      compromised websites in the wild. Even though our method is
      focused on identifying malicious infrastructure, it could
      also, in principle, be used to identify compromised websites
      where attackers injected their own analytics IDs. Similarly,
      there has been substantial work in the behavioral analysis
      and classification of HTTP-based malware&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0029">29</a>, <a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0031">31</a>, <a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0032">32</a>], mainly focusing on the
      network traces between malware installations and
      attacker-controlled servers. In addition, Aresu et
      al.&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0019">19</a>]
      research the clustering of Android malware based on HTTP
      traffic, and Zheng et al.&nbsp;[<a class="bib" data-trigger=
      "hover" data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0036">36</a>] propose a signature scheme for
      associating Android malware.</p>
      <p>Most of the recent antiphishing research is based on
      crowd-sourced solutions like PhishTank&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0009">9</a>] and
      OpenPhish&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0008">8</a>], detecting visual
      similarities&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0034">34</a>], detecting suspicious
      URLs&nbsp;[<a class="bib" data-trigger="hover" data-toggle=
      "popover" data-placement="top" href="#BibPLXBIB0021">21</a>],
      and proposing machine learning models&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0016">16</a>, <a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0037">37</a>]. Morever, some studies
      investigate source code features&nbsp;[<a class="bib"
      data-trigger="hover" data-toggle="popover" data-placement=
      "top" href="#BibPLXBIB0020">20</a>] and anomalies in HTTP
      transactions&nbsp;[<a class="bib" data-trigger="hover"
      data-toggle="popover" data-placement="top" href=
      "#BibPLXBIB0030">30</a>], but do not consider the presence or
      absence of analytics ID as a feature.</p>
    </section>
    <section id="sec-18">
      <header>
        <div class="title-info">
          <h2><span class="section-number">8</span> Conclusion</h2>
        </div>
      </header>
      <p>In this paper, we investigated the design of 18
      third-party analytics services and the reuse of analytics IDs
      across websites. Focusing on malicious sites, we showed that
      attackers share analytics IDs across URLs and even across
      platforms. We developed a pipeline for efficiently and
      accurately isolating and extracting analytics IDs from
      malicious websites, extensions, binaries, and mobile apps and
      showed that using our system we can discover tens of
      thousands of new malicious URLs and perform attribution of
      malicious domains even when they utilize WHOIS privacy
      protection services. Finally, we described how we can take
      advantage of an oversight of website-cloning tools for
      identifying phishing campaigns in the wild and discussed how
      analytics services can take advantage of their
      already-collected data to aid in the identification of
      malicious websites and the individuals behind them.</p>
      <p><strong>Acknowledgments:</strong>We thank the reviewers
      for their valuable feedback. This research was supported by
      the Office of Naval Research (ONR) under grants
      N00014-16-1-2264 and N00014-17-1-2541 as well as the National
      Science Foundation under grants CNS-1617902, CNS-1617593, and
      CNS-1527086. Some of our experiments were conducted with
      equipment purchased through NSF CISE Research Infrastructure
      Grant No. 1405641.</p>
    </section>
  </section>
  <section class="back-matter">
    <section id="ref-001">
      <header>
        <div class="title-info">
          <h2 class="page-brake-head">REFERENCES</h2>
        </div>
      </header>
      <ul class="bibUl">
        <li id="BibPLXBIB0001" label="[1]">2017. Anti-Malware Zone:
        BlpSearch, Logiciel Potentiellement Indesirable. (2017).
        <a class="link-inline force-break" href=
        "https://nicolascoolman.eu/2017/09/09/pup-optional-blpsearch/">
          https://nicolascoolman.eu/2017/09/09/pup-optional-blpsearch/</a>.
        </li>
        <li id="BibPLXBIB0002" label="[2]">2017. BuiltWith
        Technology Lookup. (2017). <a class=
        "link-inline force-break" href=
        "https://builtwith.com">https://builtwith.com</a>.
        </li>
        <li id="BibPLXBIB0003" label="[3]">2017. DomainIQ: Reverse
        Analytics. (2017). <a class="link-inline force-break"
          href="https://www.domainiq.com/reverse_analytics">https://www.domainiq.com/reverse_analytics</a>.
        </li>
        <li id="BibPLXBIB0004" label="[4]">2017. How to remove
        Safe4Search redirect (Virus Removal Guide). (2017).
        <a class="link-inline force-break" href=
        "https://malwaretips.com/blogs/remove-safe4search/">https://malwaretips.com/blogs/remove-safe4search/</a>.
        </li>
        <li id="BibPLXBIB0005" label="[5]">2017. NerdyData: Search
        Engine For Source Code. (2017). <a class=
        "link-inline force-break" href=
        "https://nerdydata.com">https://nerdydata.com</a>.
        </li>
        <li id="BibPLXBIB0006" label="[6]">2017. Open-Source
        Phishing Framework. (2017). <a class=
        "link-inline force-break" href=
        "https://getgophish.com/">https://getgophish.com/</a>.
        </li>
        <li id="BibPLXBIB0007" label="[7]">2017. Open Web Analytics
        (OWA). (2017). <a class="link-inline force-break" href=
        "http://www.openwebanalytics.com">http://www.openwebanalytics.com</a>.
        </li>
        <li id="BibPLXBIB0008" label="[8]">2017. OpenPhish:
        Phishing Intelligence. (2017). <a class=
        "link-inline force-break" href=
        "https://openphish.com/">https://openphish.com/</a>.
        </li>
        <li id="BibPLXBIB0009" label="[9]">2017. PhishTank: Join
        the fight against phishing. (2017). <a class=
        "link-inline force-break" href=
        "https://www.phishtank.com/">https://www.phishtank.com/</a>.
        </li>
        <li id="BibPLXBIB0010" label="[10]">2017. PIWIK: Open
        Analytics Platform. (2017). <a class=
        "link-inline force-break" href=
        "https://piwik.org">https://piwik.org</a>.
        </li>
        <li id="BibPLXBIB0011" label="[11]">2017. PublicWWW: Search
        Engine for Source Code. (2017). <a class=
        "link-inline force-break" href=
        "https://publicwww.com">https://publicwww.com</a>.
        </li>
        <li id="BibPLXBIB0012" label="[12]">2017. RiskIQ:
        PassiveTotal Threat Investigation Platform. (2017).
        <a class="link-inline force-break" href=
        "https://www.riskiq.com">https://www.riskiq.com</a>.
        </li>
        <li id="BibPLXBIB0013" label="[13]">2017. SameID.net: Cut
        through hours of keyword research in seconds. (2017).
        <a class="link-inline force-break" href=
        "http://sameid.net">http://sameid.net</a>.
        </li>
        <li id="BibPLXBIB0014" label="[14]">2017. The
        Social-Engineer Toolkit (SET). (2017). <a class=
        "link-inline force-break" href=
        "https://github.com/trustedsec/social-engineer-toolkit">https://github.com/trustedsec/social-engineer-toolkit</a>.
        </li>
        <li id="BibPLXBIB0015" label="[15]">2017. SpyOnWeb Research
        Tool: Internet Competitive Intelligence. (2017).
          <a class="link-inline force-break" href=
          "http://spyonweb.com">http://spyonweb.com</a>.
        </li>
        <li id="BibPLXBIB0016" label="[16]">Saeed Abu-Nimeh, Dario
        Nappa, Xinlei Wang, and Suku Nair. 2007. A Comparison of
        Machine Learning Techniques for Phishing Detection. In <em>
          <em>Proceedings of the Anti-phishing Working Groups 2Nd
          Annual eCrime Researchers Summit</em></em> (eCrime ’07).
          ACM, New York, NY, USA, 60–69. <a class=
          "link-inline force-break" href=
          "https://doi.org/10.1145/1299015.1299021" target=
          "_blank">https://doi.org/10.1145/1299015.1299021</a>
        </li>
        <li id="BibPLXBIB0017" label="[17]">Lawrence Alexander.
        2015. Bellingcat: Unveiling Hidden Connections with Google
        Analytics IDs. (2015). <a class="link-inline force-break"
        href=
        "https://www.bellingcat.com/resources/how-tos/2015/07/23/unveiling-hidden-connections-with-google-analytics-ids/">
          https://www.bellingcat.com/resources/how-tos/2015/07/23/unveiling-hidden-connections-with-google-analytics-ids/</a>.
        </li>
        <li id="BibPLXBIB0018" label="[18]">Lawrence Alexander.
        2015. Open-Source Information Reveals Pro-Kremlin Web
        Campaign. (2015). <a class="link-inline force-break"
          href="https://globalvoices.org/2015/07/13/open-source-information-reveals-pro-kremlin-web-campaign/">
          https://globalvoices.org/2015/07/13/open-source-information-reveals-pro-kremlin-web-campaign/</a>.
        </li>
        <li id="BibPLXBIB0019" label="[19]">Marco Aresu, Davide
        Ariu, Mansour Ahmadi, Davide Maiorca, and Giorgio Giacinto.
        2015. Clustering Android Malware Families by Http Traffic.
        In <em><em>Proceedings of the 2015 10th International
        Conference on Malicious and Unwanted Software
        (MALWARE)</em></em> (MALWARE ’15). IEEE Computer Society,
        Washington, DC, USA, 128–135. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1109/MALWARE.2015.7413693" target=
        "_blank">https://doi.org/10.1109/MALWARE.2015.7413693</a>
        </li>
        <li id="BibPLXBIB0020" label="[20]">Suresh Babu.K. 2013.
        Phishing Websites Detection Based on Web Source Code and
        Url in the Webpage.</li>
        <li id="BibPLXBIB0021" label="[21]">Aaron Blum, Brad
        Wardman, Thamar Solorio, and Gary Warner. 2010. Lexical
        Feature Based Phishing URL Detection Using Online Learning.
        In <em><em>Proceedings of the 3rd ACM Workshop on
        Artificial Intelligence and Security</em></em> (AISec ’10).
        ACM, New York, NY, USA, 54–60. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1145/1866423.1866434" target="_blank">
          https://doi.org/10.1145/1866423.1866434</a>
        </li>
        <li id="BibPLXBIB0022" label="[22]">Onur Catakoglu, Marco
        Balduzzi, and Davide Balzarotti. 2016. Automatic Extraction
        of Indicators of Compromise for Web Applications. In
        <em><em>Proceedings of the 25th International Conference on
        World Wide Web</em></em> (WWW). 333–343.</li>
        <li id="BibPLXBIB0023" label="[23]">Marco Cova, Christopher
        Kruegel, and Giovanni Vigna. 2008. There Is No Free Phish:
        An Analysis of” Free” and Live Phishing Kits.
        <em><em>WOOT</em></em> 8(2008), 1–8.</li>
        <li id="BibPLXBIB0024" label="[24]">Jake Drew and Tyler
        Moore. 2014. Automatic Identification of Replicated
        Criminal Websites Using Combined Clustering. In
        <em><em>International Workshop on Cyber Crime (IWCC), IEEE
        Security and Privacy Workshops</em></em> . IEEE.
        http://lyle.smu.edu/~tylerm/iwcc14.pdf</li>
        <li id="BibPLXBIB0025" label="[25]">Luca Invernizzi and
        Paolo&nbsp;Milani Comparetti. 2012. EvilSeed: A Guided
        Approach to Finding Malicious Web Pages. In <em><em>IEEE
        Symposium on Security and Privacy, SP 2012, 21-23 May 2012,
        San Francisco, California, USA</em></em> . 428–442.
        <a class="link-inline force-break" href=
        "https://doi.org/10.1109/SP.2012.33" target=
        "_blank">https://doi.org/10.1109/SP.2012.33</a>
        </li>
        <li id="BibPLXBIB0026" label="[26]">Panagiotis Kintis,
        Najmeh Miramirkhani, Charles Lever, Yizheng Chen, Rosa
        Romero-Gomez, Nikolaos Pitropakis, Nick Nikiforakis, and
        Manos Antonakakis. 2017. Hiding in Plain Sight: A
        Longitudinal Study of Combosquatting Abuse. In
        <em><em>Proceedings of the 24th ACM Conference on Computer
        and Communications Security (CCS)</em></em> .</li>
        <li id="BibPLXBIB0027" label="[27]">Ahmed&nbsp;E. Kosba,
        Aziz Mohaisen, Andrew West, Trevor Tonn, and Huy&nbsp;Kang
        Kim. 2015. <em><em>ADAM: Automated Detection and
        Attribution of Malicious Webpages</em></em> . Springer
        International Publishing, Cham, 3–16. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1007/978-3-319-15087-1_1" target=
        "_blank">https://doi.org/10.1007/978-3-319-15087-1_1</a>
        </li>
        <li id="BibPLXBIB0028" label="[28]">Najmeh Miramirkhani,
        Oleksii Starov, and Nick Nikiforakis. 2017. Dial One for
        Scam: A Large-Scale Analysis of Technical Support Scams. In
        <em><em>Proceedings of the 24th Network and Distributed
        System Security Symposium (NDSS)</em></em> .</li>
        <li id="BibPLXBIB0029" label="[29]">Saeed Nari and
        Ali&nbsp;A. Ghorbani. 2013. Automated Malware
        Classification Based on Network Behavior. In
        <em><em>Proceedings of the 2013 International Conference on
        Computing, Networking and Communications (ICNC)</em></em>
        (ICNC ’13). IEEE Computer Society, Washington, DC, USA,
        642–647. <a class="link-inline force-break" href=
        "https://doi.org/10.1109/ICCNC.2013.6504162" target=
        "_blank">https://doi.org/10.1109/ICCNC.2013.6504162</a>
        </li>
        <li id="BibPLXBIB0030" label="[30]">Ying Pan and Xuhua
        Ding. 2006. Anomaly Based Web Phishing Page Detection. In
        <em><em>Proceedings of the 22Nd Annual Computer Security
        Applications Conference</em></em> (ACSAC ’06). IEEE
        Computer Society, Washington, DC, USA, 381–392. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1109/ACSAC.2006.13" target=
        "_blank">https://doi.org/10.1109/ACSAC.2006.13</a>
        </li>
        <li id="BibPLXBIB0031" label="[31]">Roberto Perdisci,
        Davide Ariu, and Giorgio Giacinto. 2013. Scalable
        Fine-grained Behavioral Clustering of HTTP-based Malware.
        <em><em>Comput. Netw.</em></em> 57, 2 (Feb. 2013), 487–500.
        <a class="link-inline force-break" href=
        "https://doi.org/10.1016/j.comnet.2012.06.022" target=
        "_blank">https://doi.org/10.1016/j.comnet.2012.06.022</a>
        </li>
        <li id="BibPLXBIB0032" label="[32]">Roberto Perdisci, Wenke
        Lee, and Nick Feamster. 2010. Behavioral Clustering of
        HTTP-based Malware and Signature Generation Using Malicious
        Network Traces. In <em><em>Proceedings of the 7th USENIX
        Conference on Networked Systems Design and
        Implementation</em></em> (NSDI’10). USENIX Association,
        Berkeley, CA, USA, 26–26. <a href=
        "http://dl.acm.org/citation.cfm?id=1855711.1855737"
          target="_blank">http://dl.acm.org/citation.cfm?id=1855711.1855737</a>
        </li>
        <li id="BibPLXBIB0033" label="[33]">Oleksii Starov and Nick
        Nikiforakis. 2017. Extended Tracking Powers: Measuring the
        Privacy Diffusion Enabled by Browser Extensions. In
        <em><em>Proceedings of the 26th International World Wide
        Web Conference (WWW)</em></em> .</li>
        <li id="BibPLXBIB0034" label="[34]">Liu Wenyin, Guanglin
        Huang, Liu Xiaoyue, Zhang Min, and Xiaotie Deng. 2005.
        Detection of Phishing Webpages Based on Visual Similarity.
        In <em><em>Special Interest Tracks and Posters of the 14th
        International Conference on World Wide Web</em></em> (WWW
        ’05). ACM, New York, NY, USA, 1060–1061. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1145/1062745.1062868" target="_blank">
          https://doi.org/10.1145/1062745.1062868</a>
        </li>
        <li id="BibPLXBIB0035" label="[35]">Li Xu, Zhenxin Zhan,
        Shouhuai Xu, and Keying Ye. 2013. Cross-layer Detection of
        Malicious Websites. In <em><em>Proceedings of the Third ACM
        Conference on Data and Application Security and
        Privacy</em></em> (CODASPY ’13). ACM, New York, NY, USA,
        141–152. <a class="link-inline force-break" href=
        "https://doi.org/10.1145/2435349.2435366" target="_blank">
          https://doi.org/10.1145/2435349.2435366</a>
        </li>
        <li id="BibPLXBIB0036" label="[36]">Min Zheng, Mingshen
        Sun, and John C.&nbsp;S. Lui. 2013. Droid Analytics: A
        Signature Based Analytic System to Collect, Extract,
        Analyze and Associate Android Malware. In
        <em><em>Proceedings of the 2013 12th IEEE International
        Conference on Trust, Security and Privacy in Computing and
        Communications</em></em> (TRUSTCOM ’13). IEEE Computer
        Society, Washington, DC, USA, 163–171. <a class=
        "link-inline force-break" href=
        "https://doi.org/10.1109/TrustCom.2013.25" target="_blank">
          https://doi.org/10.1109/TrustCom.2013.25</a>
        </li>
        <li id="BibPLXBIB0037" label="[37]">Weiwei Zhuang, Qingshan
        Jiang, and Tengke Xiong. 2012. An Intelligent Anti-phishing
        Strategy Model for Phishing Website Detection. In <em><em>
          32nd International Conference on Distributed Computing
          Systems Workshops (ICDCS 2012 Workshops), Macau, China,
          June 18-21, 2012</em></em> . 51–56. <a class=
          "link-inline force-break" href=
          "https://doi.org/10.1109/ICDCSW.2012.66" target=
          "_blank">https://doi.org/10.1109/ICDCSW.2012.66</a>
        </li>
      </ul>
    </section>
  </section>
  <section id="foot-001" class="footnote">
    <header>
      <div class="title-info">
        <h2>FOOTNOTE</h2>
      </div>
    </header>
    <div class="bibStrip">
      <p>This paper is published under the Creative Commons
      Attribution 4.0 International (CC-BY&nbsp;4.0) license.
      Authors reserve their rights to disseminate the work on their
      personal and corporate Web sites with the appropriate
      attribution.</p>
      <p><em>WWW '18, April 23-27, 2018, Lyon, France</em></p>
      <p>© 2018; IW3C2 (International World Wide Web Conference
      Committee), published under Creative Commons CC-BY&nbsp;4.0
      License. ACM ISBN 978-1-4503-5639-8/18/04.<br />
      DOI: <a class="link-inline force-break" target="_blank" href=
      "https://doi.org/10.1145/3178876.3186089">https://doi.org/10.1145/3178876.3186089</a></p>
    </div>
  </section>
  <div class="pubHistory">
    <p></p>
  </div>
</body>
</html>
